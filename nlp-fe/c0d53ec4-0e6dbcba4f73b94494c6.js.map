{"version":3,"sources":["webpack:///./node_modules/mixpanel-browser/dist/mixpanel.cjs.js"],"names":["window$1","Config","DEBUG","LIB_VERSION","window","loc","hostname","navigator","userAgent","document","location","referrer","screen","width","height","at","ch","text","value","escapee","error","next","number","string","white","array","object","T","ArrayProto","Array","prototype","FuncProto","Function","ObjProto","Object","slice","toString","hasOwnProperty","windowConsole","console","navigator$1","document$1","windowOpera","opera","nativeBind","bind","nativeForEach","forEach","nativeIndexOf","indexOf","nativeMap","map","nativeIsArray","isArray","breaker","_","trim","str","replace","console$1","log","isUndefined","apply","arguments","err","each","arg","args","concat","toArray","critical","log_func_with_prefix","func","prefix","console_with_prefix","context","_bound","call","isFunction","TypeError","this","ctor","self","result","bind_instance_methods","obj","iterator","length","i","l","key","escapeHTML","s","escaped","isString","extend","source","prop","f","test","x","isArguments","iterable","values","arr","callback","results","item","push","keys","identity","include","target","found","includes","needle","inherit","subclass","superclass","constructor","isObject","isEmptyObject","isDate","isNumber","isElement","nodeType","encodeDates","v","k","formatDate","timestamp","Date","now","d","pad","n","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","safewrap","e","safewrap_class","klass","functions","safewrap_instance_methods","strip_empty_properties","p","ret","truncate","val","JSONEncode","mixed_val","quote","escapable","meta","lastIndex","a","c","charCodeAt","holder","gap","mind","partial","toJSON","isFinite","String","join","JSONDecode","m","SyntaxError","charAt","hex","uffff","parseInt","fromCharCode","word","base64Encode","data","h1","h2","h3","h4","bits","b64","ac","enc","tmp_arr","utf8Encode","start","end","stringl","utftext","c1","substring","UUID","se","Math","random","ua","buffer","xor","byte_array","j","tmp","unshift","UA","isBlockedUA","HTTPBuildQuery","formdata","arg_separator","use_val","use_key","encodeURIComponent","getQueryParam","url","param","RegExp","exec","decodeURIComponent","getHashParam","hash","matches","match","cookie","get","name","nameEQ","ca","split","parse","set_seconds","seconds","is_cross_subdomain","is_secure","is_cross_site","domain_override","cdomain","expires","secure","domain","extract_domain","date","setTime","getTime","toGMTString","set","days","new_cookie_val","remove","_localStorageSupported","localStorageSupported","storage","forceCheck","supported","localStorage","cheap_guid","setItem","getItem","removeItem","is_supported","force_check","msg","register_event","fixEvent","event","preventDefault","stopPropagation","returnValue","cancelBubble","element","type","handler","oldSchool","useCapture","addEventListener","ontype","old_handler","new_handler","old_handlers","old_result","new_result","makeHandler","TOKEN_MATCH_REGEX","dom_query","getAllChildren","all","getElementsByTagName","bad_whitespace","hasClass","elem","selector","className","getElementsBySelector","token","tagName","foundCount","elements","currentContextIndex","tokens","currentContext","id","getElementById","nodeName","toLowerCase","token_match","checkFunction","attrName","attrOperator","attrValue","getAttribute","lastIndexOf","query","info","campaignParams","campaign_keywords","kw","params","kwkey","URL","searchEngine","search","searchInfo","keyword","browser","user_agent","vendor","browserVersion","regex","undefined","parseFloat","os","device","referringDomain","properties","href","people_properties","pageviewInfo","page","maxlen","guid","determine_eligibility","feature","percent_allowed","SIMPLE_DOMAIN_MATCH_REGEX","DOMAIN_MATCH_REGEX","domain_regex","parts","tld","JSONStringify","JSONParse","getClassName","el","baseVal","isElementNode","isTag","tag","isTextNode","shouldTrackElement","curEl","parentNode","classes","shouldTrackValue","JSON","stringify","autotrack","_initializedTokens","_previousElementSibling","previousElementSibling","previousSibling","_loadScript","scriptUrlToLoad","scriptTag","createElement","src","onload","scripts","insertBefore","body","appendChild","_getPropertiesFromElement","props","attributes","attr","nthChild","nthOfType","currentElem","_getDefaultProperties","eventType","host","pathname","_extractCustomPropertyValue","customProperty","propValues","querySelectorAll","matchedElem","_getCustomProperties","targetElementList","_customProperties","eventSelector","eventElements","eventElement","_getEventTarget","srcElement","_trackEvent","instance","elText","shouldTrackDomEvent","elementText","elementsJson","explicitNoTrack","shouldTrackEl","safeElementText","childNodes","child","textContent","filter","track","_navigate","_addDomEventHandlers","init","get_config","_maybeLoadEditor","parseDecideResponse","response","title","_send_request","method","transport","_prepare_callback","that","setTimeout","_editorParamsFromHash","editorParams","state","expiresInSeconds","Number","sessionStorage","history","replaceState","parseFromUrl","parseFromStorage","_loadEditor","editorUrl","enabledForProject","numBuckets","numEnabledBuckets","charCodeSum","isBrowserSupported","DomTracker","create_properties","event_handler","after_track_handler","mixpanel_instance","mp","event_name","user_callback","override_event","options","timeout","track_callback","timeout_occured","callback_fired","LinkTracker","evt","new_tab","which","metaKey","ctrlKey","FormTracker","submit","logger$2","SharedLock","storageKey","pollIntervalMS","timeoutMS","withLock","lockedCB","errorCB","pid","startTime","keyX","keyY","keyZ","reportError","delay","cb","loop","waitFor","predicate","getSetY","valY","Error","criticalSection","logger$1","RequestQueue","lock","memQueue","enqueue","flushInterval","queueEntry","succeeded","storedQueue","readFromStorage","saveToStorage","fillBatch","batchSize","batch","idsInBatch","filterOutIDsAndInvalid","items","idSet","filteredItems","removeItemsByID","ids","storageEntry","queue","clear","logger","RequestBatcher","endpoint","libConfig","sendRequest","sendRequestFunc","stopped","flush","stop","timeoutID","clearTimeout","resetBatchSize","resetFlush","scheduleFlush","flushMS","requestInProgress","currentBatchSize","dataForRequest","batchSendCallback","res","removeItemsFromQueue","xhr_req","retryMS","headers","retryAfter","min","halvedBatchSize","max","floor","requestOptions","verbose","ignore_json_errors","timeout_ms","sendBeacon","optIn","_optInOut","optOut","hasOptedIn","_getStorageValue","hasOptedOut","ignoreDnt","win","nav","hasDntOn","dntValue","_hasDoNotTrackFlagOn","addOptOutCheckMixpanelLib","_addOptOutCheck","addOptOutCheckMixpanelPeople","_get_config","addOptOutCheckMixpanelGroup","clearOptInOut","_getStorage","_getStorageKey","crossSubdomainCookie","cookieDomain","persistenceType","persistencePrefix","optValue","cookieExpiration","secureCookie","crossSiteCookie","trackEventName","trackProperties","getConfigValue","optedOut","apiActions","set_action","to","$set","_is_reserved_property","unset_action","$unset","set_once_action","$set_once","union_action","list_name","$union","append_action","$append","remove_action","$remove","delete_action","MixpanelGroup","_init","group_key","group_id","_mixpanel","_group_key","_group_id","set_once","unset","union","date_encoded_data","_track_or_batch","truncated_data","batcher","request_batchers","groups","conf","RESERVED_PROPERTIES","MixpanelPersistence","config","campaign_params_saved","storage_type","load","update_config","upgrade","save","disabled","entry","old_cookie_name","old_cookie","upgrade_from_old_lib","register_once","_expire_notification_campaigns","expire_days","cross_subdomain","cross_site","cookie_domain","default_value","default_expiry","register","unregister","campaigns_shown","EXPIRY_TIME","campaign_id","update_campaign_params","update_search_keyword","update_referrer_info","get_referrer_info","safe_merge","set_disabled","set_cookie_domain","set_cross_site","set_cross_subdomain","set_secure","get_cross_subdomain","_add_to_people_queue","q_key","_get_queue_key","q_data","set_q","_get_or_create_queue","set_once_q","unset_q","add_q","union_q","remove_q","append_q","_pop_from_people_queue","enqueued_obj","append_obj","q","_get_queue","queued_action","default_val","set_event_timer","timers","remove_event_timer","IN_OPERATOR","NOT_IN_OPERATOR","MINUS_OPERATOR","MUL_OPERATOR","DIV_OPERATOR","MOD_OPERATOR","EQUALS_OPERATOR","NOT_EQUALS_OPERATOR","GREATER_OPERATOR","LESS_OPERATOR","GREATER_EQUAL_OPERATOR","LESS_EQUAL_OPERATOR","DEFINED_OPERATOR","NOT_DEFINED_OPERATOR","toNumber","isNaN","toBoolean","evaluateEquality","op","r","_isArrayEqual","_isEqual","evaluateSelector","evaluateOperator","evaluateAnd","evaluateOr","leftValue","rightValue","evaluateIn","evaluatePlus","evaluateArithmetic","compare","localeCompare","evaluateComparison","evaluateBoolean","evaluateDateTime","evaluateList","evaluateNumber","evaluateString","b","evaluateDefined","evaluateNot","evaluateOperand","out","evaluateWindow","filters","MixpanelNotification","notif_data","mixpanel","persistence","resource_protocol","cdn_host","message_id","cta","notif_type","style","video_width","VIDEO_WIDTH","video_height","VIDEO_HEIGHT","display_triggers","dest_url","image_url","thumb_image_url","video_url","clickthrough","mini","notif_width","NOTIF_WIDTH_MINI","NOTIF_WIDTH","_set_client_config","imgs_to_preload","_init_image_html","_init_video","ANIM_TIME","MARKUP_PREFIX","BG_OPACITY","NOTIF_TOP","NOTIF_START_TOP","NOTIF_HEIGHT_MINI","THUMB_BORDER_SIZE","THUMB_IMG_SIZE","THUMB_OFFSET","round","show","body_el","_init_styles","_init_notification_el","_preload_images","_attach_and_animate","dismiss","marked_as_shown","_mark_delivery","notif_attr","notif_start","notif_goal","exiting_el","showing_video","_get_el","_get_notification_display_el","use_transitions","_remove_class","_add_class","_remove_notification_el","_animate_els","goal","class_name","anims","mss","done_cb","start_time","ai","anim","time_diff","in_progress","cur_time","anim_diff","anim_dir","suffix","shown","_get_shown_campaigns","notification_el","notif_el","_mark_as_shown","click_el","show_video","_track_event","_switch_to_video","tracking_cb","open","_matches_event_data","event_data","display_trigger","_browser_lte","version","browser_versions","img_html","thumb_img_html","notification_html","video_src","video_html","cancel_html","close_html","play_html","youtube_video","yt_custom","vimeo_video","video_iframe","flip_animate","main_html","innerHTML","style_vals","bg","bg_actions","bg_hover","bg_light","border_gray","cancel_opacity","mini_hover","text_title","text_main","text_tagline","text_hover","shadow","video_shadow","mini_shadow","thumb_total_size","anim_seconds","notif_media_queries","notif_styles","doc_width","doc_height","VENDOR_STYLES","VENDOR_PREFIXES","si","pi","media_queries","create_style_text","style_text","head_el","style_el","style_defs","st","mq_defs","mqt","mq","create_media_query_text","head","documentElement","setAttribute","styleSheet","cssText","youtube_match","vimeo_match","_yt_video_ready","firstScriptTag","get_style","style_name","styles","defaultView","getComputedStyle","currentStyle","extra_props","all_loaded_cb","preloaded_imgs","img_objs","img","Image","complete","imgs_loaded","clearInterval","_video_progress_checker","visibility","removeChild","get_browser_version","browser_ex","ActiveXObject","scrollWidth","offsetWidth","clientWidth","scrollHeight","offsetHeight","clientHeight","ie_ver","sample_styles","is_css_compatible","rule","toUpperCase","overlay","video_ready","video_inited","progress_bar","progress_time","progress_el","ytplayer","video_duration","update_video_time","current_time","secs","mins","hours","setInterval","clickx","pageX","getBoundingClientRect","left","init_type","mixpanel_master","MixpanelPeople","increment","by","$add","append","track_charge","amount","clear_charges","delete_user","_identify_called","get_distinct_id","device_id","get_property","user_id","had_persisted_distinct_id","people","_enqueue","status","conf_var","_flags","identify_called","_flush_one_queue","action","action_method","queue_to_params_fn","_this","queued_data","action_params","_flush","_set_callback","_add_callback","_append_callback","_set_once_callback","_union_callback","_unset_callback","_remove_callback","$append_queue","$remove_queue","$append_item","append_callback","pop","$remove_item","remove_callback","USE_XHR","XMLHttpRequest","ENQUEUE_REQUESTS","DEFAULT_CONFIG","DOM_LOADED","MixpanelLib","create_mplib","_cached_groups","_user_decide_check_complete","_events_tracked_before_user_decide_check_complete","_execute_array","encode_data_for_request","json_data","_loaded","variable_features","api_host","is_custom_api","set_config","PRIMARY_INSTANCE_NAME","__dom_loaded_queue","__request_queue","__disabled_events","_batch_requests","start_batch_requests","events","_gdpr_init","uuid","_set_default_superprops","_dom_loaded","_track_dom","has_opted_out_tracking","DomClass","dt","jsc","randomized_cb","callback_string","DEFAULT_OPTIONS","body_data","use_post","use_sendBeacon","verbose_mode","req","headerValue","headerName","setRequestHeader","withCredentials","onreadystatechange","readyState","responseText","statusText","send","script","async","defer","fn_name","alias_calls","other_calls","tracking_calls","execute","calls","caller","batcher_config","stop_batch_requests","disable","disable_all_events","should_send_immediately","send_request_options","request_enqueued_or_initiated","send_request_immediately","_event_is_disabled","start_timestamp","duration_in_ms","toFixed","property_blacklist","blacklisted_prop","_check_and_handle_triggered_notifications","set_group","group_ids","add_group","old_values","remove_group","old_value","idx","splice","track_with_groups","tracking_props","_create_map_key","_remove_group_from_cache","get_group","map_key","group","track_pageview","track_links","track_forms","time_event","property","_register_single","identify","new_distinct_id","previous_distinct_id","_check_and_handle_notifications","reset","alias","original","name_tag","prop_name","property_name","_show_notification","distinct_id","notifications","notif","_handle_user_decide_check_complete","shift","has_opted_in_tracking","opt_in_tracking","opt_out_tracking","clear_opt_in_out_tracking","_gdpr_update_persistence","_gdpr_call_func","instances","override_mp_init_func","dom_loaded_handler","done","inst","attachEvent","toplevel","frameElement","doScroll","do_scroll_check","add_dom_loaded_handler","module","exports"],"mappings":"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","file":"c0d53ec4-0e6dbcba4f73b94494c6.js","sourcesContent":["'use strict';\n\nrequire(\"core-js/modules/es6.number.constructor\");\n\nrequire(\"core-js/modules/es6.function.name\");\n\nrequire(\"core-js/modules/es6.string.trim\");\n\nrequire(\"core-js/modules/es6.array.filter\");\n\nrequire(\"core-js/modules/es6.regexp.search\");\n\nrequire(\"core-js/modules/es6.array.last-index-of\");\n\nrequire(\"core-js/modules/es6.regexp.split\");\n\nrequire(\"core-js/modules/es6.regexp.match\");\n\nrequire(\"core-js/modules/es6.regexp.constructor\");\n\nrequire(\"core-js/modules/es6.date.to-json\");\n\nrequire(\"core-js/modules/es6.date.now\");\n\nrequire(\"core-js/modules/es7.array.includes\");\n\nrequire(\"core-js/modules/es6.string.includes\");\n\nrequire(\"core-js/modules/web.dom.iterable\");\n\nrequire(\"core-js/modules/es6.array.iterator\");\n\nrequire(\"core-js/modules/es6.regexp.replace\");\n\nrequire(\"core-js/modules/es6.array.is-array\");\n\nrequire(\"core-js/modules/es6.array.map\");\n\nrequire(\"core-js/modules/es6.array.index-of\");\n\nrequire(\"core-js/modules/es6.array.for-each\");\n\nrequire(\"core-js/modules/es6.function.bind\");\n\nrequire(\"core-js/modules/es6.regexp.to-string\");\n\nrequire(\"core-js/modules/es6.date.to-string\");\n\nrequire(\"core-js/modules/es6.object.to-string\");\n\nvar Config = {\n  DEBUG: false,\n  LIB_VERSION: '2.39.0'\n}; // since es6 imports are static and we run unit tests from the console, window won't be defined when importing this file\n\nvar window$1;\n\nif (typeof window === 'undefined') {\n  var loc = {\n    hostname: ''\n  };\n  window$1 = {\n    navigator: {\n      userAgent: ''\n    },\n    document: {\n      location: loc,\n      referrer: ''\n    },\n    screen: {\n      width: 0,\n      height: 0\n    },\n    location: loc\n  };\n} else {\n  window$1 = window;\n}\n/*\n * Saved references to long variable names, so that closure compiler can\n * minimize file size.\n */\n\n\nvar ArrayProto = Array.prototype;\nvar FuncProto = Function.prototype;\nvar ObjProto = Object.prototype;\nvar slice = ArrayProto.slice;\nvar toString = ObjProto.toString;\nvar hasOwnProperty = ObjProto.hasOwnProperty;\nvar windowConsole = window$1.console;\nvar navigator$1 = window$1.navigator;\nvar document$1 = window$1.document;\nvar windowOpera = window$1.opera;\nvar screen = window$1.screen;\nvar userAgent = navigator$1.userAgent;\nvar nativeBind = FuncProto.bind;\nvar nativeForEach = ArrayProto.forEach;\nvar nativeIndexOf = ArrayProto.indexOf;\nvar nativeMap = ArrayProto.map;\nvar nativeIsArray = Array.isArray;\nvar breaker = {};\nvar _ = {\n  trim: function trim(str) {\n    // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/Trim#Polyfill\n    return str.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, '');\n  }\n}; // Console override\n\nvar console$1 = {\n  /** @type {function(...*)} */\n  log: function log() {\n    if (Config.DEBUG && !_.isUndefined(windowConsole) && windowConsole) {\n      try {\n        windowConsole.log.apply(windowConsole, arguments);\n      } catch (err) {\n        _.each(arguments, function (arg) {\n          windowConsole.log(arg);\n        });\n      }\n    }\n  },\n\n  /** @type {function(...*)} */\n  error: function error() {\n    if (Config.DEBUG && !_.isUndefined(windowConsole) && windowConsole) {\n      var args = ['Mixpanel error:'].concat(_.toArray(arguments));\n\n      try {\n        windowConsole.error.apply(windowConsole, args);\n      } catch (err) {\n        _.each(args, function (arg) {\n          windowConsole.error(arg);\n        });\n      }\n    }\n  },\n\n  /** @type {function(...*)} */\n  critical: function critical() {\n    if (!_.isUndefined(windowConsole) && windowConsole) {\n      var args = ['Mixpanel error:'].concat(_.toArray(arguments));\n\n      try {\n        windowConsole.error.apply(windowConsole, args);\n      } catch (err) {\n        _.each(args, function (arg) {\n          windowConsole.error(arg);\n        });\n      }\n    }\n  }\n};\n\nvar log_func_with_prefix = function log_func_with_prefix(func, prefix) {\n  return function () {\n    arguments[0] = '[' + prefix + '] ' + arguments[0];\n    return func.apply(console$1, arguments);\n  };\n};\n\nvar console_with_prefix = function console_with_prefix(prefix) {\n  return {\n    log: log_func_with_prefix(console$1.log, prefix),\n    error: log_func_with_prefix(console$1.error, prefix),\n    critical: log_func_with_prefix(console$1.critical, prefix)\n  };\n}; // UNDERSCORE\n// Embed part of the Underscore Library\n\n\n_.bind = function (func, context) {\n  var args, _bound;\n\n  if (nativeBind && func.bind === nativeBind) {\n    return nativeBind.apply(func, slice.call(arguments, 1));\n  }\n\n  if (!_.isFunction(func)) {\n    throw new TypeError();\n  }\n\n  args = slice.call(arguments, 2);\n\n  _bound = function bound() {\n    if (!(this instanceof _bound)) {\n      return func.apply(context, args.concat(slice.call(arguments)));\n    }\n\n    var ctor = {};\n    ctor.prototype = func.prototype;\n    var self = new ctor();\n    ctor.prototype = null;\n    var result = func.apply(self, args.concat(slice.call(arguments)));\n\n    if (Object(result) === result) {\n      return result;\n    }\n\n    return self;\n  };\n\n  return _bound;\n};\n\n_.bind_instance_methods = function (obj) {\n  for (var func in obj) {\n    if (typeof obj[func] === 'function') {\n      obj[func] = _.bind(obj[func], obj);\n    }\n  }\n};\n/**\n * @param {*=} obj\n * @param {function(...*)=} iterator\n * @param {Object=} context\n */\n\n\n_.each = function (obj, iterator, context) {\n  if (obj === null || obj === undefined) {\n    return;\n  }\n\n  if (nativeForEach && obj.forEach === nativeForEach) {\n    obj.forEach(iterator, context);\n  } else if (obj.length === +obj.length) {\n    for (var i = 0, l = obj.length; i < l; i++) {\n      if (i in obj && iterator.call(context, obj[i], i, obj) === breaker) {\n        return;\n      }\n    }\n  } else {\n    for (var key in obj) {\n      if (hasOwnProperty.call(obj, key)) {\n        if (iterator.call(context, obj[key], key, obj) === breaker) {\n          return;\n        }\n      }\n    }\n  }\n};\n\n_.escapeHTML = function (s) {\n  var escaped = s;\n\n  if (escaped && _.isString(escaped)) {\n    escaped = escaped.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;').replace(/'/g, '&#039;');\n  }\n\n  return escaped;\n};\n\n_.extend = function (obj) {\n  _.each(slice.call(arguments, 1), function (source) {\n    for (var prop in source) {\n      if (source[prop] !== void 0) {\n        obj[prop] = source[prop];\n      }\n    }\n  });\n\n  return obj;\n};\n\n_.isArray = nativeIsArray || function (obj) {\n  return toString.call(obj) === '[object Array]';\n}; // from a comment on http://dbj.org/dbj/?p=286\n// fails on only one very rare and deliberate custom object:\n// var bomb = { toString : undefined, valueOf: function(o) { return \"function BOMBA!\"; }};\n\n\n_.isFunction = function (f) {\n  try {\n    return /^\\s*\\bfunction\\b/.test(f);\n  } catch (x) {\n    return false;\n  }\n};\n\n_.isArguments = function (obj) {\n  return !!(obj && hasOwnProperty.call(obj, 'callee'));\n};\n\n_.toArray = function (iterable) {\n  if (!iterable) {\n    return [];\n  }\n\n  if (iterable.toArray) {\n    return iterable.toArray();\n  }\n\n  if (_.isArray(iterable)) {\n    return slice.call(iterable);\n  }\n\n  if (_.isArguments(iterable)) {\n    return slice.call(iterable);\n  }\n\n  return _.values(iterable);\n};\n\n_.map = function (arr, callback) {\n  if (nativeMap && arr.map === nativeMap) {\n    return arr.map(callback);\n  } else {\n    var results = [];\n\n    _.each(arr, function (item) {\n      results.push(callback(item));\n    });\n\n    return results;\n  }\n};\n\n_.keys = function (obj) {\n  var results = [];\n\n  if (obj === null) {\n    return results;\n  }\n\n  _.each(obj, function (value, key) {\n    results[results.length] = key;\n  });\n\n  return results;\n};\n\n_.values = function (obj) {\n  var results = [];\n\n  if (obj === null) {\n    return results;\n  }\n\n  _.each(obj, function (value) {\n    results[results.length] = value;\n  });\n\n  return results;\n};\n\n_.identity = function (value) {\n  return value;\n};\n\n_.include = function (obj, target) {\n  var found = false;\n\n  if (obj === null) {\n    return found;\n  }\n\n  if (nativeIndexOf && obj.indexOf === nativeIndexOf) {\n    return obj.indexOf(target) != -1;\n  }\n\n  _.each(obj, function (value) {\n    if (found || (found = value === target)) {\n      return breaker;\n    }\n  });\n\n  return found;\n};\n\n_.includes = function (str, needle) {\n  return str.indexOf(needle) !== -1;\n}; // Underscore Addons\n\n\n_.inherit = function (subclass, superclass) {\n  subclass.prototype = new superclass();\n  subclass.prototype.constructor = subclass;\n  subclass.superclass = superclass.prototype;\n  return subclass;\n};\n\n_.isObject = function (obj) {\n  return obj === Object(obj) && !_.isArray(obj);\n};\n\n_.isEmptyObject = function (obj) {\n  if (_.isObject(obj)) {\n    for (var key in obj) {\n      if (hasOwnProperty.call(obj, key)) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  return false;\n};\n\n_.isUndefined = function (obj) {\n  return obj === void 0;\n};\n\n_.isString = function (obj) {\n  return toString.call(obj) == '[object String]';\n};\n\n_.isDate = function (obj) {\n  return toString.call(obj) == '[object Date]';\n};\n\n_.isNumber = function (obj) {\n  return toString.call(obj) == '[object Number]';\n};\n\n_.isElement = function (obj) {\n  return !!(obj && obj.nodeType === 1);\n};\n\n_.encodeDates = function (obj) {\n  _.each(obj, function (v, k) {\n    if (_.isDate(v)) {\n      obj[k] = _.formatDate(v);\n    } else if (_.isObject(v)) {\n      obj[k] = _.encodeDates(v); // recurse\n    }\n  });\n\n  return obj;\n};\n\n_.timestamp = function () {\n  Date.now = Date.now || function () {\n    return +new Date();\n  };\n\n  return Date.now();\n};\n\n_.formatDate = function (d) {\n  // YYYY-MM-DDTHH:MM:SS in UTC\n  function pad(n) {\n    return n < 10 ? '0' + n : n;\n  }\n\n  return d.getUTCFullYear() + '-' + pad(d.getUTCMonth() + 1) + '-' + pad(d.getUTCDate()) + 'T' + pad(d.getUTCHours()) + ':' + pad(d.getUTCMinutes()) + ':' + pad(d.getUTCSeconds());\n};\n\n_.safewrap = function (f) {\n  return function () {\n    try {\n      return f.apply(this, arguments);\n    } catch (e) {\n      console$1.critical('Implementation error. Please turn on debug and contact support@mixpanel.com.');\n\n      if (Config.DEBUG) {\n        console$1.critical(e);\n      }\n    }\n  };\n};\n\n_.safewrap_class = function (klass, functions) {\n  for (var i = 0; i < functions.length; i++) {\n    klass.prototype[functions[i]] = _.safewrap(klass.prototype[functions[i]]);\n  }\n};\n\n_.safewrap_instance_methods = function (obj) {\n  for (var func in obj) {\n    if (typeof obj[func] === 'function') {\n      obj[func] = _.safewrap(obj[func]);\n    }\n  }\n};\n\n_.strip_empty_properties = function (p) {\n  var ret = {};\n\n  _.each(p, function (v, k) {\n    if (_.isString(v) && v.length > 0) {\n      ret[k] = v;\n    }\n  });\n\n  return ret;\n};\n/*\n * this function returns a copy of object after truncating it.  If\n * passed an Array or Object it will iterate through obj and\n * truncate all the values recursively.\n */\n\n\n_.truncate = function (obj, length) {\n  var ret;\n\n  if (typeof obj === 'string') {\n    ret = obj.slice(0, length);\n  } else if (_.isArray(obj)) {\n    ret = [];\n\n    _.each(obj, function (val) {\n      ret.push(_.truncate(val, length));\n    });\n  } else if (_.isObject(obj)) {\n    ret = {};\n\n    _.each(obj, function (val, key) {\n      ret[key] = _.truncate(val, length);\n    });\n  } else {\n    ret = obj;\n  }\n\n  return ret;\n};\n\n_.JSONEncode = function () {\n  return function (mixed_val) {\n    var value = mixed_val;\n\n    var quote = function quote(string) {\n      var escapable = /[\\\\\"\\x00-\\x1f\\x7f-\\x9f\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g; // eslint-disable-line no-control-regex\n\n      var meta = {\n        // table of character substitutions\n        '\\b': '\\\\b',\n        '\\t': '\\\\t',\n        '\\n': '\\\\n',\n        '\\f': '\\\\f',\n        '\\r': '\\\\r',\n        '\"': '\\\\\"',\n        '\\\\': '\\\\\\\\'\n      };\n      escapable.lastIndex = 0;\n      return escapable.test(string) ? '\"' + string.replace(escapable, function (a) {\n        var c = meta[a];\n        return typeof c === 'string' ? c : \"\\\\u\" + ('0000' + a.charCodeAt(0).toString(16)).slice(-4);\n      }) + '\"' : '\"' + string + '\"';\n    };\n\n    var str = function str(key, holder) {\n      var gap = '';\n      var indent = '    ';\n      var i = 0; // The loop counter.\n\n      var k = ''; // The member key.\n\n      var v = ''; // The member value.\n\n      var length = 0;\n      var mind = gap;\n      var partial = [];\n      var value = holder[key]; // If the value has a toJSON method, call it to obtain a replacement value.\n\n      if (value && typeof value === 'object' && typeof value.toJSON === 'function') {\n        value = value.toJSON(key);\n      } // What happens next depends on the value's type.\n\n\n      switch (typeof value) {\n        case 'string':\n          return quote(value);\n\n        case 'number':\n          // JSON numbers must be finite. Encode non-finite numbers as null.\n          return isFinite(value) ? String(value) : 'null';\n\n        case 'boolean':\n        case 'null':\n          // If the value is a boolean or null, convert it to a string. Note:\n          // typeof null does not produce 'null'. The case is included here in\n          // the remote chance that this gets fixed someday.\n          return String(value);\n\n        case 'object':\n          // If the type is 'object', we might be dealing with an object or an array or\n          // null.\n          // Due to a specification blunder in ECMAScript, typeof null is 'object',\n          // so watch out for that case.\n          if (!value) {\n            return 'null';\n          } // Make an array to hold the partial results of stringifying this object value.\n\n\n          gap += indent;\n          partial = []; // Is the value an array?\n\n          if (toString.apply(value) === '[object Array]') {\n            // The value is an array. Stringify every element. Use null as a placeholder\n            // for non-JSON values.\n            length = value.length;\n\n            for (i = 0; i < length; i += 1) {\n              partial[i] = str(i, value) || 'null';\n            } // Join all of the elements together, separated with commas, and wrap them in\n            // brackets.\n\n\n            v = partial.length === 0 ? '[]' : gap ? '[\\n' + gap + partial.join(',\\n' + gap) + '\\n' + mind + ']' : '[' + partial.join(',') + ']';\n            gap = mind;\n            return v;\n          } // Iterate through all of the keys in the object.\n\n\n          for (k in value) {\n            if (hasOwnProperty.call(value, k)) {\n              v = str(k, value);\n\n              if (v) {\n                partial.push(quote(k) + (gap ? ': ' : ':') + v);\n              }\n            }\n          } // Join all of the member texts together, separated with commas,\n          // and wrap them in braces.\n\n\n          v = partial.length === 0 ? '{}' : gap ? '{' + partial.join(',') + '' + mind + '}' : '{' + partial.join(',') + '}';\n          gap = mind;\n          return v;\n      }\n    }; // Make a fake root object containing our value under the key of ''.\n    // Return the result of stringifying the value.\n\n\n    return str('', {\n      '': value\n    });\n  };\n}();\n/**\n * From https://github.com/douglascrockford/JSON-js/blob/master/json_parse.js\n * Slightly modified to throw a real Error rather than a POJO\n */\n\n\n_.JSONDecode = function () {\n  var at,\n      // The index of the current character\n  ch,\n      // The current character\n  escapee = {\n    '\"': '\"',\n    '\\\\': '\\\\',\n    '/': '/',\n    'b': '\\b',\n    'f': '\\f',\n    'n': '\\n',\n    'r': '\\r',\n    't': '\\t'\n  },\n      text,\n      error = function error(m) {\n    var e = new SyntaxError(m);\n    e.at = at;\n    e.text = text;\n    throw e;\n  },\n      next = function next(c) {\n    // If a c parameter is provided, verify that it matches the current character.\n    if (c && c !== ch) {\n      error('Expected \\'' + c + '\\' instead of \\'' + ch + '\\'');\n    } // Get the next character. When there are no more characters,\n    // return the empty string.\n\n\n    ch = text.charAt(at);\n    at += 1;\n    return ch;\n  },\n      number = function number() {\n    // Parse a number value.\n    var number,\n        string = '';\n\n    if (ch === '-') {\n      string = '-';\n      next('-');\n    }\n\n    while (ch >= '0' && ch <= '9') {\n      string += ch;\n      next();\n    }\n\n    if (ch === '.') {\n      string += '.';\n\n      while (next() && ch >= '0' && ch <= '9') {\n        string += ch;\n      }\n    }\n\n    if (ch === 'e' || ch === 'E') {\n      string += ch;\n      next();\n\n      if (ch === '-' || ch === '+') {\n        string += ch;\n        next();\n      }\n\n      while (ch >= '0' && ch <= '9') {\n        string += ch;\n        next();\n      }\n    }\n\n    number = +string;\n\n    if (!isFinite(number)) {\n      error('Bad number');\n    } else {\n      return number;\n    }\n  },\n      string = function string() {\n    // Parse a string value.\n    var hex,\n        i,\n        string = '',\n        uffff; // When parsing for string values, we must look for \" and \\ characters.\n\n    if (ch === '\"') {\n      while (next()) {\n        if (ch === '\"') {\n          next();\n          return string;\n        }\n\n        if (ch === '\\\\') {\n          next();\n\n          if (ch === 'u') {\n            uffff = 0;\n\n            for (i = 0; i < 4; i += 1) {\n              hex = parseInt(next(), 16);\n\n              if (!isFinite(hex)) {\n                break;\n              }\n\n              uffff = uffff * 16 + hex;\n            }\n\n            string += String.fromCharCode(uffff);\n          } else if (typeof escapee[ch] === 'string') {\n            string += escapee[ch];\n          } else {\n            break;\n          }\n        } else {\n          string += ch;\n        }\n      }\n    }\n\n    error('Bad string');\n  },\n      white = function white() {\n    // Skip whitespace.\n    while (ch && ch <= ' ') {\n      next();\n    }\n  },\n      word = function word() {\n    // true, false, or null.\n    switch (ch) {\n      case 't':\n        next('t');\n        next('r');\n        next('u');\n        next('e');\n        return true;\n\n      case 'f':\n        next('f');\n        next('a');\n        next('l');\n        next('s');\n        next('e');\n        return false;\n\n      case 'n':\n        next('n');\n        next('u');\n        next('l');\n        next('l');\n        return null;\n    }\n\n    error('Unexpected \"' + ch + '\"');\n  },\n      value,\n      // Placeholder for the value function.\n  array = function array() {\n    // Parse an array value.\n    var array = [];\n\n    if (ch === '[') {\n      next('[');\n      white();\n\n      if (ch === ']') {\n        next(']');\n        return array; // empty array\n      }\n\n      while (ch) {\n        array.push(value());\n        white();\n\n        if (ch === ']') {\n          next(']');\n          return array;\n        }\n\n        next(',');\n        white();\n      }\n    }\n\n    error('Bad array');\n  },\n      object = function object() {\n    // Parse an object value.\n    var key,\n        object = {};\n\n    if (ch === '{') {\n      next('{');\n      white();\n\n      if (ch === '}') {\n        next('}');\n        return object; // empty object\n      }\n\n      while (ch) {\n        key = string();\n        white();\n        next(':');\n\n        if (Object.hasOwnProperty.call(object, key)) {\n          error('Duplicate key \"' + key + '\"');\n        }\n\n        object[key] = value();\n        white();\n\n        if (ch === '}') {\n          next('}');\n          return object;\n        }\n\n        next(',');\n        white();\n      }\n    }\n\n    error('Bad object');\n  };\n\n  value = function value() {\n    // Parse a JSON value. It could be an object, an array, a string,\n    // a number, or a word.\n    white();\n\n    switch (ch) {\n      case '{':\n        return object();\n\n      case '[':\n        return array();\n\n      case '\"':\n        return string();\n\n      case '-':\n        return number();\n\n      default:\n        return ch >= '0' && ch <= '9' ? number() : word();\n    }\n  }; // Return the json_parse function. It will have access to all of the\n  // above functions and variables.\n\n\n  return function (source) {\n    var result;\n    text = source;\n    at = 0;\n    ch = ' ';\n    result = value();\n    white();\n\n    if (ch) {\n      error('Syntax error');\n    }\n\n    return result;\n  };\n}();\n\n_.base64Encode = function (data) {\n  var b64 = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n  var o1,\n      o2,\n      o3,\n      h1,\n      h2,\n      h3,\n      h4,\n      bits,\n      i = 0,\n      ac = 0,\n      enc = '',\n      tmp_arr = [];\n\n  if (!data) {\n    return data;\n  }\n\n  data = _.utf8Encode(data);\n\n  do {\n    // pack three octets into four hexets\n    o1 = data.charCodeAt(i++);\n    o2 = data.charCodeAt(i++);\n    o3 = data.charCodeAt(i++);\n    bits = o1 << 16 | o2 << 8 | o3;\n    h1 = bits >> 18 & 0x3f;\n    h2 = bits >> 12 & 0x3f;\n    h3 = bits >> 6 & 0x3f;\n    h4 = bits & 0x3f; // use hexets to index into b64, and append result to encoded string\n\n    tmp_arr[ac++] = b64.charAt(h1) + b64.charAt(h2) + b64.charAt(h3) + b64.charAt(h4);\n  } while (i < data.length);\n\n  enc = tmp_arr.join('');\n\n  switch (data.length % 3) {\n    case 1:\n      enc = enc.slice(0, -2) + '==';\n      break;\n\n    case 2:\n      enc = enc.slice(0, -1) + '=';\n      break;\n  }\n\n  return enc;\n};\n\n_.utf8Encode = function (string) {\n  string = (string + '').replace(/\\r\\n/g, '\\n').replace(/\\r/g, '\\n');\n  var utftext = '',\n      start,\n      end;\n  var stringl = 0,\n      n;\n  start = end = 0;\n  stringl = string.length;\n\n  for (n = 0; n < stringl; n++) {\n    var c1 = string.charCodeAt(n);\n    var enc = null;\n\n    if (c1 < 128) {\n      end++;\n    } else if (c1 > 127 && c1 < 2048) {\n      enc = String.fromCharCode(c1 >> 6 | 192, c1 & 63 | 128);\n    } else {\n      enc = String.fromCharCode(c1 >> 12 | 224, c1 >> 6 & 63 | 128, c1 & 63 | 128);\n    }\n\n    if (enc !== null) {\n      if (end > start) {\n        utftext += string.substring(start, end);\n      }\n\n      utftext += enc;\n      start = end = n + 1;\n    }\n  }\n\n  if (end > start) {\n    utftext += string.substring(start, string.length);\n  }\n\n  return utftext;\n};\n\n_.UUID = function () {\n  // Time/ticks information\n  // 1*new Date() is a cross browser version of Date.now()\n  var T = function T() {\n    var d = 1 * new Date(),\n        i = 0; // this while loop figures how many browser ticks go by\n    // before 1*new Date() returns a new number, ie the amount\n    // of ticks that go by per millisecond\n\n    while (d == 1 * new Date()) {\n      i++;\n    }\n\n    return d.toString(16) + i.toString(16);\n  }; // Math.Random entropy\n\n\n  var R = function R() {\n    return Math.random().toString(16).replace('.', '');\n  }; // User agent entropy\n  // This function takes the user agent string, and then xors\n  // together each sequence of 8 bytes.  This produces a final\n  // sequence of 8 bytes which it returns as hex.\n\n\n  var UA = function UA() {\n    var ua = userAgent,\n        i,\n        ch,\n        buffer = [],\n        ret = 0;\n\n    function xor(result, byte_array) {\n      var j,\n          tmp = 0;\n\n      for (j = 0; j < byte_array.length; j++) {\n        tmp |= buffer[j] << j * 8;\n      }\n\n      return result ^ tmp;\n    }\n\n    for (i = 0; i < ua.length; i++) {\n      ch = ua.charCodeAt(i);\n      buffer.unshift(ch & 0xFF);\n\n      if (buffer.length >= 4) {\n        ret = xor(ret, buffer);\n        buffer = [];\n      }\n    }\n\n    if (buffer.length > 0) {\n      ret = xor(ret, buffer);\n    }\n\n    return ret.toString(16);\n  };\n\n  return function () {\n    var se = (screen.height * screen.width).toString(16);\n    return T() + '-' + R() + '-' + UA() + '-' + se + '-' + T();\n  };\n}(); // _.isBlockedUA()\n// This is to block various web spiders from executing our JS and\n// sending false tracking data\n\n\n_.isBlockedUA = function (ua) {\n  if (/(google web preview|baiduspider|yandexbot|bingbot|googlebot|yahoo! slurp)/i.test(ua)) {\n    return true;\n  }\n\n  return false;\n};\n/**\n * @param {Object=} formdata\n * @param {string=} arg_separator\n */\n\n\n_.HTTPBuildQuery = function (formdata, arg_separator) {\n  var use_val,\n      use_key,\n      tmp_arr = [];\n\n  if (_.isUndefined(arg_separator)) {\n    arg_separator = '&';\n  }\n\n  _.each(formdata, function (val, key) {\n    use_val = encodeURIComponent(val.toString());\n    use_key = encodeURIComponent(key);\n    tmp_arr[tmp_arr.length] = use_key + '=' + use_val;\n  });\n\n  return tmp_arr.join(arg_separator);\n};\n\n_.getQueryParam = function (url, param) {\n  // Expects a raw URL\n  param = param.replace(/[[]/, '\\\\[').replace(/[\\]]/, '\\\\]');\n  var regexS = '[\\\\?&]' + param + '=([^&#]*)',\n      regex = new RegExp(regexS),\n      results = regex.exec(url);\n\n  if (results === null || results && typeof results[1] !== 'string' && results[1].length) {\n    return '';\n  } else {\n    var result = results[1];\n\n    try {\n      result = decodeURIComponent(result);\n    } catch (err) {\n      console$1.error('Skipping decoding for malformed query param: ' + result);\n    }\n\n    return result.replace(/\\+/g, ' ');\n  }\n};\n\n_.getHashParam = function (hash, param) {\n  var matches = hash.match(new RegExp(param + '=([^&]*)'));\n  return matches ? matches[1] : null;\n}; // _.cookie\n// Methods partially borrowed from quirksmode.org/js/cookies.html\n\n\n_.cookie = {\n  get: function get(name) {\n    var nameEQ = name + '=';\n    var ca = document$1.cookie.split(';');\n\n    for (var i = 0; i < ca.length; i++) {\n      var c = ca[i];\n\n      while (c.charAt(0) == ' ') {\n        c = c.substring(1, c.length);\n      }\n\n      if (c.indexOf(nameEQ) === 0) {\n        return decodeURIComponent(c.substring(nameEQ.length, c.length));\n      }\n    }\n\n    return null;\n  },\n  parse: function parse(name) {\n    var cookie;\n\n    try {\n      cookie = _.JSONDecode(_.cookie.get(name)) || {};\n    } catch (err) {// noop\n    }\n\n    return cookie;\n  },\n  set_seconds: function set_seconds(name, value, seconds, is_cross_subdomain, is_secure, is_cross_site, domain_override) {\n    var cdomain = '',\n        expires = '',\n        secure = '';\n\n    if (domain_override) {\n      cdomain = '; domain=' + domain_override;\n    } else if (is_cross_subdomain) {\n      var domain = extract_domain(document$1.location.hostname);\n      cdomain = domain ? '; domain=.' + domain : '';\n    }\n\n    if (seconds) {\n      var date = new Date();\n      date.setTime(date.getTime() + seconds * 1000);\n      expires = '; expires=' + date.toGMTString();\n    }\n\n    if (is_cross_site) {\n      is_secure = true;\n      secure = '; SameSite=None';\n    }\n\n    if (is_secure) {\n      secure += '; secure';\n    }\n\n    document$1.cookie = name + '=' + encodeURIComponent(value) + expires + '; path=/' + cdomain + secure;\n  },\n  set: function set(name, value, days, is_cross_subdomain, is_secure, is_cross_site, domain_override) {\n    var cdomain = '',\n        expires = '',\n        secure = '';\n\n    if (domain_override) {\n      cdomain = '; domain=' + domain_override;\n    } else if (is_cross_subdomain) {\n      var domain = extract_domain(document$1.location.hostname);\n      cdomain = domain ? '; domain=.' + domain : '';\n    }\n\n    if (days) {\n      var date = new Date();\n      date.setTime(date.getTime() + days * 24 * 60 * 60 * 1000);\n      expires = '; expires=' + date.toGMTString();\n    }\n\n    if (is_cross_site) {\n      is_secure = true;\n      secure = '; SameSite=None';\n    }\n\n    if (is_secure) {\n      secure += '; secure';\n    }\n\n    var new_cookie_val = name + '=' + encodeURIComponent(value) + expires + '; path=/' + cdomain + secure;\n    document$1.cookie = new_cookie_val;\n    return new_cookie_val;\n  },\n  remove: function remove(name, is_cross_subdomain, domain_override) {\n    _.cookie.set(name, '', -1, is_cross_subdomain, false, false, domain_override);\n  }\n};\nvar _localStorageSupported = null;\n\nvar localStorageSupported = function localStorageSupported(storage, forceCheck) {\n  if (_localStorageSupported !== null && !forceCheck) {\n    return _localStorageSupported;\n  }\n\n  var supported = true;\n\n  try {\n    storage = storage || window.localStorage;\n    var key = '__mplss_' + cheap_guid(8),\n        val = 'xyz';\n    storage.setItem(key, val);\n\n    if (storage.getItem(key) !== val) {\n      supported = false;\n    }\n\n    storage.removeItem(key);\n  } catch (err) {\n    supported = false;\n  }\n\n  _localStorageSupported = supported;\n  return supported;\n}; // _.localStorage\n\n\n_.localStorage = {\n  is_supported: function is_supported(force_check) {\n    var supported = localStorageSupported(null, force_check);\n\n    if (!supported) {\n      console$1.error('localStorage unsupported; falling back to cookie store');\n    }\n\n    return supported;\n  },\n  error: function error(msg) {\n    console$1.error('localStorage error: ' + msg);\n  },\n  get: function get(name) {\n    try {\n      return window.localStorage.getItem(name);\n    } catch (err) {\n      _.localStorage.error(err);\n    }\n\n    return null;\n  },\n  parse: function parse(name) {\n    try {\n      return _.JSONDecode(_.localStorage.get(name)) || {};\n    } catch (err) {// noop\n    }\n\n    return null;\n  },\n  set: function set(name, value) {\n    try {\n      window.localStorage.setItem(name, value);\n    } catch (err) {\n      _.localStorage.error(err);\n    }\n  },\n  remove: function remove(name) {\n    try {\n      window.localStorage.removeItem(name);\n    } catch (err) {\n      _.localStorage.error(err);\n    }\n  }\n};\n\n_.register_event = function () {\n  // written by Dean Edwards, 2005\n  // with input from Tino Zijdel - crisp@xs4all.nl\n  // with input from Carl Sverre - mail@carlsverre.com\n  // with input from Mixpanel\n  // http://dean.edwards.name/weblog/2005/10/add-event/\n  // https://gist.github.com/1930440\n\n  /**\n   * @param {Object} element\n   * @param {string} type\n   * @param {function(...*)} handler\n   * @param {boolean=} oldSchool\n   * @param {boolean=} useCapture\n   */\n  var register_event = function register_event(element, type, handler, oldSchool, useCapture) {\n    if (!element) {\n      console$1.error('No valid element provided to register_event');\n      return;\n    }\n\n    if (element.addEventListener && !oldSchool) {\n      element.addEventListener(type, handler, !!useCapture);\n    } else {\n      var ontype = 'on' + type;\n      var old_handler = element[ontype]; // can be undefined\n\n      element[ontype] = makeHandler(element, handler, old_handler);\n    }\n  };\n\n  function makeHandler(element, new_handler, old_handlers) {\n    var handler = function handler(event) {\n      event = event || fixEvent(window.event); // this basically happens in firefox whenever another script\n      // overwrites the onload callback and doesn't pass the event\n      // object to previously defined callbacks.  All the browsers\n      // that don't define window.event implement addEventListener\n      // so the dom_loaded handler will still be fired as usual.\n\n      if (!event) {\n        return undefined;\n      }\n\n      var ret = true;\n      var old_result, new_result;\n\n      if (_.isFunction(old_handlers)) {\n        old_result = old_handlers(event);\n      }\n\n      new_result = new_handler.call(element, event);\n\n      if (false === old_result || false === new_result) {\n        ret = false;\n      }\n\n      return ret;\n    };\n\n    return handler;\n  }\n\n  function fixEvent(event) {\n    if (event) {\n      event.preventDefault = fixEvent.preventDefault;\n      event.stopPropagation = fixEvent.stopPropagation;\n    }\n\n    return event;\n  }\n\n  fixEvent.preventDefault = function () {\n    this.returnValue = false;\n  };\n\n  fixEvent.stopPropagation = function () {\n    this.cancelBubble = true;\n  };\n\n  return register_event;\n}();\n\nvar TOKEN_MATCH_REGEX = new RegExp('^(\\\\w*)\\\\[(\\\\w+)([=~\\\\|\\\\^\\\\$\\\\*]?)=?\"?([^\\\\]\"]*)\"?\\\\]$');\n\n_.dom_query = function () {\n  /* document.getElementsBySelector(selector)\n  - returns an array of element objects from the current document\n  matching the CSS selector. Selectors can contain element names,\n  class names and ids and can be nested. For example:\n   elements = document.getElementsBySelector('div#main p a.external')\n   Will return an array of all 'a' elements with 'external' in their\n  class attribute that are contained inside 'p' elements that are\n  contained inside the 'div' element which has id=\"main\"\n   New in version 0.4: Support for CSS2 and CSS3 attribute selectors:\n  See http://www.w3.org/TR/css3-selectors/#attribute-selectors\n   Version 0.4 - Simon Willison, March 25th 2003\n  -- Works in Phoenix 0.5, Mozilla 1.3, Opera 7, Internet Explorer 6, Internet Explorer 5 on Windows\n  -- Opera 7 fails\n   Version 0.5 - Carl Sverre, Jan 7th 2013\n  -- Now uses jQuery-esque `hasClass` for testing class name\n  equality.  This fixes a bug related to '-' characters being\n  considered not part of a 'word' in regex.\n  */\n  function getAllChildren(e) {\n    // Returns all children of element. Workaround required for IE5/Windows. Ugh.\n    return e.all ? e.all : e.getElementsByTagName('*');\n  }\n\n  var bad_whitespace = /[\\t\\r\\n]/g;\n\n  function hasClass(elem, selector) {\n    var className = ' ' + selector + ' ';\n    return (' ' + elem.className + ' ').replace(bad_whitespace, ' ').indexOf(className) >= 0;\n  }\n\n  function getElementsBySelector(selector) {\n    // Attempt to fail gracefully in lesser browsers\n    if (!document$1.getElementsByTagName) {\n      return [];\n    } // Split selector in to tokens\n\n\n    var tokens = selector.split(' ');\n    var token, bits, tagName, found, foundCount, i, j, k, elements, currentContextIndex;\n    var currentContext = [document$1];\n\n    for (i = 0; i < tokens.length; i++) {\n      token = tokens[i].replace(/^\\s+/, '').replace(/\\s+$/, '');\n\n      if (token.indexOf('#') > -1) {\n        // Token is an ID selector\n        bits = token.split('#');\n        tagName = bits[0];\n        var id = bits[1];\n        var element = document$1.getElementById(id);\n\n        if (!element || tagName && element.nodeName.toLowerCase() != tagName) {\n          // element not found or tag with that ID not found, return false\n          return [];\n        } // Set currentContext to contain just this element\n\n\n        currentContext = [element];\n        continue; // Skip to next token\n      }\n\n      if (token.indexOf('.') > -1) {\n        // Token contains a class selector\n        bits = token.split('.');\n        tagName = bits[0];\n        var className = bits[1];\n\n        if (!tagName) {\n          tagName = '*';\n        } // Get elements matching tag, filter them for class selector\n\n\n        found = [];\n        foundCount = 0;\n\n        for (j = 0; j < currentContext.length; j++) {\n          if (tagName == '*') {\n            elements = getAllChildren(currentContext[j]);\n          } else {\n            elements = currentContext[j].getElementsByTagName(tagName);\n          }\n\n          for (k = 0; k < elements.length; k++) {\n            found[foundCount++] = elements[k];\n          }\n        }\n\n        currentContext = [];\n        currentContextIndex = 0;\n\n        for (j = 0; j < found.length; j++) {\n          if (found[j].className && _.isString(found[j].className) && // some SVG elements have classNames which are not strings\n          hasClass(found[j], className)) {\n            currentContext[currentContextIndex++] = found[j];\n          }\n        }\n\n        continue; // Skip to next token\n      } // Code to deal with attribute selectors\n\n\n      var token_match = token.match(TOKEN_MATCH_REGEX);\n\n      if (token_match) {\n        tagName = token_match[1];\n        var attrName = token_match[2];\n        var attrOperator = token_match[3];\n        var attrValue = token_match[4];\n\n        if (!tagName) {\n          tagName = '*';\n        } // Grab all of the tagName elements within current context\n\n\n        found = [];\n        foundCount = 0;\n\n        for (j = 0; j < currentContext.length; j++) {\n          if (tagName == '*') {\n            elements = getAllChildren(currentContext[j]);\n          } else {\n            elements = currentContext[j].getElementsByTagName(tagName);\n          }\n\n          for (k = 0; k < elements.length; k++) {\n            found[foundCount++] = elements[k];\n          }\n        }\n\n        currentContext = [];\n        currentContextIndex = 0;\n        var checkFunction; // This function will be used to filter the elements\n\n        switch (attrOperator) {\n          case '=':\n            // Equality\n            checkFunction = function checkFunction(e) {\n              return e.getAttribute(attrName) == attrValue;\n            };\n\n            break;\n\n          case '~':\n            // Match one of space seperated words\n            checkFunction = function checkFunction(e) {\n              return e.getAttribute(attrName).match(new RegExp('\\\\b' + attrValue + '\\\\b'));\n            };\n\n            break;\n\n          case '|':\n            // Match start with value followed by optional hyphen\n            checkFunction = function checkFunction(e) {\n              return e.getAttribute(attrName).match(new RegExp('^' + attrValue + '-?'));\n            };\n\n            break;\n\n          case '^':\n            // Match starts with value\n            checkFunction = function checkFunction(e) {\n              return e.getAttribute(attrName).indexOf(attrValue) === 0;\n            };\n\n            break;\n\n          case '$':\n            // Match ends with value - fails with \"Warning\" in Opera 7\n            checkFunction = function checkFunction(e) {\n              return e.getAttribute(attrName).lastIndexOf(attrValue) == e.getAttribute(attrName).length - attrValue.length;\n            };\n\n            break;\n\n          case '*':\n            // Match ends with value\n            checkFunction = function checkFunction(e) {\n              return e.getAttribute(attrName).indexOf(attrValue) > -1;\n            };\n\n            break;\n\n          default:\n            // Just test for existence of attribute\n            checkFunction = function checkFunction(e) {\n              return e.getAttribute(attrName);\n            };\n\n        }\n\n        currentContext = [];\n        currentContextIndex = 0;\n\n        for (j = 0; j < found.length; j++) {\n          if (checkFunction(found[j])) {\n            currentContext[currentContextIndex++] = found[j];\n          }\n        } // alert('Attribute Selector: '+tagName+' '+attrName+' '+attrOperator+' '+attrValue);\n\n\n        continue; // Skip to next token\n      } // If we get here, token is JUST an element (not a class or ID selector)\n\n\n      tagName = token;\n      found = [];\n      foundCount = 0;\n\n      for (j = 0; j < currentContext.length; j++) {\n        elements = currentContext[j].getElementsByTagName(tagName);\n\n        for (k = 0; k < elements.length; k++) {\n          found[foundCount++] = elements[k];\n        }\n      }\n\n      currentContext = found;\n    }\n\n    return currentContext;\n  }\n\n  return function (query) {\n    if (_.isElement(query)) {\n      return [query];\n    } else if (_.isObject(query) && !_.isUndefined(query.length)) {\n      return query;\n    } else {\n      return getElementsBySelector.call(this, query);\n    }\n  };\n}();\n\n_.info = {\n  campaignParams: function campaignParams() {\n    var campaign_keywords = 'utm_source utm_medium utm_campaign utm_content utm_term'.split(' '),\n        kw = '',\n        params = {};\n\n    _.each(campaign_keywords, function (kwkey) {\n      kw = _.getQueryParam(document$1.URL, kwkey);\n\n      if (kw.length) {\n        params[kwkey] = kw;\n      }\n    });\n\n    return params;\n  },\n  searchEngine: function searchEngine(referrer) {\n    if (referrer.search('https?://(.*)google.([^/?]*)') === 0) {\n      return 'google';\n    } else if (referrer.search('https?://(.*)bing.com') === 0) {\n      return 'bing';\n    } else if (referrer.search('https?://(.*)yahoo.com') === 0) {\n      return 'yahoo';\n    } else if (referrer.search('https?://(.*)duckduckgo.com') === 0) {\n      return 'duckduckgo';\n    } else {\n      return null;\n    }\n  },\n  searchInfo: function searchInfo(referrer) {\n    var search = _.info.searchEngine(referrer),\n        param = search != 'yahoo' ? 'q' : 'p',\n        ret = {};\n\n    if (search !== null) {\n      ret['$search_engine'] = search;\n\n      var keyword = _.getQueryParam(referrer, param);\n\n      if (keyword.length) {\n        ret['mp_keyword'] = keyword;\n      }\n    }\n\n    return ret;\n  },\n\n  /**\n   * This function detects which browser is running this script.\n   * The order of the checks are important since many user agents\n   * include key words used in later checks.\n   */\n  browser: function browser(user_agent, vendor, opera) {\n    vendor = vendor || ''; // vendor is undefined for at least IE9\n\n    if (opera || _.includes(user_agent, ' OPR/')) {\n      if (_.includes(user_agent, 'Mini')) {\n        return 'Opera Mini';\n      }\n\n      return 'Opera';\n    } else if (/(BlackBerry|PlayBook|BB10)/i.test(user_agent)) {\n      return 'BlackBerry';\n    } else if (_.includes(user_agent, 'IEMobile') || _.includes(user_agent, 'WPDesktop')) {\n      return 'Internet Explorer Mobile';\n    } else if (_.includes(user_agent, 'SamsungBrowser/')) {\n      // https://developer.samsung.com/internet/user-agent-string-format\n      return 'Samsung Internet';\n    } else if (_.includes(user_agent, 'Edge') || _.includes(user_agent, 'Edg/')) {\n      return 'Microsoft Edge';\n    } else if (_.includes(user_agent, 'FBIOS')) {\n      return 'Facebook Mobile';\n    } else if (_.includes(user_agent, 'Chrome')) {\n      return 'Chrome';\n    } else if (_.includes(user_agent, 'CriOS')) {\n      return 'Chrome iOS';\n    } else if (_.includes(user_agent, 'UCWEB') || _.includes(user_agent, 'UCBrowser')) {\n      return 'UC Browser';\n    } else if (_.includes(user_agent, 'FxiOS')) {\n      return 'Firefox iOS';\n    } else if (_.includes(vendor, 'Apple')) {\n      if (_.includes(user_agent, 'Mobile')) {\n        return 'Mobile Safari';\n      }\n\n      return 'Safari';\n    } else if (_.includes(user_agent, 'Android')) {\n      return 'Android Mobile';\n    } else if (_.includes(user_agent, 'Konqueror')) {\n      return 'Konqueror';\n    } else if (_.includes(user_agent, 'Firefox')) {\n      return 'Firefox';\n    } else if (_.includes(user_agent, 'MSIE') || _.includes(user_agent, 'Trident/')) {\n      return 'Internet Explorer';\n    } else if (_.includes(user_agent, 'Gecko')) {\n      return 'Mozilla';\n    } else {\n      return '';\n    }\n  },\n\n  /**\n   * This function detects which browser version is running this script,\n   * parsing major and minor version (e.g., 42.1). User agent strings from:\n   * http://www.useragentstring.com/pages/useragentstring.php\n   */\n  browserVersion: function browserVersion(userAgent, vendor, opera) {\n    var browser = _.info.browser(userAgent, vendor, opera);\n\n    var versionRegexs = {\n      'Internet Explorer Mobile': /rv:(\\d+(\\.\\d+)?)/,\n      'Microsoft Edge': /Edge?\\/(\\d+(\\.\\d+)?)/,\n      'Chrome': /Chrome\\/(\\d+(\\.\\d+)?)/,\n      'Chrome iOS': /CriOS\\/(\\d+(\\.\\d+)?)/,\n      'UC Browser': /(UCBrowser|UCWEB)\\/(\\d+(\\.\\d+)?)/,\n      'Safari': /Version\\/(\\d+(\\.\\d+)?)/,\n      'Mobile Safari': /Version\\/(\\d+(\\.\\d+)?)/,\n      'Opera': /(Opera|OPR)\\/(\\d+(\\.\\d+)?)/,\n      'Firefox': /Firefox\\/(\\d+(\\.\\d+)?)/,\n      'Firefox iOS': /FxiOS\\/(\\d+(\\.\\d+)?)/,\n      'Konqueror': /Konqueror:(\\d+(\\.\\d+)?)/,\n      'BlackBerry': /BlackBerry (\\d+(\\.\\d+)?)/,\n      'Android Mobile': /android\\s(\\d+(\\.\\d+)?)/,\n      'Samsung Internet': /SamsungBrowser\\/(\\d+(\\.\\d+)?)/,\n      'Internet Explorer': /(rv:|MSIE )(\\d+(\\.\\d+)?)/,\n      'Mozilla': /rv:(\\d+(\\.\\d+)?)/\n    };\n    var regex = versionRegexs[browser];\n\n    if (regex === undefined) {\n      return null;\n    }\n\n    var matches = userAgent.match(regex);\n\n    if (!matches) {\n      return null;\n    }\n\n    return parseFloat(matches[matches.length - 2]);\n  },\n  os: function os() {\n    var a = userAgent;\n\n    if (/Windows/i.test(a)) {\n      if (/Phone/.test(a) || /WPDesktop/.test(a)) {\n        return 'Windows Phone';\n      }\n\n      return 'Windows';\n    } else if (/(iPhone|iPad|iPod)/.test(a)) {\n      return 'iOS';\n    } else if (/Android/.test(a)) {\n      return 'Android';\n    } else if (/(BlackBerry|PlayBook|BB10)/i.test(a)) {\n      return 'BlackBerry';\n    } else if (/Mac/i.test(a)) {\n      return 'Mac OS X';\n    } else if (/Linux/.test(a)) {\n      return 'Linux';\n    } else if (/CrOS/.test(a)) {\n      return 'Chrome OS';\n    } else {\n      return '';\n    }\n  },\n  device: function device(user_agent) {\n    if (/Windows Phone/i.test(user_agent) || /WPDesktop/.test(user_agent)) {\n      return 'Windows Phone';\n    } else if (/iPad/.test(user_agent)) {\n      return 'iPad';\n    } else if (/iPod/.test(user_agent)) {\n      return 'iPod Touch';\n    } else if (/iPhone/.test(user_agent)) {\n      return 'iPhone';\n    } else if (/(BlackBerry|PlayBook|BB10)/i.test(user_agent)) {\n      return 'BlackBerry';\n    } else if (/Android/.test(user_agent)) {\n      return 'Android';\n    } else {\n      return '';\n    }\n  },\n  referringDomain: function referringDomain(referrer) {\n    var split = referrer.split('/');\n\n    if (split.length >= 3) {\n      return split[2];\n    }\n\n    return '';\n  },\n  properties: function properties() {\n    return _.extend(_.strip_empty_properties({\n      '$os': _.info.os(),\n      '$browser': _.info.browser(userAgent, navigator$1.vendor, windowOpera),\n      '$referrer': document$1.referrer,\n      '$referring_domain': _.info.referringDomain(document$1.referrer),\n      '$device': _.info.device(userAgent)\n    }), {\n      '$current_url': window$1.location.href,\n      '$browser_version': _.info.browserVersion(userAgent, navigator$1.vendor, windowOpera),\n      '$screen_height': screen.height,\n      '$screen_width': screen.width,\n      'mp_lib': 'web',\n      '$lib_version': Config.LIB_VERSION,\n      '$insert_id': cheap_guid(),\n      'time': _.timestamp() / 1000 // epoch time in seconds\n\n    });\n  },\n  people_properties: function people_properties() {\n    return _.extend(_.strip_empty_properties({\n      '$os': _.info.os(),\n      '$browser': _.info.browser(userAgent, navigator$1.vendor, windowOpera)\n    }), {\n      '$browser_version': _.info.browserVersion(userAgent, navigator$1.vendor, windowOpera)\n    });\n  },\n  pageviewInfo: function pageviewInfo(page) {\n    return _.strip_empty_properties({\n      'mp_page': page,\n      'mp_referrer': document$1.referrer,\n      'mp_browser': _.info.browser(userAgent, navigator$1.vendor, windowOpera),\n      'mp_platform': _.info.os()\n    });\n  }\n};\n\nvar cheap_guid = function cheap_guid(maxlen) {\n  var guid = Math.random().toString(36).substring(2, 10) + Math.random().toString(36).substring(2, 10);\n  return maxlen ? guid.substring(0, maxlen) : guid;\n};\n/**\n * Check deterministically whether to include or exclude from a feature rollout/test based on the\n * given string and the desired percentage to include.\n * @param {String} str - string to run the check against (for instance a project's token)\n * @param {String} feature - name of feature (for inclusion in hash, to ensure different results\n * for different features)\n * @param {Number} percent_allowed - percentage chance that a given string will be included\n * @returns {Boolean} whether the given string should be included\n */\n\n\nvar determine_eligibility = _.safewrap(function (str, feature, percent_allowed) {\n  str = str + feature; // Bernstein's hash: http://www.cse.yorku.ca/~oz/hash.html#djb2\n\n  var hash = 5381;\n\n  for (var i = 0; i < str.length; i++) {\n    hash = (hash << 5) + hash + str.charCodeAt(i);\n    hash = hash & hash;\n  }\n\n  var dart = (hash >>> 0) % 100;\n  return dart < percent_allowed;\n}); // naive way to extract domain name (example.com) from full hostname (my.sub.example.com)\n\n\nvar SIMPLE_DOMAIN_MATCH_REGEX = /[a-z0-9][a-z0-9-]*\\.[a-z]+$/i; // this next one attempts to account for some ccSLDs, e.g. extracting oxford.ac.uk from www.oxford.ac.uk\n\nvar DOMAIN_MATCH_REGEX = /[a-z0-9][a-z0-9-]+\\.[a-z.]{2,6}$/i;\n/**\n * Attempts to extract main domain name from full hostname, using a few blunt heuristics. For\n * common TLDs like .com/.org that always have a simple SLD.TLD structure (example.com), we\n * simply extract the last two .-separated parts of the hostname (SIMPLE_DOMAIN_MATCH_REGEX).\n * For others, we attempt to account for short ccSLD+TLD combos (.ac.uk) with the legacy\n * DOMAIN_MATCH_REGEX (kept to maintain backwards compatibility with existing Mixpanel\n * integrations). The only _reliable_ way to extract domain from hostname is with an up-to-date\n * list like at https://publicsuffix.org/ so for cases that this helper fails at, the SDK\n * offers the 'cookie_domain' config option to set it explicitly.\n * @example\n * extract_domain('my.sub.example.com')\n * // 'example.com'\n */\n\nvar extract_domain = function extract_domain(hostname) {\n  var domain_regex = DOMAIN_MATCH_REGEX;\n  var parts = hostname.split('.');\n  var tld = parts[parts.length - 1];\n\n  if (tld.length > 4 || tld === 'com' || tld === 'org') {\n    domain_regex = SIMPLE_DOMAIN_MATCH_REGEX;\n  }\n\n  var matches = hostname.match(domain_regex);\n  return matches ? matches[0] : '';\n};\n\nvar JSONStringify = null;\nvar JSONParse = null;\n\nif (typeof JSON !== 'undefined') {\n  JSONStringify = JSON.stringify;\n  JSONParse = JSON.parse;\n}\n\nJSONStringify = JSONStringify || _.JSONEncode;\nJSONParse = JSONParse || _.JSONDecode; // EXPORTS (for closure compiler)\n\n_['toArray'] = _.toArray;\n_['isObject'] = _.isObject;\n_['JSONEncode'] = _.JSONEncode;\n_['JSONDecode'] = _.JSONDecode;\n_['isBlockedUA'] = _.isBlockedUA;\n_['isEmptyObject'] = _.isEmptyObject;\n_['info'] = _.info;\n_['info']['device'] = _.info.device;\n_['info']['browser'] = _.info.browser;\n_['info']['browserVersion'] = _.info.browserVersion;\n_['info']['properties'] = _.info.properties;\n/*\n * Get the className of an element, accounting for edge cases where element.className is an object\n * @param {Element} el - element to get the className of\n * @returns {string} the element's class\n */\n\nfunction getClassName(el) {\n  switch (typeof el.className) {\n    case 'string':\n      return el.className;\n\n    case 'object':\n      // handle cases where className might be SVGAnimatedString or some other type\n      return el.className.baseVal || el.getAttribute('class') || '';\n\n    default:\n      // future proof\n      return '';\n  }\n}\n/*\n * Get the direct text content of an element, protecting against sensitive data collection.\n * Concats textContent of each of the element's text node children; this avoids potential\n * collection of sensitive data that could happen if we used element.textContent and the\n * element had sensitive child elements, since element.textContent includes child content.\n * Scrubs values that look like they could be sensitive (i.e. cc or ssn number).\n * @param {Element} el - element to get the text of\n * @returns {string} the element's direct text content\n */\n\n\nfunction getSafeText(el) {\n  var elText = '';\n\n  if (shouldTrackElement(el) && el.childNodes && el.childNodes.length) {\n    _.each(el.childNodes, function (child) {\n      if (isTextNode(child) && child.textContent) {\n        elText += _.trim(child.textContent) // scrub potentially sensitive values\n        .split(/(\\s+)/).filter(shouldTrackValue).join('') // normalize whitespace\n        .replace(/[\\r\\n]/g, ' ').replace(/[ ]+/g, ' ') // truncate\n        .substring(0, 255);\n      }\n    });\n  }\n\n  return _.trim(elText);\n}\n/*\n * Check whether an element has nodeType Node.ELEMENT_NODE\n * @param {Element} el - element to check\n * @returns {boolean} whether el is of the correct nodeType\n */\n\n\nfunction isElementNode(el) {\n  return el && el.nodeType === 1; // Node.ELEMENT_NODE - use integer constant for browser portability\n}\n/*\n * Check whether an element is of a given tag type.\n * Due to potential reference discrepancies (such as the webcomponents.js polyfill),\n * we want to match tagNames instead of specific references because something like\n * element === document.body won't always work because element might not be a native\n * element.\n * @param {Element} el - element to check\n * @param {string} tag - tag name (e.g., \"div\")\n * @returns {boolean} whether el is of the given tag type\n */\n\n\nfunction isTag(el, tag) {\n  return el && el.tagName && el.tagName.toLowerCase() === tag.toLowerCase();\n}\n/*\n * Check whether an element has nodeType Node.TEXT_NODE\n * @param {Element} el - element to check\n * @returns {boolean} whether el is of the correct nodeType\n */\n\n\nfunction isTextNode(el) {\n  return el && el.nodeType === 3; // Node.TEXT_NODE - use integer constant for browser portability\n}\n/*\n * Check whether a DOM event should be \"tracked\" or if it may contain sentitive data\n * using a variety of heuristics.\n * @param {Element} el - element to check\n * @param {Event} event - event to check\n * @returns {boolean} whether the event should be tracked\n */\n\n\nfunction shouldTrackDomEvent(el, event) {\n  if (!el || isTag(el, 'html') || !isElementNode(el)) {\n    return false;\n  }\n\n  var tag = el.tagName.toLowerCase();\n\n  switch (tag) {\n    case 'html':\n      return false;\n\n    case 'form':\n      return event.type === 'submit';\n\n    case 'input':\n      if (['button', 'submit'].indexOf(el.getAttribute('type')) === -1) {\n        return event.type === 'change';\n      } else {\n        return event.type === 'click';\n      }\n\n    case 'select':\n    case 'textarea':\n      return event.type === 'change';\n\n    default:\n      return event.type === 'click';\n  }\n}\n/*\n * Check whether a DOM element should be \"tracked\" or if it may contain sentitive data\n * using a variety of heuristics.\n * @param {Element} el - element to check\n * @returns {boolean} whether the element should be tracked\n */\n\n\nfunction shouldTrackElement(el) {\n  for (var curEl = el; curEl.parentNode && !isTag(curEl, 'body'); curEl = curEl.parentNode) {\n    var classes = getClassName(curEl).split(' ');\n\n    if (_.includes(classes, 'mp-sensitive') || _.includes(classes, 'mp-no-track')) {\n      return false;\n    }\n  }\n\n  if (_.includes(getClassName(el).split(' '), 'mp-include')) {\n    return true;\n  } // don't send data from inputs or similar elements since there will always be\n  // a risk of clientside javascript placing sensitive data in attributes\n\n\n  if (isTag(el, 'input') || isTag(el, 'select') || isTag(el, 'textarea') || el.getAttribute('contenteditable') === 'true') {\n    return false;\n  } // don't include hidden or password fields\n\n\n  var type = el.type || '';\n\n  if (typeof type === 'string') {\n    // it's possible for el.type to be a DOM element if el is a form with a child input[name=\"type\"]\n    switch (type.toLowerCase()) {\n      case 'hidden':\n        return false;\n\n      case 'password':\n        return false;\n    }\n  } // filter out data from fields that look like sensitive fields\n\n\n  var name = el.name || el.id || '';\n\n  if (typeof name === 'string') {\n    // it's possible for el.name or el.id to be a DOM element if el is a form with a child input[name=\"name\"]\n    var sensitiveNameRegex = /^cc|cardnum|ccnum|creditcard|csc|cvc|cvv|exp|pass|pwd|routing|seccode|securitycode|securitynum|socialsec|socsec|ssn/i;\n\n    if (sensitiveNameRegex.test(name.replace(/[^a-zA-Z0-9]/g, ''))) {\n      return false;\n    }\n  }\n\n  return true;\n}\n/*\n * Check whether a string value should be \"tracked\" or if it may contain sentitive data\n * using a variety of heuristics.\n * @param {string} value - string value to check\n * @returns {boolean} whether the element should be tracked\n */\n\n\nfunction shouldTrackValue(value) {\n  if (value === null || _.isUndefined(value)) {\n    return false;\n  }\n\n  if (typeof value === 'string') {\n    value = _.trim(value); // check to see if input value looks like a credit card number\n    // see: https://www.safaribooksonline.com/library/view/regular-expressions-cookbook/9781449327453/ch04s20.html\n\n    var ccRegex = /^(?:(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11}))$/;\n\n    if (ccRegex.test((value || '').replace(/[- ]/g, ''))) {\n      return false;\n    } // check to see if input value looks like a social security number\n\n\n    var ssnRegex = /(^\\d{3}-?\\d{2}-?\\d{4}$)/;\n\n    if (ssnRegex.test(value)) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nvar autotrack = {\n  _initializedTokens: [],\n  _previousElementSibling: function _previousElementSibling(el) {\n    if (el.previousElementSibling) {\n      return el.previousElementSibling;\n    } else {\n      do {\n        el = el.previousSibling;\n      } while (el && !isElementNode(el));\n\n      return el;\n    }\n  },\n  _loadScript: function _loadScript(scriptUrlToLoad, callback) {\n    var scriptTag = document.createElement('script');\n    scriptTag.type = 'text/javascript';\n    scriptTag.src = scriptUrlToLoad;\n    scriptTag.onload = callback;\n    var scripts = document.getElementsByTagName('script');\n\n    if (scripts.length > 0) {\n      scripts[0].parentNode.insertBefore(scriptTag, scripts[0]);\n    } else {\n      document.body.appendChild(scriptTag);\n    }\n  },\n  _getPropertiesFromElement: function _getPropertiesFromElement(elem) {\n    var props = {\n      'classes': getClassName(elem).split(' '),\n      'tag_name': elem.tagName.toLowerCase()\n    };\n\n    if (shouldTrackElement(elem)) {\n      _.each(elem.attributes, function (attr) {\n        if (shouldTrackValue(attr.value)) {\n          props['attr__' + attr.name] = attr.value;\n        }\n      });\n    }\n\n    var nthChild = 1;\n    var nthOfType = 1;\n    var currentElem = elem;\n\n    while (currentElem = this._previousElementSibling(currentElem)) {\n      // eslint-disable-line no-cond-assign\n      nthChild++;\n\n      if (currentElem.tagName === elem.tagName) {\n        nthOfType++;\n      }\n    }\n\n    props['nth_child'] = nthChild;\n    props['nth_of_type'] = nthOfType;\n    return props;\n  },\n  _getDefaultProperties: function _getDefaultProperties(eventType) {\n    return {\n      '$event_type': eventType,\n      '$ce_version': 1,\n      '$host': window.location.host,\n      '$pathname': window.location.pathname\n    };\n  },\n  _extractCustomPropertyValue: function _extractCustomPropertyValue(customProperty) {\n    var propValues = [];\n\n    _.each(document.querySelectorAll(customProperty['css_selector']), function (matchedElem) {\n      var value;\n\n      if (['input', 'select'].indexOf(matchedElem.tagName.toLowerCase()) > -1) {\n        value = matchedElem['value'];\n      } else if (matchedElem['textContent']) {\n        value = matchedElem['textContent'];\n      }\n\n      if (shouldTrackValue(value)) {\n        propValues.push(value);\n      }\n    });\n\n    return propValues.join(', ');\n  },\n  _getCustomProperties: function _getCustomProperties(targetElementList) {\n    var props = {};\n\n    _.each(this._customProperties, function (customProperty) {\n      _.each(customProperty['event_selectors'], function (eventSelector) {\n        var eventElements = document.querySelectorAll(eventSelector);\n\n        _.each(eventElements, function (eventElement) {\n          if (_.includes(targetElementList, eventElement) && shouldTrackElement(eventElement)) {\n            props[customProperty['name']] = this._extractCustomPropertyValue(customProperty);\n          }\n        }, this);\n      }, this);\n    }, this);\n\n    return props;\n  },\n  _getEventTarget: function _getEventTarget(e) {\n    // https://developer.mozilla.org/en-US/docs/Web/API/Event/target#Compatibility_notes\n    if (typeof e.target === 'undefined') {\n      return e.srcElement;\n    } else {\n      return e.target;\n    }\n  },\n  _trackEvent: function _trackEvent(e, instance) {\n    /*** Don't mess with this code without running IE8 tests on it ***/\n    var target = this._getEventTarget(e);\n\n    if (isTextNode(target)) {\n      // defeat Safari bug (see: http://www.quirksmode.org/js/events_properties.html)\n      target = target.parentNode;\n    }\n\n    if (shouldTrackDomEvent(target, e)) {\n      var targetElementList = [target];\n      var curEl = target;\n\n      while (curEl.parentNode && !isTag(curEl, 'body')) {\n        targetElementList.push(curEl.parentNode);\n        curEl = curEl.parentNode;\n      }\n\n      var elementsJson = [];\n      var href,\n          explicitNoTrack = false;\n\n      _.each(targetElementList, function (el) {\n        var shouldTrackEl = shouldTrackElement(el); // if the element or a parent element is an anchor tag\n        // include the href as a property\n\n        if (el.tagName.toLowerCase() === 'a') {\n          href = el.getAttribute('href');\n          href = shouldTrackEl && shouldTrackValue(href) && href;\n        } // allow users to programatically prevent tracking of elements by adding class 'mp-no-track'\n\n\n        var classes = getClassName(el).split(' ');\n\n        if (_.includes(classes, 'mp-no-track')) {\n          explicitNoTrack = true;\n        }\n\n        elementsJson.push(this._getPropertiesFromElement(el));\n      }, this);\n\n      if (explicitNoTrack) {\n        return false;\n      } // only populate text content from target element (not parents)\n      // to prevent text within a sensitive element from being collected\n      // as part of a parent's el.textContent\n\n\n      var elementText;\n      var safeElementText = getSafeText(target);\n\n      if (safeElementText && safeElementText.length) {\n        elementText = safeElementText;\n      }\n\n      var props = _.extend(this._getDefaultProperties(e.type), {\n        '$elements': elementsJson,\n        '$el_attr__href': href,\n        '$el_text': elementText\n      }, this._getCustomProperties(targetElementList));\n\n      instance.track('$web_event', props);\n      return true;\n    }\n  },\n  // only reason is to stub for unit tests\n  // since you can't override window.location props\n  _navigate: function _navigate(href) {\n    window.location.href = href;\n  },\n  _addDomEventHandlers: function _addDomEventHandlers(instance) {\n    var handler = _.bind(function (e) {\n      e = e || window.event;\n\n      this._trackEvent(e, instance);\n    }, this);\n\n    _.register_event(document, 'submit', handler, false, true);\n\n    _.register_event(document, 'change', handler, false, true);\n\n    _.register_event(document, 'click', handler, false, true);\n  },\n  _customProperties: {},\n  init: function init(instance) {\n    if (!(document && document.body)) {\n      console.log('document not ready yet, trying again in 500 milliseconds...');\n      var that = this;\n      setTimeout(function () {\n        that.init(instance);\n      }, 500);\n      return;\n    }\n\n    var token = instance.get_config('token');\n\n    if (this._initializedTokens.indexOf(token) > -1) {\n      console.log('autotrack already initialized for token \"' + token + '\"');\n      return;\n    }\n\n    this._initializedTokens.push(token);\n\n    if (!this._maybeLoadEditor(instance)) {\n      // don't autotrack actions when the editor is enabled\n      var parseDecideResponse = _.bind(function (response) {\n        if (response && response['config'] && response['config']['enable_collect_everything'] === true) {\n          if (response['custom_properties']) {\n            this._customProperties = response['custom_properties'];\n          }\n\n          instance.track('$web_event', _.extend({\n            '$title': document.title\n          }, this._getDefaultProperties('pageview')));\n\n          this._addDomEventHandlers(instance);\n        } else {\n          instance['__autotrack_enabled'] = false;\n        }\n      }, this);\n\n      instance._send_request(instance.get_config('api_host') + '/decide/', {\n        'verbose': true,\n        'version': '1',\n        'lib': 'web',\n        'token': token\n      }, {\n        method: 'GET',\n        transport: 'XHR'\n      }, instance._prepare_callback(parseDecideResponse));\n    }\n  },\n  _editorParamsFromHash: function _editorParamsFromHash(instance, hash) {\n    var editorParams;\n\n    try {\n      var state = _.getHashParam(hash, 'state');\n\n      state = JSON.parse(decodeURIComponent(state));\n\n      var expiresInSeconds = _.getHashParam(hash, 'expires_in');\n\n      editorParams = {\n        'accessToken': _.getHashParam(hash, 'access_token'),\n        'accessTokenExpiresAt': new Date().getTime() + Number(expiresInSeconds) * 1000,\n        'bookmarkletMode': !!state['bookmarkletMode'],\n        'projectId': state['projectId'],\n        'projectOwnerId': state['projectOwnerId'],\n        'projectToken': state['token'],\n        'readOnly': state['readOnly'],\n        'userFlags': state['userFlags'],\n        'userId': state['userId']\n      };\n      window.sessionStorage.setItem('editorParams', JSON.stringify(editorParams));\n\n      if (state['desiredHash']) {\n        window.location.hash = state['desiredHash'];\n      } else if (window.history) {\n        history.replaceState('', document.title, window.location.pathname + window.location.search); // completely remove hash\n      } else {\n        window.location.hash = ''; // clear hash (but leaves # unfortunately)\n      }\n    } catch (e) {\n      console.error('Unable to parse data from hash', e);\n    }\n\n    return editorParams;\n  },\n\n  /**\n   * To load the visual editor, we need an access token and other state. That state comes from one of three places:\n   * 1. In the URL hash params if the customer is using an old snippet\n   * 2. From session storage under the key `_mpcehash` if the snippet already parsed the hash\n   * 3. From session storage under the key `editorParams` if the editor was initialized on a previous page\n   */\n  _maybeLoadEditor: function _maybeLoadEditor(instance) {\n    try {\n      var parseFromUrl = false;\n\n      if (_.getHashParam(window.location.hash, 'state')) {\n        var state = _.getHashParam(window.location.hash, 'state');\n\n        state = JSON.parse(decodeURIComponent(state));\n        parseFromUrl = state['action'] === 'mpeditor';\n      }\n\n      var parseFromStorage = !!window.sessionStorage.getItem('_mpcehash');\n      var editorParams;\n\n      if (parseFromUrl) {\n        // happens if they are initializing the editor using an old snippet\n        editorParams = this._editorParamsFromHash(instance, window.location.hash);\n      } else if (parseFromStorage) {\n        // happens if they are initialized the editor and using the new snippet\n        editorParams = this._editorParamsFromHash(instance, window.sessionStorage.getItem('_mpcehash'));\n        window.sessionStorage.removeItem('_mpcehash');\n      } else {\n        // get credentials from sessionStorage from a previous initialzation\n        editorParams = JSON.parse(window.sessionStorage.getItem('editorParams') || '{}');\n      }\n\n      if (editorParams['projectToken'] && instance.get_config('token') === editorParams['projectToken']) {\n        this._loadEditor(instance, editorParams);\n\n        return true;\n      } else {\n        return false;\n      }\n    } catch (e) {\n      return false;\n    }\n  },\n  _loadEditor: function _loadEditor(instance, editorParams) {\n    if (!window['_mpEditorLoaded']) {\n      // only load the codeless event editor once, even if there are multiple instances of MixpanelLib\n      window['_mpEditorLoaded'] = true;\n      var editorUrl = instance.get_config('app_host') + '/js-bundle/reports/collect-everything/editor.js?_ts=' + new Date().getTime();\n\n      this._loadScript(editorUrl, function () {\n        window['mp_load_editor'](editorParams);\n      });\n\n      return true;\n    }\n\n    return false;\n  },\n  // this is a mechanism to ramp up CE with no server-side interaction.\n  // when CE is active, every page load results in a decide request. we\n  // need to gently ramp this up so we don't overload decide. this decides\n  // deterministically if CE is enabled for this project by modding the char\n  // value of the project token.\n  enabledForProject: function enabledForProject(token, numBuckets, numEnabledBuckets) {\n    numBuckets = !_.isUndefined(numBuckets) ? numBuckets : 10;\n    numEnabledBuckets = !_.isUndefined(numEnabledBuckets) ? numEnabledBuckets : 10;\n    var charCodeSum = 0;\n\n    for (var i = 0; i < token.length; i++) {\n      charCodeSum += token.charCodeAt(i);\n    }\n\n    return charCodeSum % numBuckets < numEnabledBuckets;\n  },\n  isBrowserSupported: function isBrowserSupported() {\n    return _.isFunction(document.querySelectorAll);\n  }\n};\n\n_.bind_instance_methods(autotrack);\n\n_.safewrap_instance_methods(autotrack);\n/**\n * DomTracker Object\n * @constructor\n */\n\n\nvar DomTracker = function DomTracker() {}; // interface\n\n\nDomTracker.prototype.create_properties = function () {};\n\nDomTracker.prototype.event_handler = function () {};\n\nDomTracker.prototype.after_track_handler = function () {};\n\nDomTracker.prototype.init = function (mixpanel_instance) {\n  this.mp = mixpanel_instance;\n  return this;\n};\n/**\n * @param {Object|string} query\n * @param {string} event_name\n * @param {Object=} properties\n * @param {function=} user_callback\n */\n\n\nDomTracker.prototype.track = function (query, event_name, properties, user_callback) {\n  var that = this;\n\n  var elements = _.dom_query(query);\n\n  if (elements.length === 0) {\n    console$1.error('The DOM query (' + query + ') returned 0 elements');\n    return;\n  }\n\n  _.each(elements, function (element) {\n    _.register_event(element, this.override_event, function (e) {\n      var options = {};\n      var props = that.create_properties(properties, this);\n      var timeout = that.mp.get_config('track_links_timeout');\n      that.event_handler(e, this, options); // in case the mixpanel servers don't get back to us in time\n\n      window.setTimeout(that.track_callback(user_callback, props, options, true), timeout); // fire the tracking event\n\n      that.mp.track(event_name, props, that.track_callback(user_callback, props, options));\n    });\n  }, this);\n\n  return true;\n};\n/**\n * @param {function} user_callback\n * @param {Object} props\n * @param {boolean=} timeout_occured\n */\n\n\nDomTracker.prototype.track_callback = function (user_callback, props, options, timeout_occured) {\n  timeout_occured = timeout_occured || false;\n  var that = this;\n  return function () {\n    // options is referenced from both callbacks, so we can have\n    // a 'lock' of sorts to ensure only one fires\n    if (options.callback_fired) {\n      return;\n    }\n\n    options.callback_fired = true;\n\n    if (user_callback && user_callback(timeout_occured, props) === false) {\n      // user can prevent the default functionality by\n      // returning false from their callback\n      return;\n    }\n\n    that.after_track_handler(props, options, timeout_occured);\n  };\n};\n\nDomTracker.prototype.create_properties = function (properties, element) {\n  var props;\n\n  if (typeof properties === 'function') {\n    props = properties(element);\n  } else {\n    props = _.extend({}, properties);\n  }\n\n  return props;\n};\n/**\n * LinkTracker Object\n * @constructor\n * @extends DomTracker\n */\n\n\nvar LinkTracker = function LinkTracker() {\n  this.override_event = 'click';\n};\n\n_.inherit(LinkTracker, DomTracker);\n\nLinkTracker.prototype.create_properties = function (properties, element) {\n  var props = LinkTracker.superclass.create_properties.apply(this, arguments);\n\n  if (element.href) {\n    props['url'] = element.href;\n  }\n\n  return props;\n};\n\nLinkTracker.prototype.event_handler = function (evt, element, options) {\n  options.new_tab = evt.which === 2 || evt.metaKey || evt.ctrlKey || element.target === '_blank';\n  options.href = element.href;\n\n  if (!options.new_tab) {\n    evt.preventDefault();\n  }\n};\n\nLinkTracker.prototype.after_track_handler = function (props, options) {\n  if (options.new_tab) {\n    return;\n  }\n\n  setTimeout(function () {\n    window.location = options.href;\n  }, 0);\n};\n/**\n * FormTracker Object\n * @constructor\n * @extends DomTracker\n */\n\n\nvar FormTracker = function FormTracker() {\n  this.override_event = 'submit';\n};\n\n_.inherit(FormTracker, DomTracker);\n\nFormTracker.prototype.event_handler = function (evt, element, options) {\n  options.element = element;\n  evt.preventDefault();\n};\n\nFormTracker.prototype.after_track_handler = function (props, options) {\n  setTimeout(function () {\n    options.element.submit();\n  }, 0);\n}; // eslint-disable-line camelcase\n\n\nvar logger$2 = console_with_prefix('lock');\n/**\n * SharedLock: a mutex built on HTML5 localStorage, to ensure that only one browser\n * window/tab at a time will be able to access shared resources.\n *\n * Based on the Alur and Taubenfeld fast lock\n * (http://www.cs.rochester.edu/research/synchronization/pseudocode/fastlock.html)\n * with an added timeout to ensure there will be eventual progress in the event\n * that a window is closed in the middle of the callback.\n *\n * Implementation based on the original version by David Wolever (https://github.com/wolever)\n * at https://gist.github.com/wolever/5fd7573d1ef6166e8f8c4af286a69432.\n *\n * @example\n * const myLock = new SharedLock('some-key');\n * myLock.withLock(function() {\n *   console.log('I hold the mutex!');\n * });\n *\n * @constructor\n */\n\nvar SharedLock = function SharedLock(key, options) {\n  options = options || {};\n  this.storageKey = key;\n  this.storage = options.storage || window.localStorage;\n  this.pollIntervalMS = options.pollIntervalMS || 100;\n  this.timeoutMS = options.timeoutMS || 2000;\n}; // pass in a specific pid to test contention scenarios; otherwise\n// it is chosen randomly for each acquisition attempt\n\n\nSharedLock.prototype.withLock = function (lockedCB, errorCB, pid) {\n  if (!pid && typeof errorCB !== 'function') {\n    pid = errorCB;\n    errorCB = null;\n  }\n\n  var i = pid || new Date().getTime() + '|' + Math.random();\n  var startTime = new Date().getTime();\n  var key = this.storageKey;\n  var pollIntervalMS = this.pollIntervalMS;\n  var timeoutMS = this.timeoutMS;\n  var storage = this.storage;\n  var keyX = key + ':X';\n  var keyY = key + ':Y';\n  var keyZ = key + ':Z';\n\n  var reportError = function reportError(err) {\n    errorCB && errorCB(err);\n  };\n\n  var delay = function delay(cb) {\n    if (new Date().getTime() - startTime > timeoutMS) {\n      logger$2.error('Timeout waiting for mutex on ' + key + '; clearing lock. [' + i + ']');\n      storage.removeItem(keyZ);\n      storage.removeItem(keyY);\n      loop();\n      return;\n    }\n\n    setTimeout(function () {\n      try {\n        cb();\n      } catch (err) {\n        reportError(err);\n      }\n    }, pollIntervalMS * (Math.random() + 0.1));\n  };\n\n  var waitFor = function waitFor(predicate, cb) {\n    if (predicate()) {\n      cb();\n    } else {\n      delay(function () {\n        waitFor(predicate, cb);\n      });\n    }\n  };\n\n  var getSetY = function getSetY() {\n    var valY = storage.getItem(keyY);\n\n    if (valY && valY !== i) {\n      // if Y == i then this process already has the lock (useful for test cases)\n      return false;\n    } else {\n      storage.setItem(keyY, i);\n\n      if (storage.getItem(keyY) === i) {\n        return true;\n      } else {\n        if (!localStorageSupported(storage, true)) {\n          throw new Error('localStorage support dropped while acquiring lock');\n        }\n\n        return false;\n      }\n    }\n  };\n\n  var loop = function loop() {\n    storage.setItem(keyX, i);\n    waitFor(getSetY, function () {\n      if (storage.getItem(keyX) === i) {\n        criticalSection();\n        return;\n      }\n\n      delay(function () {\n        if (storage.getItem(keyY) !== i) {\n          loop();\n          return;\n        }\n\n        waitFor(function () {\n          return !storage.getItem(keyZ);\n        }, criticalSection);\n      });\n    });\n  };\n\n  var criticalSection = function criticalSection() {\n    storage.setItem(keyZ, '1');\n\n    try {\n      lockedCB();\n    } finally {\n      storage.removeItem(keyZ);\n\n      if (storage.getItem(keyY) === i) {\n        storage.removeItem(keyY);\n      }\n\n      if (storage.getItem(keyX) === i) {\n        storage.removeItem(keyX);\n      }\n    }\n  };\n\n  try {\n    if (localStorageSupported(storage, true)) {\n      loop();\n    } else {\n      throw new Error('localStorage support check failed');\n    }\n  } catch (err) {\n    reportError(err);\n  }\n}; // eslint-disable-line camelcase\n\n\nvar logger$1 = console_with_prefix('batch');\n/**\n * RequestQueue: queue for batching API requests with localStorage backup for retries.\n * Maintains an in-memory queue which represents the source of truth for the current\n * page, but also writes all items out to a copy in the browser's localStorage, which\n * can be read on subsequent pageloads and retried. For batchability, all the request\n * items in the queue should be of the same type (events, people updates, group updates)\n * so they can be sent in a single request to the same API endpoint.\n *\n * LocalStorage keying and locking: In order for reloads and subsequent pageloads of\n * the same site to access the same persisted data, they must share the same localStorage\n * key (for instance based on project token and queue type). Therefore access to the\n * localStorage entry is guarded by an asynchronous mutex (SharedLock) to prevent\n * simultaneously open windows/tabs from overwriting each other's data (which would lead\n * to data loss in some situations).\n * @constructor\n */\n\nvar RequestQueue = function RequestQueue(storageKey, options) {\n  options = options || {};\n  this.storageKey = storageKey;\n  this.storage = options.storage || window.localStorage;\n  this.lock = new SharedLock(storageKey, {\n    storage: this.storage\n  });\n  this.pid = options.pid || null; // pass pid to test out storage lock contention scenarios\n\n  this.memQueue = [];\n};\n/**\n * Add one item to queues (memory and localStorage). The queued entry includes\n * the given item along with an auto-generated ID and a \"flush-after\" timestamp.\n * It is expected that the item will be sent over the network and dequeued\n * before the flush-after time; if this doesn't happen it is considered orphaned\n * (e.g., the original tab where it was enqueued got closed before it could be\n * sent) and the item can be sent by any tab that finds it in localStorage.\n *\n * The final callback param is called with a param indicating success or\n * failure of the enqueue operation; it is asynchronous because the localStorage\n * lock is asynchronous.\n */\n\n\nRequestQueue.prototype.enqueue = function (item, flushInterval, cb) {\n  var queueEntry = {\n    'id': cheap_guid(),\n    'flushAfter': new Date().getTime() + flushInterval * 2,\n    'payload': item\n  };\n  this.lock.withLock(_.bind(function lockAcquired() {\n    var succeeded;\n\n    try {\n      var storedQueue = this.readFromStorage();\n      storedQueue.push(queueEntry);\n      succeeded = this.saveToStorage(storedQueue);\n\n      if (succeeded) {\n        // only add to in-memory queue when storage succeeds\n        this.memQueue.push(queueEntry);\n      }\n    } catch (err) {\n      logger$1.error('Error enqueueing item', item);\n      succeeded = false;\n    }\n\n    if (cb) {\n      cb(succeeded);\n    }\n  }, this), function lockFailure(err) {\n    logger$1.error('Error acquiring storage lock', err);\n\n    if (cb) {\n      cb(false);\n    }\n  }, this.pid);\n};\n/**\n * Read out the given number of queue entries. If this.memQueue\n * has fewer than batchSize items, then look for \"orphaned\" items\n * in the persisted queue (items where the 'flushAfter' time has\n * already passed).\n */\n\n\nRequestQueue.prototype.fillBatch = function (batchSize) {\n  var batch = this.memQueue.slice(0, batchSize);\n\n  if (batch.length < batchSize) {\n    // don't need lock just to read events; localStorage is thread-safe\n    // and the worst that could happen is a duplicate send of some\n    // orphaned events, which will be deduplicated on the server side\n    var storedQueue = this.readFromStorage();\n\n    if (storedQueue.length) {\n      // item IDs already in batch; don't duplicate out of storage\n      var idsInBatch = {}; // poor man's Set\n\n      _.each(batch, function (item) {\n        idsInBatch[item['id']] = true;\n      });\n\n      for (var i = 0; i < storedQueue.length; i++) {\n        var item = storedQueue[i];\n\n        if (new Date().getTime() > item['flushAfter'] && !idsInBatch[item['id']]) {\n          batch.push(item);\n\n          if (batch.length >= batchSize) {\n            break;\n          }\n        }\n      }\n    }\n  }\n\n  return batch;\n};\n/**\n * Remove items with matching 'id' from array (immutably)\n * also remove any item without a valid id (e.g., malformed\n * storage entries).\n */\n\n\nvar filterOutIDsAndInvalid = function filterOutIDsAndInvalid(items, idSet) {\n  var filteredItems = [];\n\n  _.each(items, function (item) {\n    if (item['id'] && !idSet[item['id']]) {\n      filteredItems.push(item);\n    }\n  });\n\n  return filteredItems;\n};\n/**\n * Remove items with matching IDs from both in-memory queue\n * and persisted queue\n */\n\n\nRequestQueue.prototype.removeItemsByID = function (ids, cb) {\n  var idSet = {}; // poor man's Set\n\n  _.each(ids, function (id) {\n    idSet[id] = true;\n  });\n\n  this.memQueue = filterOutIDsAndInvalid(this.memQueue, idSet);\n  this.lock.withLock(_.bind(function lockAcquired() {\n    var succeeded;\n\n    try {\n      var storedQueue = this.readFromStorage();\n      storedQueue = filterOutIDsAndInvalid(storedQueue, idSet);\n      succeeded = this.saveToStorage(storedQueue);\n    } catch (err) {\n      logger$1.error('Error removing items', ids);\n      succeeded = false;\n    }\n\n    if (cb) {\n      cb(succeeded);\n    }\n  }, this), function lockFailure(err) {\n    logger$1.error('Error acquiring storage lock', err);\n\n    if (cb) {\n      cb(false);\n    }\n  }, this.pid);\n};\n/**\n * Read and parse items array from localStorage entry, handling\n * malformed/missing data if necessary.\n */\n\n\nRequestQueue.prototype.readFromStorage = function () {\n  var storageEntry;\n\n  try {\n    storageEntry = this.storage.getItem(this.storageKey);\n\n    if (storageEntry) {\n      storageEntry = JSONParse(storageEntry);\n\n      if (!_.isArray(storageEntry)) {\n        logger$1.error('Invalid storage entry:', storageEntry);\n        storageEntry = null;\n      }\n    }\n  } catch (err) {\n    logger$1.error('Error retrieving queue', err);\n    storageEntry = null;\n  }\n\n  return storageEntry || [];\n};\n/**\n * Serialize the given items array to localStorage.\n */\n\n\nRequestQueue.prototype.saveToStorage = function (queue) {\n  try {\n    this.storage.setItem(this.storageKey, JSONStringify(queue));\n    return true;\n  } catch (err) {\n    logger$1.error('Error saving queue', err);\n    return false;\n  }\n};\n/**\n * Clear out queues (memory and localStorage).\n */\n\n\nRequestQueue.prototype.clear = function () {\n  this.memQueue = [];\n  this.storage.removeItem(this.storageKey);\n}; // eslint-disable-line camelcase\n// maximum interval between request retries after exponential backoff\n\n\nvar MAX_RETRY_INTERVAL_MS = 10 * 60 * 1000; // 10 minutes\n\nvar logger = console_with_prefix('batch');\n/**\n * RequestBatcher: manages the queueing, flushing, retry etc of requests of one\n * type (events, people, groups).\n * Uses RequestQueue to manage the backing store.\n * @constructor\n */\n\nvar RequestBatcher = function RequestBatcher(storageKey, endpoint, options) {\n  this.queue = new RequestQueue(storageKey, {\n    storage: options.storage\n  });\n  this.endpoint = endpoint;\n  this.libConfig = options.libConfig;\n  this.sendRequest = options.sendRequestFunc; // seed variable batch size + flush interval with configured values\n\n  this.batchSize = this.libConfig['batch_size'];\n  this.flushInterval = this.libConfig['batch_flush_interval_ms'];\n  this.stopped = false;\n};\n/**\n * Add one item to queue.\n */\n\n\nRequestBatcher.prototype.enqueue = function (item, cb) {\n  this.queue.enqueue(item, this.flushInterval, cb);\n};\n/**\n * Start flushing batches at the configured time interval. Must call\n * this method upon SDK init in order to send anything over the network.\n */\n\n\nRequestBatcher.prototype.start = function () {\n  this.stopped = false;\n  this.flush();\n};\n/**\n * Stop flushing batches. Can be restarted by calling start().\n */\n\n\nRequestBatcher.prototype.stop = function () {\n  this.stopped = true;\n\n  if (this.timeoutID) {\n    clearTimeout(this.timeoutID);\n    this.timeoutID = null;\n  }\n};\n/**\n * Clear out queue.\n */\n\n\nRequestBatcher.prototype.clear = function () {\n  this.queue.clear();\n};\n/**\n * Restore batch size configuration to whatever is set in the main SDK.\n */\n\n\nRequestBatcher.prototype.resetBatchSize = function () {\n  this.batchSize = this.libConfig['batch_size'];\n};\n/**\n * Restore flush interval time configuration to whatever is set in the main SDK.\n */\n\n\nRequestBatcher.prototype.resetFlush = function () {\n  this.scheduleFlush(this.libConfig['batch_flush_interval_ms']);\n};\n/**\n * Schedule the next flush in the given number of milliseconds.\n */\n\n\nRequestBatcher.prototype.scheduleFlush = function (flushMS) {\n  this.flushInterval = flushMS;\n\n  if (!this.stopped) {\n    // don't schedule anymore if batching has been stopped\n    this.timeoutID = setTimeout(_.bind(this.flush, this), this.flushInterval);\n  }\n};\n/**\n * Flush one batch to network. Depending on success/failure modes, it will either\n * remove the batch from the queue or leave it in for retry, and schedule the next\n * flush. In cases of most network or API failures, it will back off exponentially\n * when retrying.\n * @param {Object} [options]\n * @param {boolean} [options.sendBeacon] - whether to send batch with\n * navigator.sendBeacon (only useful for sending batches before page unloads, as\n * sendBeacon offers no callbacks or status indications)\n */\n\n\nRequestBatcher.prototype.flush = function (options) {\n  try {\n    if (this.requestInProgress) {\n      logger.log('Flush: Request already in progress');\n      return;\n    }\n\n    options = options || {};\n    var currentBatchSize = this.batchSize;\n    var batch = this.queue.fillBatch(currentBatchSize);\n\n    if (batch.length < 1) {\n      this.resetFlush();\n      return; // nothing to do\n    }\n\n    this.requestInProgress = true;\n    var timeoutMS = this.libConfig['batch_request_timeout_ms'];\n    var startTime = new Date().getTime();\n\n    var dataForRequest = _.map(batch, function (item) {\n      return item['payload'];\n    });\n\n    var batchSendCallback = _.bind(function (res) {\n      this.requestInProgress = false;\n\n      try {\n        // handle API response in a try-catch to make sure we can reset the\n        // flush operation if something goes wrong\n        var removeItemsFromQueue = false;\n\n        if (_.isObject(res) && res.error === 'timeout' && new Date().getTime() - startTime >= timeoutMS) {\n          logger.error('Network timeout; retrying');\n          this.flush();\n        } else if (_.isObject(res) && res.xhr_req && (res.xhr_req['status'] >= 500 || res.xhr_req['status'] <= 0)) {\n          // network or API error, retry\n          var retryMS = this.flushInterval * 2;\n          var headers = res.xhr_req['responseHeaders'];\n\n          if (headers) {\n            var retryAfter = headers['Retry-After'];\n\n            if (retryAfter) {\n              retryMS = parseInt(retryAfter, 10) * 1000 || retryMS;\n            }\n          }\n\n          retryMS = Math.min(MAX_RETRY_INTERVAL_MS, retryMS);\n          logger.error('Error; retry in ' + retryMS + ' ms');\n          this.scheduleFlush(retryMS);\n        } else if (_.isObject(res) && res.xhr_req && res.xhr_req['status'] === 413) {\n          // 413 Payload Too Large\n          if (batch.length > 1) {\n            var halvedBatchSize = Math.max(1, Math.floor(currentBatchSize / 2));\n            this.batchSize = Math.min(this.batchSize, halvedBatchSize, batch.length - 1);\n            logger.error('413 response; reducing batch size to ' + this.batchSize);\n            this.resetFlush();\n          } else {\n            logger.error('Single-event request too large; dropping', batch);\n            this.resetBatchSize();\n            removeItemsFromQueue = true;\n          }\n        } else {\n          // successful network request+response; remove each item in batch from queue\n          // (even if it was e.g. a 400, in which case retrying won't help)\n          removeItemsFromQueue = true;\n        }\n\n        if (removeItemsFromQueue) {\n          this.queue.removeItemsByID(_.map(batch, function (item) {\n            return item['id'];\n          }), _.bind(this.flush, this) // handle next batch if the queue isn't empty\n          );\n        }\n      } catch (err) {\n        logger.error('Error handling API response', err);\n        this.resetFlush();\n      }\n    }, this);\n\n    var requestOptions = {\n      method: 'POST',\n      verbose: true,\n      ignore_json_errors: true,\n      // eslint-disable-line camelcase\n      timeout_ms: timeoutMS // eslint-disable-line camelcase\n\n    };\n\n    if (options.sendBeacon) {\n      requestOptions.transport = 'sendBeacon';\n    }\n\n    logger.log('MIXPANEL REQUEST:', this.endpoint, dataForRequest);\n    this.sendRequest(this.endpoint, dataForRequest, requestOptions, batchSendCallback);\n  } catch (err) {\n    logger.error('Error flushing request queue', err);\n    this.resetFlush();\n  }\n};\n/**\n * A function used to track a Mixpanel event (e.g. MixpanelLib.track)\n * @callback trackFunction\n * @param {String} event_name The name of the event. This can be anything the user does - 'Button Click', 'Sign Up', 'Item Purchased', etc.\n * @param {Object} [properties] A set of properties to include with the event you're sending. These describe the user who did the event or details about the event itself.\n * @param {Function} [callback] If provided, the callback function will be called after tracking the event.\n */\n\n/** Public **/\n\n\nvar GDPR_DEFAULT_PERSISTENCE_PREFIX = '__mp_opt_in_out_';\n/**\n * Opt the user in to data tracking and cookies/localstorage for the given token\n * @param {string} token - Mixpanel project tracking token\n * @param {Object} [options]\n * @param {trackFunction} [options.track] - function used for tracking a Mixpanel event to record the opt-in action\n * @param {string} [options.trackEventName] - event name to be used for tracking the opt-in action\n * @param {Object} [options.trackProperties] - set of properties to be tracked along with the opt-in action\n * @param {string} [options.persistenceType] Persistence mechanism used - cookie or localStorage\n * @param {string} [options.persistencePrefix=__mp_opt_in_out] - custom prefix to be used in the cookie/localstorage name\n * @param {Number} [options.cookieExpiration] - number of days until the opt-in cookie expires\n * @param {string} [options.cookieDomain] - custom cookie domain\n * @param {boolean} [options.crossSiteCookie] - whether the opt-in cookie is set as cross-site-enabled\n * @param {boolean} [options.crossSubdomainCookie] - whether the opt-in cookie is set as cross-subdomain or not\n * @param {boolean} [options.secureCookie] - whether the opt-in cookie is set as secure or not\n */\n\nfunction optIn(token, options) {\n  _optInOut(true, token, options);\n}\n/**\n * Opt the user out of data tracking and cookies/localstorage for the given token\n * @param {string} token - Mixpanel project tracking token\n * @param {Object} [options]\n * @param {string} [options.persistenceType] Persistence mechanism used - cookie or localStorage\n * @param {string} [options.persistencePrefix=__mp_opt_in_out] - custom prefix to be used in the cookie/localstorage name\n * @param {Number} [options.cookieExpiration] - number of days until the opt-out cookie expires\n * @param {string} [options.cookieDomain] - custom cookie domain\n * @param {boolean} [options.crossSiteCookie] - whether the opt-in cookie is set as cross-site-enabled\n * @param {boolean} [options.crossSubdomainCookie] - whether the opt-out cookie is set as cross-subdomain or not\n * @param {boolean} [options.secureCookie] - whether the opt-out cookie is set as secure or not\n */\n\n\nfunction optOut(token, options) {\n  _optInOut(false, token, options);\n}\n/**\n * Check whether the user has opted in to data tracking and cookies/localstorage for the given token\n * @param {string} token - Mixpanel project tracking token\n * @param {Object} [options]\n * @param {string} [options.persistenceType] Persistence mechanism used - cookie or localStorage\n * @param {string} [options.persistencePrefix=__mp_opt_in_out] - custom prefix to be used in the cookie/localstorage name\n * @returns {boolean} whether the user has opted in to the given opt type\n */\n\n\nfunction hasOptedIn(token, options) {\n  return _getStorageValue(token, options) === '1';\n}\n/**\n * Check whether the user has opted out of data tracking and cookies/localstorage for the given token\n * @param {string} token - Mixpanel project tracking token\n * @param {Object} [options]\n * @param {string} [options.persistenceType] Persistence mechanism used - cookie or localStorage\n * @param {string} [options.persistencePrefix=__mp_opt_in_out] - custom prefix to be used in the cookie/localstorage name\n * @param {boolean} [options.ignoreDnt] - flag to ignore browser DNT settings and always return false\n * @returns {boolean} whether the user has opted out of the given opt type\n */\n\n\nfunction hasOptedOut(token, options) {\n  if (_hasDoNotTrackFlagOn(options)) {\n    return true;\n  }\n\n  return _getStorageValue(token, options) === '0';\n}\n/**\n * Wrap a MixpanelLib method with a check for whether the user is opted out of data tracking and cookies/localstorage for the given token\n * If the user has opted out, return early instead of executing the method.\n * If a callback argument was provided, execute it passing the 0 error code.\n * @param {function} method - wrapped method to be executed if the user has not opted out\n * @returns {*} the result of executing method OR undefined if the user has opted out\n */\n\n\nfunction addOptOutCheckMixpanelLib(method) {\n  return _addOptOutCheck(method, function (name) {\n    return this.get_config(name);\n  });\n}\n/**\n * Wrap a MixpanelPeople method with a check for whether the user is opted out of data tracking and cookies/localstorage for the given token\n * If the user has opted out, return early instead of executing the method.\n * If a callback argument was provided, execute it passing the 0 error code.\n * @param {function} method - wrapped method to be executed if the user has not opted out\n * @returns {*} the result of executing method OR undefined if the user has opted out\n */\n\n\nfunction addOptOutCheckMixpanelPeople(method) {\n  return _addOptOutCheck(method, function (name) {\n    return this._get_config(name);\n  });\n}\n/**\n * Wrap a MixpanelGroup method with a check for whether the user is opted out of data tracking and cookies/localstorage for the given token\n * If the user has opted out, return early instead of executing the method.\n * If a callback argument was provided, execute it passing the 0 error code.\n * @param {function} method - wrapped method to be executed if the user has not opted out\n * @returns {*} the result of executing method OR undefined if the user has opted out\n */\n\n\nfunction addOptOutCheckMixpanelGroup(method) {\n  return _addOptOutCheck(method, function (name) {\n    return this._get_config(name);\n  });\n}\n/**\n * Clear the user's opt in/out status of data tracking and cookies/localstorage for the given token\n * @param {string} token - Mixpanel project tracking token\n * @param {Object} [options]\n * @param {string} [options.persistenceType] Persistence mechanism used - cookie or localStorage\n * @param {string} [options.persistencePrefix=__mp_opt_in_out] - custom prefix to be used in the cookie/localstorage name\n * @param {Number} [options.cookieExpiration] - number of days until the opt-in cookie expires\n * @param {string} [options.cookieDomain] - custom cookie domain\n * @param {boolean} [options.crossSiteCookie] - whether the opt-in cookie is set as cross-site-enabled\n * @param {boolean} [options.crossSubdomainCookie] - whether the opt-in cookie is set as cross-subdomain or not\n * @param {boolean} [options.secureCookie] - whether the opt-in cookie is set as secure or not\n */\n\n\nfunction clearOptInOut(token, options) {\n  options = options || {};\n\n  _getStorage(options).remove(_getStorageKey(token, options), !!options.crossSubdomainCookie, options.cookieDomain);\n}\n/** Private **/\n\n/**\n * Get storage util\n * @param {Object} [options]\n * @param {string} [options.persistenceType]\n * @returns {object} either _.cookie or _.localstorage\n */\n\n\nfunction _getStorage(options) {\n  options = options || {};\n  return options.persistenceType === 'localStorage' ? _.localStorage : _.cookie;\n}\n/**\n * Get the name of the cookie that is used for the given opt type (tracking, cookie, etc.)\n * @param {string} token - Mixpanel project tracking token\n * @param {Object} [options]\n * @param {string} [options.persistencePrefix=__mp_opt_in_out] - custom prefix to be used in the cookie/localstorage name\n * @returns {string} the name of the cookie for the given opt type\n */\n\n\nfunction _getStorageKey(token, options) {\n  options = options || {};\n  return (options.persistencePrefix || GDPR_DEFAULT_PERSISTENCE_PREFIX) + token;\n}\n/**\n * Get the value of the cookie that is used for the given opt type (tracking, cookie, etc.)\n * @param {string} token - Mixpanel project tracking token\n * @param {Object} [options]\n * @param {string} [options.persistencePrefix=__mp_opt_in_out] - custom prefix to be used in the cookie/localstorage name\n * @returns {string} the value of the cookie for the given opt type\n */\n\n\nfunction _getStorageValue(token, options) {\n  return _getStorage(options).get(_getStorageKey(token, options));\n}\n/**\n * Check whether the user has set the DNT/doNotTrack setting to true in their browser\n * @param {Object} [options]\n * @param {string} [options.window] - alternate window object to check; used to force various DNT settings in browser tests\n * @param {boolean} [options.ignoreDnt] - flag to ignore browser DNT settings and always return false\n * @returns {boolean} whether the DNT setting is true\n */\n\n\nfunction _hasDoNotTrackFlagOn(options) {\n  if (options && options.ignoreDnt) {\n    return false;\n  }\n\n  var win = options && options.window || window$1;\n  var nav = win['navigator'] || {};\n  var hasDntOn = false;\n\n  _.each([nav['doNotTrack'], // standard\n  nav['msDoNotTrack'], win['doNotTrack']], function (dntValue) {\n    if (_.includes([true, 1, '1', 'yes'], dntValue)) {\n      hasDntOn = true;\n    }\n  });\n\n  return hasDntOn;\n}\n/**\n * Set cookie/localstorage for the user indicating that they are opted in or out for the given opt type\n * @param {boolean} optValue - whether to opt the user in or out for the given opt type\n * @param {string} token - Mixpanel project tracking token\n * @param {Object} [options]\n * @param {trackFunction} [options.track] - function used for tracking a Mixpanel event to record the opt-in action\n * @param {string} [options.trackEventName] - event name to be used for tracking the opt-in action\n * @param {Object} [options.trackProperties] - set of properties to be tracked along with the opt-in action\n * @param {string} [options.persistencePrefix=__mp_opt_in_out] - custom prefix to be used in the cookie/localstorage name\n * @param {Number} [options.cookieExpiration] - number of days until the opt-in cookie expires\n * @param {string} [options.cookieDomain] - custom cookie domain\n * @param {boolean} [options.crossSiteCookie] - whether the opt-in cookie is set as cross-site-enabled\n * @param {boolean} [options.crossSubdomainCookie] - whether the opt-in cookie is set as cross-subdomain or not\n * @param {boolean} [options.secureCookie] - whether the opt-in cookie is set as secure or not\n */\n\n\nfunction _optInOut(optValue, token, options) {\n  if (!_.isString(token) || !token.length) {\n    console.error('gdpr.' + (optValue ? 'optIn' : 'optOut') + ' called with an invalid token');\n    return;\n  }\n\n  options = options || {};\n\n  _getStorage(options).set(_getStorageKey(token, options), optValue ? 1 : 0, _.isNumber(options.cookieExpiration) ? options.cookieExpiration : null, !!options.crossSubdomainCookie, !!options.secureCookie, !!options.crossSiteCookie, options.cookieDomain);\n\n  if (options.track && optValue) {\n    // only track event if opting in (optValue=true)\n    options.track(options.trackEventName || '$opt_in', options.trackProperties, {\n      'send_immediately': true\n    });\n  }\n}\n/**\n * Wrap a method with a check for whether the user is opted out of data tracking and cookies/localstorage for the given token\n * If the user has opted out, return early instead of executing the method.\n * If a callback argument was provided, execute it passing the 0 error code.\n * @param {function} method - wrapped method to be executed if the user has not opted out\n * @param {function} getConfigValue - getter function for the Mixpanel API token and other options to be used with opt-out check\n * @returns {*} the result of executing method OR undefined if the user has opted out\n */\n\n\nfunction _addOptOutCheck(method, getConfigValue) {\n  return function () {\n    var optedOut = false;\n\n    try {\n      var token = getConfigValue.call(this, 'token');\n      var ignoreDnt = getConfigValue.call(this, 'ignore_dnt');\n      var persistenceType = getConfigValue.call(this, 'opt_out_tracking_persistence_type');\n      var persistencePrefix = getConfigValue.call(this, 'opt_out_tracking_cookie_prefix');\n      var win = getConfigValue.call(this, 'window'); // used to override window during browser tests\n\n      if (token) {\n        // if there was an issue getting the token, continue method execution as normal\n        optedOut = hasOptedOut(token, {\n          ignoreDnt: ignoreDnt,\n          persistenceType: persistenceType,\n          persistencePrefix: persistencePrefix,\n          window: win\n        });\n      }\n    } catch (err) {\n      console.error('Unexpected error when checking tracking opt-out status: ' + err);\n    }\n\n    if (!optedOut) {\n      return method.apply(this, arguments);\n    }\n\n    var callback = arguments[arguments.length - 1];\n\n    if (typeof callback === 'function') {\n      callback(0);\n    }\n\n    return;\n  };\n}\n/** @const */\n\n\nvar SET_ACTION = '$set';\n/** @const */\n\nvar SET_ONCE_ACTION = '$set_once';\n/** @const */\n\nvar UNSET_ACTION = '$unset';\n/** @const */\n\nvar ADD_ACTION = '$add';\n/** @const */\n\nvar APPEND_ACTION = '$append';\n/** @const */\n\nvar UNION_ACTION = '$union';\n/** @const */\n\nvar REMOVE_ACTION = '$remove';\n/** @const */\n\nvar DELETE_ACTION = '$delete'; // Common internal methods for mixpanel.people and mixpanel.group APIs.\n// These methods shouldn't involve network I/O.\n\nvar apiActions = {\n  set_action: function set_action(prop, to) {\n    var data = {};\n    var $set = {};\n\n    if (_.isObject(prop)) {\n      _.each(prop, function (v, k) {\n        if (!this._is_reserved_property(k)) {\n          $set[k] = v;\n        }\n      }, this);\n    } else {\n      $set[prop] = to;\n    }\n\n    data[SET_ACTION] = $set;\n    return data;\n  },\n  unset_action: function unset_action(prop) {\n    var data = {};\n    var $unset = [];\n\n    if (!_.isArray(prop)) {\n      prop = [prop];\n    }\n\n    _.each(prop, function (k) {\n      if (!this._is_reserved_property(k)) {\n        $unset.push(k);\n      }\n    }, this);\n\n    data[UNSET_ACTION] = $unset;\n    return data;\n  },\n  set_once_action: function set_once_action(prop, to) {\n    var data = {};\n    var $set_once = {};\n\n    if (_.isObject(prop)) {\n      _.each(prop, function (v, k) {\n        if (!this._is_reserved_property(k)) {\n          $set_once[k] = v;\n        }\n      }, this);\n    } else {\n      $set_once[prop] = to;\n    }\n\n    data[SET_ONCE_ACTION] = $set_once;\n    return data;\n  },\n  union_action: function union_action(list_name, values) {\n    var data = {};\n    var $union = {};\n\n    if (_.isObject(list_name)) {\n      _.each(list_name, function (v, k) {\n        if (!this._is_reserved_property(k)) {\n          $union[k] = _.isArray(v) ? v : [v];\n        }\n      }, this);\n    } else {\n      $union[list_name] = _.isArray(values) ? values : [values];\n    }\n\n    data[UNION_ACTION] = $union;\n    return data;\n  },\n  append_action: function append_action(list_name, value) {\n    var data = {};\n    var $append = {};\n\n    if (_.isObject(list_name)) {\n      _.each(list_name, function (v, k) {\n        if (!this._is_reserved_property(k)) {\n          $append[k] = v;\n        }\n      }, this);\n    } else {\n      $append[list_name] = value;\n    }\n\n    data[APPEND_ACTION] = $append;\n    return data;\n  },\n  remove_action: function remove_action(list_name, value) {\n    var data = {};\n    var $remove = {};\n\n    if (_.isObject(list_name)) {\n      _.each(list_name, function (v, k) {\n        if (!this._is_reserved_property(k)) {\n          $remove[k] = v;\n        }\n      }, this);\n    } else {\n      $remove[list_name] = value;\n    }\n\n    data[REMOVE_ACTION] = $remove;\n    return data;\n  },\n  delete_action: function delete_action() {\n    var data = {};\n    data[DELETE_ACTION] = '';\n    return data;\n  }\n};\n/**\n * Mixpanel Group Object\n * @constructor\n */\n\nvar MixpanelGroup = function MixpanelGroup() {};\n\n_.extend(MixpanelGroup.prototype, apiActions);\n\nMixpanelGroup.prototype._init = function (mixpanel_instance, group_key, group_id) {\n  this._mixpanel = mixpanel_instance;\n  this._group_key = group_key;\n  this._group_id = group_id;\n};\n/**\n * Set properties on a group.\n *\n * ### Usage:\n *\n *     mixpanel.get_group('company', 'mixpanel').set('Location', '405 Howard');\n *\n *     // or set multiple properties at once\n *     mixpanel.get_group('company', 'mixpanel').set({\n *          'Location': '405 Howard',\n *          'Founded' : 2009,\n *     });\n *     // properties can be strings, integers, dates, or lists\n *\n * @param {Object|String} prop If a string, this is the name of the property. If an object, this is an associative array of names and values.\n * @param {*} [to] A value to set on the given property name\n * @param {Function} [callback] If provided, the callback will be called after the tracking event\n */\n\n\nMixpanelGroup.prototype.set = addOptOutCheckMixpanelGroup(function (prop, to, callback) {\n  var data = this.set_action(prop, to);\n\n  if (_.isObject(prop)) {\n    callback = to;\n  }\n\n  return this._send_request(data, callback);\n});\n/**\n * Set properties on a group, only if they do not yet exist.\n * This will not overwrite previous group property values, unlike\n * group.set().\n *\n * ### Usage:\n *\n *     mixpanel.get_group('company', 'mixpanel').set_once('Location', '405 Howard');\n *\n *     // or set multiple properties at once\n *     mixpanel.get_group('company', 'mixpanel').set_once({\n *          'Location': '405 Howard',\n *          'Founded' : 2009,\n *     });\n *     // properties can be strings, integers, lists or dates\n *\n * @param {Object|String} prop If a string, this is the name of the property. If an object, this is an associative array of names and values.\n * @param {*} [to] A value to set on the given property name\n * @param {Function} [callback] If provided, the callback will be called after the tracking event\n */\n\nMixpanelGroup.prototype.set_once = addOptOutCheckMixpanelGroup(function (prop, to, callback) {\n  var data = this.set_once_action(prop, to);\n\n  if (_.isObject(prop)) {\n    callback = to;\n  }\n\n  return this._send_request(data, callback);\n});\n/**\n * Unset properties on a group permanently.\n *\n * ### Usage:\n *\n *     mixpanel.get_group('company', 'mixpanel').unset('Founded');\n *\n * @param {String} prop The name of the property.\n * @param {Function} [callback] If provided, the callback will be called after the tracking event\n */\n\nMixpanelGroup.prototype.unset = addOptOutCheckMixpanelGroup(function (prop, callback) {\n  var data = this.unset_action(prop);\n  return this._send_request(data, callback);\n});\n/**\n * Merge a given list with a list-valued group property, excluding duplicate values.\n *\n * ### Usage:\n *\n *     // merge a value to a list, creating it if needed\n *     mixpanel.get_group('company', 'mixpanel').union('Location', ['San Francisco', 'London']);\n *\n * @param {String} list_name Name of the property.\n * @param {Array} values Values to merge with the given property\n * @param {Function} [callback] If provided, the callback will be called after the tracking event\n */\n\nMixpanelGroup.prototype.union = addOptOutCheckMixpanelGroup(function (list_name, values, callback) {\n  if (_.isObject(list_name)) {\n    callback = values;\n  }\n\n  var data = this.union_action(list_name, values);\n  return this._send_request(data, callback);\n});\n/**\n * Permanently delete a group.\n *\n * ### Usage:\n *     mixpanel.get_group('company', 'mixpanel').delete();\n */\n\nMixpanelGroup.prototype['delete'] = addOptOutCheckMixpanelGroup(function (callback) {\n  var data = this.delete_action();\n  return this._send_request(data, callback);\n});\n/**\n * Remove a property from a group. The value will be ignored if doesn't exist.\n *\n * ### Usage:\n *\n *     mixpanel.get_group('company', 'mixpanel').remove('Location', 'London');\n *\n * @param {String} list_name Name of the property.\n * @param {Object} value Value to remove from the given group property\n * @param {Function} [callback] If provided, the callback will be called after the tracking event\n */\n\nMixpanelGroup.prototype.remove = addOptOutCheckMixpanelGroup(function (list_name, value, callback) {\n  var data = this.remove_action(list_name, value);\n  return this._send_request(data, callback);\n});\n\nMixpanelGroup.prototype._send_request = function (data, callback) {\n  data['$group_key'] = this._group_key;\n  data['$group_id'] = this._group_id;\n  data['$token'] = this._get_config('token');\n\n  var date_encoded_data = _.encodeDates(data);\n\n  return this._mixpanel._track_or_batch({\n    truncated_data: _.truncate(date_encoded_data, 255),\n    endpoint: this._get_config('api_host') + '/groups/',\n    batcher: this._mixpanel.request_batchers.groups\n  }, callback);\n};\n\nMixpanelGroup.prototype._is_reserved_property = function (prop) {\n  return prop === '$group_key' || prop === '$group_id';\n};\n\nMixpanelGroup.prototype._get_config = function (conf) {\n  return this._mixpanel.get_config(conf);\n};\n\nMixpanelGroup.prototype.toString = function () {\n  return this._mixpanel.toString() + '.group.' + this._group_key + '.' + this._group_id;\n}; // MixpanelGroup Exports\n\n\nMixpanelGroup.prototype['remove'] = MixpanelGroup.prototype.remove;\nMixpanelGroup.prototype['set'] = MixpanelGroup.prototype.set;\nMixpanelGroup.prototype['set_once'] = MixpanelGroup.prototype.set_once;\nMixpanelGroup.prototype['union'] = MixpanelGroup.prototype.union;\nMixpanelGroup.prototype['unset'] = MixpanelGroup.prototype.unset;\nMixpanelGroup.prototype['toString'] = MixpanelGroup.prototype.toString;\n/*\n * Constants\n */\n\n/** @const */\n\nvar SET_QUEUE_KEY = '__mps';\n/** @const */\n\nvar SET_ONCE_QUEUE_KEY = '__mpso';\n/** @const */\n\nvar UNSET_QUEUE_KEY = '__mpus';\n/** @const */\n\nvar ADD_QUEUE_KEY = '__mpa';\n/** @const */\n\nvar APPEND_QUEUE_KEY = '__mpap';\n/** @const */\n\nvar REMOVE_QUEUE_KEY = '__mpr';\n/** @const */\n\nvar UNION_QUEUE_KEY = '__mpu'; // This key is deprecated, but we want to check for it to see whether aliasing is allowed.\n\n/** @const */\n\nvar PEOPLE_DISTINCT_ID_KEY = '$people_distinct_id';\n/** @const */\n\nvar ALIAS_ID_KEY = '__alias';\n/** @const */\n\nvar CAMPAIGN_IDS_KEY = '__cmpns';\n/** @const */\n\nvar EVENT_TIMERS_KEY = '__timers';\n/** @const */\n\nvar RESERVED_PROPERTIES = [SET_QUEUE_KEY, SET_ONCE_QUEUE_KEY, UNSET_QUEUE_KEY, ADD_QUEUE_KEY, APPEND_QUEUE_KEY, REMOVE_QUEUE_KEY, UNION_QUEUE_KEY, PEOPLE_DISTINCT_ID_KEY, ALIAS_ID_KEY, CAMPAIGN_IDS_KEY, EVENT_TIMERS_KEY];\n/**\n * Mixpanel Persistence Object\n * @constructor\n */\n\nvar MixpanelPersistence = function MixpanelPersistence(config) {\n  this['props'] = {};\n  this.campaign_params_saved = false;\n\n  if (config['persistence_name']) {\n    this.name = 'mp_' + config['persistence_name'];\n  } else {\n    this.name = 'mp_' + config['token'] + '_mixpanel';\n  }\n\n  var storage_type = config['persistence'];\n\n  if (storage_type !== 'cookie' && storage_type !== 'localStorage') {\n    console$1.critical('Unknown persistence type ' + storage_type + '; falling back to cookie');\n    storage_type = config['persistence'] = 'cookie';\n  }\n\n  if (storage_type === 'localStorage' && _.localStorage.is_supported()) {\n    this.storage = _.localStorage;\n  } else {\n    this.storage = _.cookie;\n  }\n\n  this.load();\n  this.update_config(config);\n  this.upgrade(config);\n  this.save();\n};\n\nMixpanelPersistence.prototype.properties = function () {\n  var p = {}; // Filter out reserved properties\n\n  _.each(this['props'], function (v, k) {\n    if (!_.include(RESERVED_PROPERTIES, k)) {\n      p[k] = v;\n    }\n  });\n\n  return p;\n};\n\nMixpanelPersistence.prototype.load = function () {\n  if (this.disabled) {\n    return;\n  }\n\n  var entry = this.storage.parse(this.name);\n\n  if (entry) {\n    this['props'] = _.extend({}, entry);\n  }\n};\n\nMixpanelPersistence.prototype.upgrade = function (config) {\n  var upgrade_from_old_lib = config['upgrade'],\n      old_cookie_name,\n      old_cookie;\n\n  if (upgrade_from_old_lib) {\n    old_cookie_name = 'mp_super_properties'; // Case where they had a custom cookie name before.\n\n    if (typeof upgrade_from_old_lib === 'string') {\n      old_cookie_name = upgrade_from_old_lib;\n    }\n\n    old_cookie = this.storage.parse(old_cookie_name); // remove the cookie\n\n    this.storage.remove(old_cookie_name);\n    this.storage.remove(old_cookie_name, true);\n\n    if (old_cookie) {\n      this['props'] = _.extend(this['props'], old_cookie['all'], old_cookie['events']);\n    }\n  }\n\n  if (!config['cookie_name'] && config['name'] !== 'mixpanel') {\n    // special case to handle people with cookies of the form\n    // mp_TOKEN_INSTANCENAME from the first release of this library\n    old_cookie_name = 'mp_' + config['token'] + '_' + config['name'];\n    old_cookie = this.storage.parse(old_cookie_name);\n\n    if (old_cookie) {\n      this.storage.remove(old_cookie_name);\n      this.storage.remove(old_cookie_name, true); // Save the prop values that were in the cookie from before -\n      // this should only happen once as we delete the old one.\n\n      this.register_once(old_cookie);\n    }\n  }\n\n  if (this.storage === _.localStorage) {\n    old_cookie = _.cookie.parse(this.name);\n\n    _.cookie.remove(this.name);\n\n    _.cookie.remove(this.name, true);\n\n    if (old_cookie) {\n      this.register_once(old_cookie);\n    }\n  }\n};\n\nMixpanelPersistence.prototype.save = function () {\n  if (this.disabled) {\n    return;\n  }\n\n  this._expire_notification_campaigns();\n\n  this.storage.set(this.name, _.JSONEncode(this['props']), this.expire_days, this.cross_subdomain, this.secure, this.cross_site, this.cookie_domain);\n};\n\nMixpanelPersistence.prototype.remove = function () {\n  // remove both domain and subdomain cookies\n  this.storage.remove(this.name, false, this.cookie_domain);\n  this.storage.remove(this.name, true, this.cookie_domain);\n}; // removes the storage entry and deletes all loaded data\n// forced name for tests\n\n\nMixpanelPersistence.prototype.clear = function () {\n  this.remove();\n  this['props'] = {};\n};\n/**\n* @param {Object} props\n* @param {*=} default_value\n* @param {number=} days\n*/\n\n\nMixpanelPersistence.prototype.register_once = function (props, default_value, days) {\n  if (_.isObject(props)) {\n    if (typeof default_value === 'undefined') {\n      default_value = 'None';\n    }\n\n    this.expire_days = typeof days === 'undefined' ? this.default_expiry : days;\n\n    _.each(props, function (val, prop) {\n      if (!this['props'].hasOwnProperty(prop) || this['props'][prop] === default_value) {\n        this['props'][prop] = val;\n      }\n    }, this);\n\n    this.save();\n    return true;\n  }\n\n  return false;\n};\n/**\n* @param {Object} props\n* @param {number=} days\n*/\n\n\nMixpanelPersistence.prototype.register = function (props, days) {\n  if (_.isObject(props)) {\n    this.expire_days = typeof days === 'undefined' ? this.default_expiry : days;\n\n    _.extend(this['props'], props);\n\n    this.save();\n    return true;\n  }\n\n  return false;\n};\n\nMixpanelPersistence.prototype.unregister = function (prop) {\n  if (prop in this['props']) {\n    delete this['props'][prop];\n    this.save();\n  }\n};\n\nMixpanelPersistence.prototype._expire_notification_campaigns = _.safewrap(function () {\n  var campaigns_shown = this['props'][CAMPAIGN_IDS_KEY],\n      EXPIRY_TIME = Config.DEBUG ? 60 * 1000 : 60 * 60 * 1000; // 1 minute (Config.DEBUG) / 1 hour (PDXN)\n\n  if (!campaigns_shown) {\n    return;\n  }\n\n  for (var campaign_id in campaigns_shown) {\n    if (1 * new Date() - campaigns_shown[campaign_id] > EXPIRY_TIME) {\n      delete campaigns_shown[campaign_id];\n    }\n  }\n\n  if (_.isEmptyObject(campaigns_shown)) {\n    delete this['props'][CAMPAIGN_IDS_KEY];\n  }\n});\n\nMixpanelPersistence.prototype.update_campaign_params = function () {\n  if (!this.campaign_params_saved) {\n    this.register_once(_.info.campaignParams());\n    this.campaign_params_saved = true;\n  }\n};\n\nMixpanelPersistence.prototype.update_search_keyword = function (referrer) {\n  this.register(_.info.searchInfo(referrer));\n}; // EXPORTED METHOD, we test this directly.\n\n\nMixpanelPersistence.prototype.update_referrer_info = function (referrer) {\n  // If referrer doesn't exist, we want to note the fact that it was type-in traffic.\n  this.register_once({\n    '$initial_referrer': referrer || '$direct',\n    '$initial_referring_domain': _.info.referringDomain(referrer) || '$direct'\n  }, '');\n};\n\nMixpanelPersistence.prototype.get_referrer_info = function () {\n  return _.strip_empty_properties({\n    '$initial_referrer': this['props']['$initial_referrer'],\n    '$initial_referring_domain': this['props']['$initial_referring_domain']\n  });\n}; // safely fills the passed in object with stored properties,\n// does not override any properties defined in both\n// returns the passed in object\n\n\nMixpanelPersistence.prototype.safe_merge = function (props) {\n  _.each(this['props'], function (val, prop) {\n    if (!(prop in props)) {\n      props[prop] = val;\n    }\n  });\n\n  return props;\n};\n\nMixpanelPersistence.prototype.update_config = function (config) {\n  this.default_expiry = this.expire_days = config['cookie_expiration'];\n  this.set_disabled(config['disable_persistence']);\n  this.set_cookie_domain(config['cookie_domain']);\n  this.set_cross_site(config['cross_site_cookie']);\n  this.set_cross_subdomain(config['cross_subdomain_cookie']);\n  this.set_secure(config['secure_cookie']);\n};\n\nMixpanelPersistence.prototype.set_disabled = function (disabled) {\n  this.disabled = disabled;\n\n  if (this.disabled) {\n    this.remove();\n  } else {\n    this.save();\n  }\n};\n\nMixpanelPersistence.prototype.set_cookie_domain = function (cookie_domain) {\n  if (cookie_domain !== this.cookie_domain) {\n    this.remove();\n    this.cookie_domain = cookie_domain;\n    this.save();\n  }\n};\n\nMixpanelPersistence.prototype.set_cross_site = function (cross_site) {\n  if (cross_site !== this.cross_site) {\n    this.cross_site = cross_site;\n    this.remove();\n    this.save();\n  }\n};\n\nMixpanelPersistence.prototype.set_cross_subdomain = function (cross_subdomain) {\n  if (cross_subdomain !== this.cross_subdomain) {\n    this.cross_subdomain = cross_subdomain;\n    this.remove();\n    this.save();\n  }\n};\n\nMixpanelPersistence.prototype.get_cross_subdomain = function () {\n  return this.cross_subdomain;\n};\n\nMixpanelPersistence.prototype.set_secure = function (secure) {\n  if (secure !== this.secure) {\n    this.secure = secure ? true : false;\n    this.remove();\n    this.save();\n  }\n};\n\nMixpanelPersistence.prototype._add_to_people_queue = function (queue, data) {\n  var q_key = this._get_queue_key(queue),\n      q_data = data[queue],\n      set_q = this._get_or_create_queue(SET_ACTION),\n      set_once_q = this._get_or_create_queue(SET_ONCE_ACTION),\n      unset_q = this._get_or_create_queue(UNSET_ACTION),\n      add_q = this._get_or_create_queue(ADD_ACTION),\n      union_q = this._get_or_create_queue(UNION_ACTION),\n      remove_q = this._get_or_create_queue(REMOVE_ACTION, []),\n      append_q = this._get_or_create_queue(APPEND_ACTION, []);\n\n  if (q_key === SET_QUEUE_KEY) {\n    // Update the set queue - we can override any existing values\n    _.extend(set_q, q_data); // if there was a pending increment, override it\n    // with the set.\n\n\n    this._pop_from_people_queue(ADD_ACTION, q_data); // if there was a pending union, override it\n    // with the set.\n\n\n    this._pop_from_people_queue(UNION_ACTION, q_data);\n\n    this._pop_from_people_queue(UNSET_ACTION, q_data);\n  } else if (q_key === SET_ONCE_QUEUE_KEY) {\n    // only queue the data if there is not already a set_once call for it.\n    _.each(q_data, function (v, k) {\n      if (!(k in set_once_q)) {\n        set_once_q[k] = v;\n      }\n    });\n\n    this._pop_from_people_queue(UNSET_ACTION, q_data);\n  } else if (q_key === UNSET_QUEUE_KEY) {\n    _.each(q_data, function (prop) {\n      // undo previously-queued actions on this key\n      _.each([set_q, set_once_q, add_q, union_q], function (enqueued_obj) {\n        if (prop in enqueued_obj) {\n          delete enqueued_obj[prop];\n        }\n      });\n\n      _.each(append_q, function (append_obj) {\n        if (prop in append_obj) {\n          delete append_obj[prop];\n        }\n      });\n\n      unset_q[prop] = true;\n    });\n  } else if (q_key === ADD_QUEUE_KEY) {\n    _.each(q_data, function (v, k) {\n      // If it exists in the set queue, increment\n      // the value\n      if (k in set_q) {\n        set_q[k] += v;\n      } else {\n        // If it doesn't exist, update the add\n        // queue\n        if (!(k in add_q)) {\n          add_q[k] = 0;\n        }\n\n        add_q[k] += v;\n      }\n    }, this);\n\n    this._pop_from_people_queue(UNSET_ACTION, q_data);\n  } else if (q_key === UNION_QUEUE_KEY) {\n    _.each(q_data, function (v, k) {\n      if (_.isArray(v)) {\n        if (!(k in union_q)) {\n          union_q[k] = [];\n        } // We may send duplicates, the server will dedup them.\n\n\n        union_q[k] = union_q[k].concat(v);\n      }\n    });\n\n    this._pop_from_people_queue(UNSET_ACTION, q_data);\n  } else if (q_key === REMOVE_QUEUE_KEY) {\n    remove_q.push(q_data);\n\n    this._pop_from_people_queue(APPEND_ACTION, q_data);\n  } else if (q_key === APPEND_QUEUE_KEY) {\n    append_q.push(q_data);\n\n    this._pop_from_people_queue(UNSET_ACTION, q_data);\n  }\n\n  console$1.log('MIXPANEL PEOPLE REQUEST (QUEUED, PENDING IDENTIFY):');\n  console$1.log(data);\n  this.save();\n};\n\nMixpanelPersistence.prototype._pop_from_people_queue = function (queue, data) {\n  var q = this._get_queue(queue);\n\n  if (!_.isUndefined(q)) {\n    _.each(data, function (v, k) {\n      if (queue === APPEND_ACTION || queue === REMOVE_ACTION) {\n        // list actions: only remove if both k+v match\n        // e.g. remove should not override append in a case like\n        // append({foo: 'bar'}); remove({foo: 'qux'})\n        _.each(q, function (queued_action) {\n          if (queued_action[k] === v) {\n            delete queued_action[k];\n          }\n        });\n      } else {\n        delete q[k];\n      }\n    }, this);\n\n    this.save();\n  }\n};\n\nMixpanelPersistence.prototype._get_queue_key = function (queue) {\n  if (queue === SET_ACTION) {\n    return SET_QUEUE_KEY;\n  } else if (queue === SET_ONCE_ACTION) {\n    return SET_ONCE_QUEUE_KEY;\n  } else if (queue === UNSET_ACTION) {\n    return UNSET_QUEUE_KEY;\n  } else if (queue === ADD_ACTION) {\n    return ADD_QUEUE_KEY;\n  } else if (queue === APPEND_ACTION) {\n    return APPEND_QUEUE_KEY;\n  } else if (queue === REMOVE_ACTION) {\n    return REMOVE_QUEUE_KEY;\n  } else if (queue === UNION_ACTION) {\n    return UNION_QUEUE_KEY;\n  } else {\n    console$1.error('Invalid queue:', queue);\n  }\n};\n\nMixpanelPersistence.prototype._get_queue = function (queue) {\n  return this['props'][this._get_queue_key(queue)];\n};\n\nMixpanelPersistence.prototype._get_or_create_queue = function (queue, default_val) {\n  var key = this._get_queue_key(queue);\n\n  default_val = _.isUndefined(default_val) ? {} : default_val;\n  return this['props'][key] || (this['props'][key] = default_val);\n};\n\nMixpanelPersistence.prototype.set_event_timer = function (event_name, timestamp) {\n  var timers = this['props'][EVENT_TIMERS_KEY] || {};\n  timers[event_name] = timestamp;\n  this['props'][EVENT_TIMERS_KEY] = timers;\n  this.save();\n};\n\nMixpanelPersistence.prototype.remove_event_timer = function (event_name) {\n  var timers = this['props'][EVENT_TIMERS_KEY] || {};\n  var timestamp = timers[event_name];\n\n  if (!_.isUndefined(timestamp)) {\n    delete this['props'][EVENT_TIMERS_KEY][event_name];\n    this.save();\n  }\n\n  return timestamp;\n};\n/*\n * This file is a js implementation for a subset in eval_node.c\n */\n\n/*\n * Constants\n */\n// Metadata keys\n\n/** @const */\n\n\nvar OPERATOR_KEY = 'operator';\n/** @const */\n\nvar PROPERTY_KEY = 'property';\n/** @const */\n\nvar WINDOW_KEY = 'window';\n/** @const */\n\nvar UNIT_KEY = 'unit';\n/** @const */\n\nvar VALUE_KEY = 'value';\n/** @const */\n\nvar HOUR_KEY = 'hour';\n/** @const */\n\nvar DAY_KEY = 'day';\n/** @const */\n\nvar WEEK_KEY = 'week';\n/** @const */\n\nvar MONTH_KEY = 'month'; // Operands\n\n/** @const */\n\nvar EVENT_PROPERTY = 'event';\n/** @const */\n\nvar LITERAL_PROPERTY = 'literal'; // Binary Operators\n\n/** @const */\n\nvar AND_OPERATOR = 'and';\n/** @const */\n\nvar OR_OPERATOR = 'or';\n/** @const */\n\nvar IN_OPERATOR = 'in';\n/** @const */\n\nvar NOT_IN_OPERATOR = 'not in';\n/** @const */\n\nvar PLUS_OPERATOR = '+';\n/** @const */\n\nvar MINUS_OPERATOR = '-';\n/** @const */\n\nvar MUL_OPERATOR = '*';\n/** @const */\n\nvar DIV_OPERATOR = '/';\n/** @const */\n\nvar MOD_OPERATOR = '%';\n/** @const */\n\nvar EQUALS_OPERATOR = '==';\n/** @const */\n\nvar NOT_EQUALS_OPERATOR = '!=';\n/** @const */\n\nvar GREATER_OPERATOR = '>';\n/** @const */\n\nvar LESS_OPERATOR = '<';\n/** @const */\n\nvar GREATER_EQUAL_OPERATOR = '>=';\n/** @const */\n\nvar LESS_EQUAL_OPERATOR = '<='; // Typecast Operators\n\n/** @const */\n\nvar BOOLEAN_OPERATOR = 'boolean';\n/** @const */\n\nvar DATETIME_OPERATOR = 'datetime';\n/** @const */\n\nvar LIST_OPERATOR = 'list';\n/** @const */\n\nvar NUMBER_OPERATOR = 'number';\n/** @const */\n\nvar STRING_OPERATOR = 'string'; // Unary Operators\n\n/** @const */\n\nvar NOT_OPERATOR = 'not';\n/** @const */\n\nvar DEFINED_OPERATOR = 'defined';\n/** @const */\n\nvar NOT_DEFINED_OPERATOR = 'not defined'; // Special literals\n\n/** @const */\n\nvar NOW_LITERAL = 'now'; // Type cast functions\n\nfunction toNumber(value) {\n  if (value === null) {\n    return null;\n  }\n\n  switch (typeof value) {\n    case 'object':\n      if (_.isDate(value) && value.getTime() >= 0) {\n        return value.getTime();\n      }\n\n      return null;\n\n    case 'boolean':\n      return Number(value);\n\n    case 'number':\n      return value;\n\n    case 'string':\n      value = Number(value);\n\n      if (!isNaN(value)) {\n        return value;\n      }\n\n      return 0;\n  }\n\n  return null;\n}\n\nfunction evaluateNumber(op, properties) {\n  if (!op['operator'] || op['operator'] !== NUMBER_OPERATOR || !op['children'] || op['children'].length !== 1) {\n    throw 'Invalid cast operator: number ' + op;\n  }\n\n  return toNumber(evaluateSelector(op['children'][0], properties));\n}\n\nfunction toBoolean(value) {\n  if (value === null) {\n    return false;\n  }\n\n  switch (typeof value) {\n    case 'boolean':\n      return value;\n\n    case 'number':\n      return value !== 0.0;\n\n    case 'string':\n      return value.length > 0;\n\n    case 'object':\n      if (_.isArray(value) && value.length > 0) {\n        return true;\n      }\n\n      if (_.isDate(value) && value.getTime() > 0) {\n        return true;\n      }\n\n      if (_.isObject(value) && !_.isEmptyObject(value)) {\n        return true;\n      }\n\n      return false;\n  }\n\n  return false;\n}\n\nfunction evaluateBoolean(op, properties) {\n  if (!op['operator'] || op['operator'] !== BOOLEAN_OPERATOR || !op['children'] || op['children'].length !== 1) {\n    throw 'Invalid cast operator: boolean ' + op;\n  }\n\n  return toBoolean(evaluateSelector(op['children'][0], properties));\n}\n\nfunction evaluateDateTime(op, properties) {\n  if (!op['operator'] || op['operator'] !== DATETIME_OPERATOR || !op['children'] || op['children'].length !== 1) {\n    throw 'Invalid cast operator: datetime ' + op;\n  }\n\n  var v = evaluateSelector(op['children'][0], properties);\n\n  if (v === null) {\n    return null;\n  }\n\n  switch (typeof v) {\n    case 'number':\n    case 'string':\n      var d = new Date(v);\n\n      if (isNaN(d.getTime())) {\n        return null;\n      }\n\n      return d;\n\n    case 'object':\n      if (_.isDate(v)) {\n        return v;\n      }\n\n  }\n\n  return null;\n}\n\nfunction evaluateList(op, properties) {\n  if (!op['operator'] || op['operator'] !== LIST_OPERATOR || !op['children'] || op['children'].length !== 1) {\n    throw 'Invalid cast operator: list ' + op;\n  }\n\n  var v = evaluateSelector(op['children'][0], properties);\n\n  if (v === null) {\n    return null;\n  }\n\n  if (_.isArray(v)) {\n    return v;\n  }\n\n  return null;\n}\n\nfunction evaluateString(op, properties) {\n  if (!op['operator'] || op['operator'] !== STRING_OPERATOR || !op['children'] || op['children'].length !== 1) {\n    throw 'Invalid cast operator: string ' + op;\n  }\n\n  var v = evaluateSelector(op['children'][0], properties);\n\n  switch (typeof v) {\n    case 'object':\n      if (_.isDate(v)) {\n        return v.toJSON();\n      }\n\n      return JSON.stringify(v);\n  }\n\n  return String(v);\n} // Operators\n\n\nfunction evaluateAnd(op, properties) {\n  if (!op['operator'] || op['operator'] !== AND_OPERATOR || !op['children'] || op['children'].length !== 2) {\n    throw 'Invalid operator: AND ' + op;\n  }\n\n  return toBoolean(evaluateSelector(op['children'][0], properties)) && toBoolean(evaluateSelector(op['children'][1], properties));\n}\n\nfunction evaluateOr(op, properties) {\n  if (!op['operator'] || op['operator'] !== OR_OPERATOR || !op['children'] || op['children'].length !== 2) {\n    throw 'Invalid operator: OR ' + op;\n  }\n\n  return toBoolean(evaluateSelector(op['children'][0], properties)) || toBoolean(evaluateSelector(op['children'][1], properties));\n}\n\nfunction evaluateIn(op, properties) {\n  if (!op['operator'] || [IN_OPERATOR, NOT_IN_OPERATOR].indexOf(op['operator']) === -1 || !op['children'] || op['children'].length !== 2) {\n    throw 'Invalid operator: IN/NOT IN ' + op;\n  }\n\n  var leftValue = evaluateSelector(op['children'][0], properties);\n  var rightValue = evaluateSelector(op['children'][1], properties);\n\n  if (!_.isArray(rightValue) && !_.isString(rightValue)) {\n    throw 'Invalid operand for operator IN: invalid type' + rightValue;\n  }\n\n  var v = rightValue.indexOf(leftValue) > -1;\n\n  if (op['operator'] === NOT_IN_OPERATOR) {\n    return !v;\n  }\n\n  return v;\n}\n\nfunction evaluatePlus(op, properties) {\n  if (!op['operator'] || op['operator'] !== PLUS_OPERATOR || !op['children'] || op['children'].length < 2) {\n    throw 'Invalid operator: PLUS ' + op;\n  }\n\n  var l = evaluateSelector(op['children'][0], properties);\n  var r = evaluateSelector(op['children'][1], properties);\n\n  if (typeof l === 'number' && typeof r === 'number') {\n    return l + r;\n  }\n\n  if (typeof l === 'string' && typeof r === 'string') {\n    return l + r;\n  }\n\n  return null;\n}\n\nfunction evaluateArithmetic(op, properties) {\n  if (!op['operator'] || [MINUS_OPERATOR, MUL_OPERATOR, DIV_OPERATOR, MOD_OPERATOR].indexOf(op['operator']) === -1 || !op['children'] || op['children'].length < 2) {\n    throw 'Invalid arithmetic operator ' + op;\n  }\n\n  var l = evaluateSelector(op['children'][0], properties);\n  var r = evaluateSelector(op['children'][1], properties);\n\n  if (typeof l === 'number' && typeof r === 'number') {\n    switch (op['operator']) {\n      case MINUS_OPERATOR:\n        return l - r;\n\n      case MUL_OPERATOR:\n        return l * r;\n\n      case DIV_OPERATOR:\n        if (r !== 0) {\n          return l / r;\n        }\n\n        return null;\n\n      case MOD_OPERATOR:\n        if (r === 0) {\n          return null;\n        }\n\n        if (l === 0) {\n          return 0;\n        }\n\n        if (l < 0 && r > 0 || l > 0 && r < 0) {\n          /* Mimic python modulo - result takes sign of the divisor\n           * if one operand is negative. */\n          return -(Math.floor(l / r) * r - l);\n        }\n\n        return l % r;\n\n      default:\n        throw 'Unknown operator: ' + op['operator'];\n    }\n  }\n\n  return null;\n}\n\nfunction _isArrayEqual(l, r) {\n  if (l === r) return true;\n  if (l === null || r === null) return false;\n  if (l.length !== r.length) return false;\n\n  for (var i = 0; i < l.length; i++) {\n    if (l[i] !== r[i]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction _isEqual(l, r) {\n  if (l === null && l === r) {\n    return true;\n  }\n\n  if (typeof l === typeof r) {\n    switch (typeof l) {\n      case 'number':\n      case 'string':\n      case 'boolean':\n        return l === r;\n\n      case 'object':\n        if (_.isArray(l) && _.isArray(r)) {\n          return _isArrayEqual(l, r);\n        }\n\n        if (_.isDate(l) && _.isDate(r)) {\n          return l.getTime() === r.getTime();\n        }\n\n        if (_.isObject(l) && _.isObject(r)) {\n          return JSON.stringify(l) === JSON.stringify(r);\n        }\n\n    }\n  }\n\n  return false;\n}\n\nfunction evaluateEquality(op, properties) {\n  if (!op['operator'] || [EQUALS_OPERATOR, NOT_EQUALS_OPERATOR].indexOf(op['operator']) === -1 || !op['children'] || op['children'].length !== 2) {\n    throw 'Invalid equality operator ' + op;\n  }\n\n  var v = _isEqual(evaluateSelector(op['children'][0], properties), evaluateSelector(op['children'][1], properties));\n\n  switch (op['operator']) {\n    case EQUALS_OPERATOR:\n      return v;\n\n    case NOT_EQUALS_OPERATOR:\n      return !v;\n  }\n}\n\nfunction evaluateComparison(op, properties) {\n  if (!op['operator'] || [GREATER_OPERATOR, GREATER_EQUAL_OPERATOR, LESS_OPERATOR, LESS_EQUAL_OPERATOR].indexOf(op['operator']) === -1 || !op['children'] || op['children'].length !== 2) {\n    throw 'Invalid comparison operator ' + op;\n  }\n\n  var l = evaluateSelector(op['children'][0], properties);\n  var r = evaluateSelector(op['children'][1], properties);\n\n  if (typeof l === typeof r) {\n    if (typeof r === 'number' || _.isDate(r)) {\n      l = toNumber(l);\n      r = toNumber(r);\n\n      switch (op['operator']) {\n        case GREATER_OPERATOR:\n          return l > r;\n\n        case GREATER_EQUAL_OPERATOR:\n          return l >= r;\n\n        case LESS_OPERATOR:\n          return l < r;\n\n        case LESS_EQUAL_OPERATOR:\n          return l <= r;\n      }\n    } else if (typeof r === 'string') {\n      var compare = l.localeCompare(r);\n\n      switch (op['operator']) {\n        case GREATER_OPERATOR:\n          return compare > 0;\n\n        case GREATER_EQUAL_OPERATOR:\n          return compare >= 0;\n\n        case LESS_OPERATOR:\n          return compare < 0;\n\n        case LESS_EQUAL_OPERATOR:\n          return compare <= 0;\n      }\n    }\n  }\n\n  return null;\n}\n\nfunction evaluateDefined(op, properties) {\n  if (!op['operator'] || [DEFINED_OPERATOR, NOT_DEFINED_OPERATOR].indexOf(op['operator']) === -1 || !op['children'] || op['children'].length !== 1) {\n    throw 'Invalid defined/not defined operator: ' + op;\n  }\n\n  var b = evaluateSelector(op['children'][0], properties) !== null;\n\n  if (op['operator'] === NOT_DEFINED_OPERATOR) {\n    return !b;\n  }\n\n  return b;\n}\n\nfunction evaluateNot(op, properties) {\n  if (!op['operator'] || op['operator'] !== NOT_OPERATOR || !op['children'] || op['children'].length !== 1) {\n    throw 'Invalid not operator: ' + op;\n  }\n\n  var v = evaluateSelector(op['children'][0], properties);\n\n  if (v === null) {\n    return true;\n  }\n\n  if (typeof v === 'boolean') {\n    return !v;\n  }\n\n  return null;\n}\n\nfunction evaluateOperator(op, properties) {\n  if (!op['operator']) {\n    throw 'Invalid operator: operator key missing ' + op;\n  }\n\n  switch (op['operator']) {\n    case AND_OPERATOR:\n      return evaluateAnd(op, properties);\n\n    case OR_OPERATOR:\n      return evaluateOr(op, properties);\n\n    case IN_OPERATOR:\n    case NOT_IN_OPERATOR:\n      return evaluateIn(op, properties);\n\n    case PLUS_OPERATOR:\n      return evaluatePlus(op, properties);\n\n    case MINUS_OPERATOR:\n    case MUL_OPERATOR:\n    case DIV_OPERATOR:\n    case MOD_OPERATOR:\n      return evaluateArithmetic(op, properties);\n\n    case EQUALS_OPERATOR:\n    case NOT_EQUALS_OPERATOR:\n      return evaluateEquality(op, properties);\n\n    case GREATER_OPERATOR:\n    case LESS_OPERATOR:\n    case GREATER_EQUAL_OPERATOR:\n    case LESS_EQUAL_OPERATOR:\n      return evaluateComparison(op, properties);\n\n    case BOOLEAN_OPERATOR:\n      return evaluateBoolean(op, properties);\n\n    case DATETIME_OPERATOR:\n      return evaluateDateTime(op, properties);\n\n    case LIST_OPERATOR:\n      return evaluateList(op, properties);\n\n    case NUMBER_OPERATOR:\n      return evaluateNumber(op, properties);\n\n    case STRING_OPERATOR:\n      return evaluateString(op, properties);\n\n    case DEFINED_OPERATOR:\n    case NOT_DEFINED_OPERATOR:\n      return evaluateDefined(op, properties);\n\n    case NOT_OPERATOR:\n      return evaluateNot(op, properties);\n  }\n}\n\nfunction evaluateWindow(value) {\n  var win = value[WINDOW_KEY];\n\n  if (!win || !win[UNIT_KEY] || !win[VALUE_KEY]) {\n    throw 'Invalid window: missing required keys ' + JSON.stringify(value);\n  }\n\n  var out = new Date();\n\n  switch (win[UNIT_KEY]) {\n    case HOUR_KEY:\n      out.setTime(out.getTime() + win[VALUE_KEY] * -1 * 60 * 60 * 1000);\n      break;\n\n    case DAY_KEY:\n      out.setTime(out.getTime() + win[VALUE_KEY] * -1 * 24 * 60 * 60 * 1000);\n      break;\n\n    case WEEK_KEY:\n      out.setTime(out.getTime() + win[VALUE_KEY] * -1 * 7 * 24 * 60 * 60 * 1000);\n      break;\n\n    case MONTH_KEY:\n      out.setTime(out.getTime() + win[VALUE_KEY] * -1 * 30 * 24 * 60 * 60 * 1000);\n      break;\n\n    default:\n      throw 'Invalid unit: ' + win[UNIT_KEY];\n  }\n\n  return out;\n}\n\nfunction evaluateOperand(op, properties) {\n  if (!op['property'] || !op['value']) {\n    throw 'Invalid operand: missing required keys ' + op;\n  }\n\n  switch (op['property']) {\n    case EVENT_PROPERTY:\n      if (properties[op['value']] !== undefined) {\n        return properties[op['value']];\n      }\n\n      return null;\n\n    case LITERAL_PROPERTY:\n      if (op['value'] === NOW_LITERAL) {\n        return new Date();\n      }\n\n      if (typeof op['value'] === 'object') {\n        return evaluateWindow(op['value']);\n      }\n\n      return op['value'];\n\n    default:\n      throw 'Invalid operand: Invalid property type ' + op['property'];\n  }\n}\n\nfunction evaluateSelector(filters, properties) {\n  if (filters[PROPERTY_KEY]) {\n    return evaluateOperand(filters, properties);\n  }\n\n  if (filters[OPERATOR_KEY]) {\n    return evaluateOperator(filters, properties);\n  }\n} // Internal class for notification display\n\n\nvar MixpanelNotification = function MixpanelNotification(notif_data, mixpanel_instance) {\n  _.bind_instance_methods(this);\n\n  this.mixpanel = mixpanel_instance;\n  this.persistence = this.mixpanel['persistence'];\n  this.resource_protocol = this.mixpanel.get_config('inapp_protocol');\n  this.cdn_host = this.mixpanel.get_config('cdn');\n  this.campaign_id = _.escapeHTML(notif_data['id']);\n  this.message_id = _.escapeHTML(notif_data['message_id']);\n  this.body = (_.escapeHTML(notif_data['body']) || '').replace(/\\n/g, '<br/>');\n  this.cta = _.escapeHTML(notif_data['cta']) || 'Close';\n  this.notif_type = _.escapeHTML(notif_data['type']) || 'takeover';\n  this.style = _.escapeHTML(notif_data['style']) || 'light';\n  this.title = _.escapeHTML(notif_data['title']) || '';\n  this.video_width = MixpanelNotification.VIDEO_WIDTH;\n  this.video_height = MixpanelNotification.VIDEO_HEIGHT;\n  this.display_triggers = notif_data['display_triggers'] || []; // These fields are url-sanitized in the backend already.\n\n  this.dest_url = notif_data['cta_url'] || null;\n  this.image_url = notif_data['image_url'] || null;\n  this.thumb_image_url = notif_data['thumb_image_url'] || null;\n  this.video_url = notif_data['video_url'] || null;\n\n  if (this.thumb_image_url && this.thumb_image_url.indexOf('//') === 0) {\n    this.thumb_image_url = this.thumb_image_url.replace('//', this.resource_protocol);\n  }\n\n  this.clickthrough = true;\n\n  if (!this.dest_url) {\n    this.dest_url = '#dismiss';\n    this.clickthrough = false;\n  }\n\n  this.mini = this.notif_type === 'mini';\n\n  if (!this.mini) {\n    this.notif_type = 'takeover';\n  }\n\n  this.notif_width = !this.mini ? MixpanelNotification.NOTIF_WIDTH : MixpanelNotification.NOTIF_WIDTH_MINI;\n\n  this._set_client_config();\n\n  this.imgs_to_preload = this._init_image_html();\n\n  this._init_video();\n};\n\nMixpanelNotification.ANIM_TIME = 200;\nMixpanelNotification.MARKUP_PREFIX = 'mixpanel-notification';\nMixpanelNotification.BG_OPACITY = 0.6;\nMixpanelNotification.NOTIF_TOP = 25;\nMixpanelNotification.NOTIF_START_TOP = 200;\nMixpanelNotification.NOTIF_WIDTH = 388;\nMixpanelNotification.NOTIF_WIDTH_MINI = 420;\nMixpanelNotification.NOTIF_HEIGHT_MINI = 85;\nMixpanelNotification.THUMB_BORDER_SIZE = 5;\nMixpanelNotification.THUMB_IMG_SIZE = 60;\nMixpanelNotification.THUMB_OFFSET = Math.round(MixpanelNotification.THUMB_IMG_SIZE / 2);\nMixpanelNotification.VIDEO_WIDTH = 595;\nMixpanelNotification.VIDEO_HEIGHT = 334;\n\nMixpanelNotification.prototype.show = function () {\n  var self = this;\n\n  this._set_client_config(); // don't display until HTML body exists\n\n\n  if (!this.body_el) {\n    setTimeout(function () {\n      self.show();\n    }, 300);\n    return;\n  }\n\n  this._init_styles();\n\n  this._init_notification_el(); // wait for any images to load before showing notification\n\n\n  this._preload_images(this._attach_and_animate);\n};\n\nMixpanelNotification.prototype.dismiss = _.safewrap(function () {\n  if (!this.marked_as_shown) {\n    // unexpected condition: user interacted with notif even though we didn't consider it\n    // visible (see _mark_as_shown()); send tracking signals to mark delivery\n    this._mark_delivery({\n      'invisible': true\n    });\n  }\n\n  var exiting_el = this.showing_video ? this._get_el('video') : this._get_notification_display_el();\n\n  if (this.use_transitions) {\n    this._remove_class('bg', 'visible');\n\n    this._add_class(exiting_el, 'exiting');\n\n    setTimeout(this._remove_notification_el, MixpanelNotification.ANIM_TIME);\n  } else {\n    var notif_attr, notif_start, notif_goal;\n\n    if (this.mini) {\n      notif_attr = 'right';\n      notif_start = 20;\n      notif_goal = -100;\n    } else {\n      notif_attr = 'top';\n      notif_start = MixpanelNotification.NOTIF_TOP;\n      notif_goal = MixpanelNotification.NOTIF_START_TOP + MixpanelNotification.NOTIF_TOP;\n    }\n\n    this._animate_els([{\n      el: this._get_el('bg'),\n      attr: 'opacity',\n      start: MixpanelNotification.BG_OPACITY,\n      goal: 0.0\n    }, {\n      el: exiting_el,\n      attr: 'opacity',\n      start: 1.0,\n      goal: 0.0\n    }, {\n      el: exiting_el,\n      attr: notif_attr,\n      start: notif_start,\n      goal: notif_goal\n    }], MixpanelNotification.ANIM_TIME, this._remove_notification_el);\n  }\n});\nMixpanelNotification.prototype._add_class = _.safewrap(function (el, class_name) {\n  class_name = MixpanelNotification.MARKUP_PREFIX + '-' + class_name;\n\n  if (typeof el === 'string') {\n    el = this._get_el(el);\n  }\n\n  if (!el.className) {\n    el.className = class_name;\n  } else if (!~(' ' + el.className + ' ').indexOf(' ' + class_name + ' ')) {\n    el.className += ' ' + class_name;\n  }\n});\nMixpanelNotification.prototype._remove_class = _.safewrap(function (el, class_name) {\n  class_name = MixpanelNotification.MARKUP_PREFIX + '-' + class_name;\n\n  if (typeof el === 'string') {\n    el = this._get_el(el);\n  }\n\n  if (el.className) {\n    el.className = (' ' + el.className + ' ').replace(' ' + class_name + ' ', '').replace(/^[\\s\\xA0]+/, '').replace(/[\\s\\xA0]+$/, '');\n  }\n});\nMixpanelNotification.prototype._animate_els = _.safewrap(function (anims, mss, done_cb, start_time) {\n  var self = this,\n      in_progress = false,\n      ai,\n      anim,\n      cur_time = 1 * new Date(),\n      time_diff;\n  start_time = start_time || cur_time;\n  time_diff = cur_time - start_time;\n\n  for (ai = 0; ai < anims.length; ai++) {\n    anim = anims[ai];\n\n    if (typeof anim.val === 'undefined') {\n      anim.val = anim.start;\n    }\n\n    if (anim.val !== anim.goal) {\n      in_progress = true;\n      var anim_diff = anim.goal - anim.start,\n          anim_dir = anim.goal >= anim.start ? 1 : -1;\n      anim.val = anim.start + anim_diff * time_diff / mss;\n\n      if (anim.attr !== 'opacity') {\n        anim.val = Math.round(anim.val);\n      }\n\n      if (anim_dir > 0 && anim.val >= anim.goal || anim_dir < 0 && anim.val <= anim.goal) {\n        anim.val = anim.goal;\n      }\n    }\n  }\n\n  if (!in_progress) {\n    if (done_cb) {\n      done_cb();\n    }\n\n    return;\n  }\n\n  for (ai = 0; ai < anims.length; ai++) {\n    anim = anims[ai];\n\n    if (anim.el) {\n      var suffix = anim.attr === 'opacity' ? '' : 'px';\n      anim.el.style[anim.attr] = String(anim.val) + suffix;\n    }\n  }\n\n  setTimeout(function () {\n    self._animate_els(anims, mss, done_cb, start_time);\n  }, 10);\n});\nMixpanelNotification.prototype._attach_and_animate = _.safewrap(function () {\n  var self = this; // no possibility to double-display\n\n  if (this.shown || this._get_shown_campaigns()[this.campaign_id]) {\n    return;\n  }\n\n  this.shown = true;\n  this.body_el.appendChild(this.notification_el);\n  setTimeout(function () {\n    var notif_el = self._get_notification_display_el();\n\n    if (self.use_transitions) {\n      if (!self.mini) {\n        self._add_class('bg', 'visible');\n      }\n\n      self._add_class(notif_el, 'visible');\n\n      self._mark_as_shown();\n    } else {\n      var notif_attr, notif_start, notif_goal;\n\n      if (self.mini) {\n        notif_attr = 'right';\n        notif_start = -100;\n        notif_goal = 20;\n      } else {\n        notif_attr = 'top';\n        notif_start = MixpanelNotification.NOTIF_START_TOP + MixpanelNotification.NOTIF_TOP;\n        notif_goal = MixpanelNotification.NOTIF_TOP;\n      }\n\n      self._animate_els([{\n        el: self._get_el('bg'),\n        attr: 'opacity',\n        start: 0.0,\n        goal: MixpanelNotification.BG_OPACITY\n      }, {\n        el: notif_el,\n        attr: 'opacity',\n        start: 0.0,\n        goal: 1.0\n      }, {\n        el: notif_el,\n        attr: notif_attr,\n        start: notif_start,\n        goal: notif_goal\n      }], MixpanelNotification.ANIM_TIME, self._mark_as_shown);\n    }\n  }, 100);\n\n  _.register_event(self._get_el('cancel'), 'click', function (e) {\n    e.preventDefault();\n    self.dismiss();\n  });\n\n  var click_el = self._get_el('button') || self._get_el('mini-content');\n\n  _.register_event(click_el, 'click', function (e) {\n    e.preventDefault();\n\n    if (self.show_video) {\n      self._track_event('$campaign_open', {\n        '$resource_type': 'video'\n      });\n\n      self._switch_to_video();\n    } else {\n      self.dismiss();\n\n      if (self.clickthrough) {\n        var tracking_cb = null;\n\n        if (self.mixpanel.get_config('inapp_link_new_window')) {\n          window.open(self.dest_url);\n        } else {\n          tracking_cb = function tracking_cb() {\n            window.location.href = self.dest_url;\n          };\n        }\n\n        self._track_event('$campaign_open', {\n          '$resource_type': 'link'\n        }, tracking_cb);\n      }\n    }\n  });\n});\n\nMixpanelNotification.prototype._get_el = function (id) {\n  return document.getElementById(MixpanelNotification.MARKUP_PREFIX + '-' + id);\n};\n\nMixpanelNotification.prototype._get_notification_display_el = function () {\n  return this._get_el(this.notif_type);\n};\n\nMixpanelNotification.prototype._get_shown_campaigns = function () {\n  return this.persistence['props'][CAMPAIGN_IDS_KEY] || (this.persistence['props'][CAMPAIGN_IDS_KEY] = {});\n};\n\nMixpanelNotification.prototype._matches_event_data = _.safewrap(function (event_data) {\n  var event_name = event_data['event'] || '';\n\n  for (var i = 0; i < this.display_triggers.length; i++) {\n    var display_trigger = this.display_triggers[i];\n    var match_event = display_trigger['event'] || '';\n\n    if (match_event === '$any_event' || event_name === display_trigger['event']) {\n      if (display_trigger['selector'] && !_.isEmptyObject(display_trigger['selector'])) {\n        if (evaluateSelector(display_trigger['selector'], event_data['properties'])) {\n          return true;\n        }\n      } else {\n        return true;\n      }\n    }\n  }\n\n  return false;\n});\n\nMixpanelNotification.prototype._browser_lte = function (browser, version) {\n  return this.browser_versions[browser] && this.browser_versions[browser] <= version;\n};\n\nMixpanelNotification.prototype._init_image_html = function () {\n  var imgs_to_preload = [];\n\n  if (!this.mini) {\n    if (this.image_url) {\n      imgs_to_preload.push(this.image_url);\n      this.img_html = '<img id=\"img\" src=\"' + this.image_url + '\"/>';\n    } else {\n      this.img_html = '';\n    }\n\n    if (this.thumb_image_url) {\n      imgs_to_preload.push(this.thumb_image_url);\n      this.thumb_img_html = '<div id=\"thumbborder-wrapper\"><div id=\"thumbborder\"></div></div>' + '<img id=\"thumbnail\"' + ' src=\"' + this.thumb_image_url + '\"' + ' width=\"' + MixpanelNotification.THUMB_IMG_SIZE + '\"' + ' height=\"' + MixpanelNotification.THUMB_IMG_SIZE + '\"' + '/>' + '<div id=\"thumbspacer\"></div>';\n    } else {\n      this.thumb_img_html = '';\n    }\n  } else {\n    this.thumb_image_url = this.thumb_image_url || this.cdn_host + '/site_media/images/icons/notifications/mini-news-dark.png';\n    imgs_to_preload.push(this.thumb_image_url);\n  }\n\n  return imgs_to_preload;\n};\n\nMixpanelNotification.prototype._init_notification_el = function () {\n  var notification_html = '';\n  var video_src = '';\n  var video_html = '';\n  var cancel_html = '<div id=\"cancel\">' + '<div id=\"cancel-icon\"></div>' + '</div>';\n  this.notification_el = document.createElement('div');\n  this.notification_el.id = MixpanelNotification.MARKUP_PREFIX + '-wrapper';\n\n  if (!this.mini) {\n    // TAKEOVER notification\n    var close_html = this.clickthrough || this.show_video ? '' : '<div id=\"button-close\"></div>',\n        play_html = this.show_video ? '<div id=\"button-play\"></div>' : '';\n\n    if (this._browser_lte('ie', 7)) {\n      close_html = '';\n      play_html = '';\n    }\n\n    notification_html = '<div id=\"takeover\">' + this.thumb_img_html + '<div id=\"mainbox\">' + cancel_html + '<div id=\"content\">' + this.img_html + '<div id=\"title\">' + this.title + '</div>' + '<div id=\"body\">' + this.body + '</div>' + '<div id=\"tagline\">' + '<a href=\"http://mixpanel.com?from=inapp\" target=\"_blank\">POWERED BY MIXPANEL</a>' + '</div>' + '</div>' + '<div id=\"button\">' + close_html + '<a id=\"button-link\" href=\"' + this.dest_url + '\">' + this.cta + '</a>' + play_html + '</div>' + '</div>' + '</div>';\n  } else {\n    // MINI notification\n    notification_html = '<div id=\"mini\">' + '<div id=\"mainbox\">' + cancel_html + '<div id=\"mini-content\">' + '<div id=\"mini-icon\">' + '<div id=\"mini-icon-img\"></div>' + '</div>' + '<div id=\"body\">' + '<div id=\"body-text\"><div>' + this.body + '</div></div>' + '</div>' + '</div>' + '</div>' + '<div id=\"mini-border\"></div>' + '</div>';\n  }\n\n  if (this.youtube_video) {\n    video_src = this.resource_protocol + 'www.youtube.com/embed/' + this.youtube_video + '?wmode=transparent&showinfo=0&modestbranding=0&rel=0&autoplay=1&loop=0&vq=hd1080';\n\n    if (this.yt_custom) {\n      video_src += '&enablejsapi=1&html5=1&controls=0';\n      video_html = '<div id=\"video-controls\">' + '<div id=\"video-progress\" class=\"video-progress-el\">' + '<div id=\"video-progress-total\" class=\"video-progress-el\"></div>' + '<div id=\"video-elapsed\" class=\"video-progress-el\"></div>' + '</div>' + '<div id=\"video-time\" class=\"video-progress-el\"></div>' + '</div>';\n    }\n  } else if (this.vimeo_video) {\n    video_src = this.resource_protocol + 'player.vimeo.com/video/' + this.vimeo_video + '?autoplay=1&title=0&byline=0&portrait=0';\n  }\n\n  if (this.show_video) {\n    this.video_iframe = '<iframe id=\"' + MixpanelNotification.MARKUP_PREFIX + '-video-frame\" ' + 'width=\"' + this.video_width + '\" height=\"' + this.video_height + '\" ' + ' src=\"' + video_src + '\"' + ' frameborder=\"0\" webkitallowfullscreen mozallowfullscreen allowfullscreen=\"1\" scrolling=\"no\"' + '></iframe>';\n    video_html = '<div id=\"video-' + (this.flip_animate ? '' : 'no') + 'flip\">' + '<div id=\"video\">' + '<div id=\"video-holder\"></div>' + video_html + '</div>' + '</div>';\n  }\n\n  var main_html = video_html + notification_html;\n\n  if (this.flip_animate) {\n    main_html = (this.mini ? notification_html : '') + '<div id=\"flipcontainer\"><div id=\"flipper\">' + (this.mini ? video_html : main_html) + '</div></div>';\n  }\n\n  this.notification_el.innerHTML = ('<div id=\"overlay\" class=\"' + this.notif_type + '\">' + '<div id=\"campaignid-' + this.campaign_id + '\">' + '<div id=\"bgwrapper\">' + '<div id=\"bg\"></div>' + main_html + '</div>' + '</div>' + '</div>').replace(/class=\"/g, 'class=\"' + MixpanelNotification.MARKUP_PREFIX + '-').replace(/id=\"/g, 'id=\"' + MixpanelNotification.MARKUP_PREFIX + '-');\n};\n\nMixpanelNotification.prototype._init_styles = function () {\n  if (this.style === 'dark') {\n    this.style_vals = {\n      bg: '#1d1f25',\n      bg_actions: '#282b32',\n      bg_hover: '#3a4147',\n      bg_light: '#4a5157',\n      border_gray: '#32353c',\n      cancel_opacity: '0.4',\n      mini_hover: '#2a3137',\n      text_title: '#fff',\n      text_main: '#9498a3',\n      text_tagline: '#464851',\n      text_hover: '#ddd'\n    };\n  } else {\n    this.style_vals = {\n      bg: '#fff',\n      bg_actions: '#e7eaee',\n      bg_hover: '#eceff3',\n      bg_light: '#f5f5f5',\n      border_gray: '#e4ecf2',\n      cancel_opacity: '1.0',\n      mini_hover: '#fafafa',\n      text_title: '#5c6578',\n      text_main: '#8b949b',\n      text_tagline: '#ced9e6',\n      text_hover: '#7c8598'\n    };\n  }\n\n  var shadow = '0px 0px 35px 0px rgba(45, 49, 56, 0.7)',\n      video_shadow = shadow,\n      mini_shadow = shadow,\n      thumb_total_size = MixpanelNotification.THUMB_IMG_SIZE + MixpanelNotification.THUMB_BORDER_SIZE * 2,\n      anim_seconds = MixpanelNotification.ANIM_TIME / 1000 + 's';\n\n  if (this.mini) {\n    shadow = 'none';\n  } // don't display on small viewports\n\n\n  var notif_media_queries = {},\n      min_width = MixpanelNotification.NOTIF_WIDTH_MINI + 20;\n  notif_media_queries['@media only screen and (max-width: ' + (min_width - 1) + 'px)'] = {\n    '#overlay': {\n      'display': 'none'\n    }\n  };\n  var notif_styles = {\n    '.flipped': {\n      'transform': 'rotateY(180deg)'\n    },\n    '#overlay': {\n      'position': 'fixed',\n      'top': '0',\n      'left': '0',\n      'width': '100%',\n      'height': '100%',\n      'overflow': 'auto',\n      'text-align': 'center',\n      'z-index': '10000',\n      'font-family': '\"Helvetica\", \"Arial\", sans-serif',\n      '-webkit-font-smoothing': 'antialiased',\n      '-moz-osx-font-smoothing': 'grayscale'\n    },\n    '#overlay.mini': {\n      'height': '0',\n      'overflow': 'visible'\n    },\n    '#overlay a': {\n      'width': 'initial',\n      'padding': '0',\n      'text-decoration': 'none',\n      'text-transform': 'none',\n      'color': 'inherit'\n    },\n    '#bgwrapper': {\n      'position': 'relative',\n      'width': '100%',\n      'height': '100%'\n    },\n    '#bg': {\n      'position': 'fixed',\n      'top': '0',\n      'left': '0',\n      'width': '100%',\n      'height': '100%',\n      'min-width': this.doc_width * 4 + 'px',\n      'min-height': this.doc_height * 4 + 'px',\n      'background-color': 'black',\n      'opacity': '0.0',\n      '-ms-filter': 'progid:DXImageTransform.Microsoft.Alpha(Opacity=60)',\n      // IE8\n      'filter': 'alpha(opacity=60)',\n      // IE5-7\n      'transition': 'opacity ' + anim_seconds\n    },\n    '#bg.visible': {\n      'opacity': MixpanelNotification.BG_OPACITY\n    },\n    '.mini #bg': {\n      'width': '0',\n      'height': '0',\n      'min-width': '0'\n    },\n    '#flipcontainer': {\n      'perspective': '1000px',\n      'position': 'absolute',\n      'width': '100%'\n    },\n    '#flipper': {\n      'position': 'relative',\n      'transform-style': 'preserve-3d',\n      'transition': '0.3s'\n    },\n    '#takeover': {\n      'position': 'absolute',\n      'left': '50%',\n      'width': MixpanelNotification.NOTIF_WIDTH + 'px',\n      'margin-left': Math.round(-MixpanelNotification.NOTIF_WIDTH / 2) + 'px',\n      'backface-visibility': 'hidden',\n      'transform': 'rotateY(0deg)',\n      'opacity': '0.0',\n      'top': MixpanelNotification.NOTIF_START_TOP + 'px',\n      'transition': 'opacity ' + anim_seconds + ', top ' + anim_seconds\n    },\n    '#takeover.visible': {\n      'opacity': '1.0',\n      'top': MixpanelNotification.NOTIF_TOP + 'px'\n    },\n    '#takeover.exiting': {\n      'opacity': '0.0',\n      'top': MixpanelNotification.NOTIF_START_TOP + 'px'\n    },\n    '#thumbspacer': {\n      'height': MixpanelNotification.THUMB_OFFSET + 'px'\n    },\n    '#thumbborder-wrapper': {\n      'position': 'absolute',\n      'top': -MixpanelNotification.THUMB_BORDER_SIZE + 'px',\n      'left': MixpanelNotification.NOTIF_WIDTH / 2 - MixpanelNotification.THUMB_OFFSET - MixpanelNotification.THUMB_BORDER_SIZE + 'px',\n      'width': thumb_total_size + 'px',\n      'height': thumb_total_size / 2 + 'px',\n      'overflow': 'hidden'\n    },\n    '#thumbborder': {\n      'position': 'absolute',\n      'width': thumb_total_size + 'px',\n      'height': thumb_total_size + 'px',\n      'border-radius': thumb_total_size + 'px',\n      'background-color': this.style_vals.bg_actions,\n      'opacity': '0.5'\n    },\n    '#thumbnail': {\n      'position': 'absolute',\n      'top': '0px',\n      'left': MixpanelNotification.NOTIF_WIDTH / 2 - MixpanelNotification.THUMB_OFFSET + 'px',\n      'width': MixpanelNotification.THUMB_IMG_SIZE + 'px',\n      'height': MixpanelNotification.THUMB_IMG_SIZE + 'px',\n      'overflow': 'hidden',\n      'z-index': '100',\n      'border-radius': MixpanelNotification.THUMB_IMG_SIZE + 'px'\n    },\n    '#mini': {\n      'position': 'absolute',\n      'right': '20px',\n      'top': MixpanelNotification.NOTIF_TOP + 'px',\n      'width': this.notif_width + 'px',\n      'height': MixpanelNotification.NOTIF_HEIGHT_MINI * 2 + 'px',\n      'margin-top': 20 - MixpanelNotification.NOTIF_HEIGHT_MINI + 'px',\n      'backface-visibility': 'hidden',\n      'opacity': '0.0',\n      'transform': 'rotateX(90deg)',\n      'transition': 'opacity 0.3s, transform 0.3s, right 0.3s'\n    },\n    '#mini.visible': {\n      'opacity': '1.0',\n      'transform': 'rotateX(0deg)'\n    },\n    '#mini.exiting': {\n      'opacity': '0.0',\n      'right': '-150px'\n    },\n    '#mainbox': {\n      'border-radius': '4px',\n      'box-shadow': shadow,\n      'text-align': 'center',\n      'background-color': this.style_vals.bg,\n      'font-size': '14px',\n      'color': this.style_vals.text_main\n    },\n    '#mini #mainbox': {\n      'height': MixpanelNotification.NOTIF_HEIGHT_MINI + 'px',\n      'margin-top': MixpanelNotification.NOTIF_HEIGHT_MINI + 'px',\n      'border-radius': '3px',\n      'transition': 'background-color ' + anim_seconds\n    },\n    '#mini-border': {\n      'height': MixpanelNotification.NOTIF_HEIGHT_MINI + 6 + 'px',\n      'width': MixpanelNotification.NOTIF_WIDTH_MINI + 6 + 'px',\n      'position': 'absolute',\n      'top': '-3px',\n      'left': '-3px',\n      'margin-top': MixpanelNotification.NOTIF_HEIGHT_MINI + 'px',\n      'border-radius': '6px',\n      'opacity': '0.25',\n      'background-color': '#fff',\n      'z-index': '-1',\n      'box-shadow': mini_shadow\n    },\n    '#mini-icon': {\n      'position': 'relative',\n      'display': 'inline-block',\n      'width': '75px',\n      'height': MixpanelNotification.NOTIF_HEIGHT_MINI + 'px',\n      'border-radius': '3px 0 0 3px',\n      'background-color': this.style_vals.bg_actions,\n      'background': 'linear-gradient(135deg, ' + this.style_vals.bg_light + ' 0%, ' + this.style_vals.bg_actions + ' 100%)',\n      'transition': 'background-color ' + anim_seconds\n    },\n    '#mini:hover #mini-icon': {\n      'background-color': this.style_vals.mini_hover\n    },\n    '#mini:hover #mainbox': {\n      'background-color': this.style_vals.mini_hover\n    },\n    '#mini-icon-img': {\n      'position': 'absolute',\n      'background-image': 'url(' + this.thumb_image_url + ')',\n      'width': '48px',\n      'height': '48px',\n      'top': '20px',\n      'left': '12px'\n    },\n    '#content': {\n      'padding': '30px 20px 0px 20px'\n    },\n    '#mini-content': {\n      'text-align': 'left',\n      'height': MixpanelNotification.NOTIF_HEIGHT_MINI + 'px',\n      'cursor': 'pointer'\n    },\n    '#img': {\n      'width': '328px',\n      'margin-top': '30px',\n      'border-radius': '5px'\n    },\n    '#title': {\n      'max-height': '600px',\n      'overflow': 'hidden',\n      'word-wrap': 'break-word',\n      'padding': '25px 0px 20px 0px',\n      'font-size': '19px',\n      'font-weight': 'bold',\n      'color': this.style_vals.text_title\n    },\n    '#body': {\n      'max-height': '600px',\n      'margin-bottom': '25px',\n      'overflow': 'hidden',\n      'word-wrap': 'break-word',\n      'line-height': '21px',\n      'font-size': '15px',\n      'font-weight': 'normal',\n      'text-align': 'left'\n    },\n    '#mini #body': {\n      'display': 'inline-block',\n      'max-width': '250px',\n      'margin': '0 0 0 30px',\n      'height': MixpanelNotification.NOTIF_HEIGHT_MINI + 'px',\n      'font-size': '16px',\n      'letter-spacing': '0.8px',\n      'color': this.style_vals.text_title\n    },\n    '#mini #body-text': {\n      'display': 'table',\n      'height': MixpanelNotification.NOTIF_HEIGHT_MINI + 'px'\n    },\n    '#mini #body-text div': {\n      'display': 'table-cell',\n      'vertical-align': 'middle'\n    },\n    '#tagline': {\n      'margin-bottom': '15px',\n      'font-size': '10px',\n      'font-weight': '600',\n      'letter-spacing': '0.8px',\n      'color': '#ccd7e0',\n      'text-align': 'left'\n    },\n    '#tagline a': {\n      'color': this.style_vals.text_tagline,\n      'transition': 'color ' + anim_seconds\n    },\n    '#tagline a:hover': {\n      'color': this.style_vals.text_hover\n    },\n    '#cancel': {\n      'position': 'absolute',\n      'right': '0',\n      'width': '8px',\n      'height': '8px',\n      'padding': '10px',\n      'border-radius': '20px',\n      'margin': '12px 12px 0 0',\n      'box-sizing': 'content-box',\n      'cursor': 'pointer',\n      'transition': 'background-color ' + anim_seconds\n    },\n    '#mini #cancel': {\n      'margin': '7px 7px 0 0'\n    },\n    '#cancel-icon': {\n      'width': '8px',\n      'height': '8px',\n      'overflow': 'hidden',\n      'background-image': 'url(' + this.cdn_host + '/site_media/images/icons/notifications/cancel-x.png)',\n      'opacity': this.style_vals.cancel_opacity\n    },\n    '#cancel:hover': {\n      'background-color': this.style_vals.bg_hover\n    },\n    '#button': {\n      'display': 'block',\n      'height': '60px',\n      'line-height': '60px',\n      'text-align': 'center',\n      'background-color': this.style_vals.bg_actions,\n      'border-radius': '0 0 4px 4px',\n      'overflow': 'hidden',\n      'cursor': 'pointer',\n      'transition': 'background-color ' + anim_seconds\n    },\n    '#button-close': {\n      'display': 'inline-block',\n      'width': '9px',\n      'height': '60px',\n      'margin-right': '8px',\n      'vertical-align': 'top',\n      'background-image': 'url(' + this.cdn_host + '/site_media/images/icons/notifications/close-x-' + this.style + '.png)',\n      'background-repeat': 'no-repeat',\n      'background-position': '0px 25px'\n    },\n    '#button-play': {\n      'display': 'inline-block',\n      'width': '30px',\n      'height': '60px',\n      'margin-left': '15px',\n      'background-image': 'url(' + this.cdn_host + '/site_media/images/icons/notifications/play-' + this.style + '-small.png)',\n      'background-repeat': 'no-repeat',\n      'background-position': '0px 15px'\n    },\n    'a#button-link': {\n      'display': 'inline-block',\n      'vertical-align': 'top',\n      'text-align': 'center',\n      'font-size': '17px',\n      'font-weight': 'bold',\n      'overflow': 'hidden',\n      'word-wrap': 'break-word',\n      'color': this.style_vals.text_title,\n      'transition': 'color ' + anim_seconds\n    },\n    '#button:hover': {\n      'background-color': this.style_vals.bg_hover,\n      'color': this.style_vals.text_hover\n    },\n    '#button:hover a': {\n      'color': this.style_vals.text_hover\n    },\n    '#video-noflip': {\n      'position': 'relative',\n      'top': -this.video_height * 2 + 'px'\n    },\n    '#video-flip': {\n      'backface-visibility': 'hidden',\n      'transform': 'rotateY(180deg)'\n    },\n    '#video': {\n      'position': 'absolute',\n      'width': this.video_width - 1 + 'px',\n      'height': this.video_height + 'px',\n      'top': MixpanelNotification.NOTIF_TOP + 'px',\n      'margin-top': '100px',\n      'left': '50%',\n      'margin-left': Math.round(-this.video_width / 2) + 'px',\n      'overflow': 'hidden',\n      'border-radius': '5px',\n      'box-shadow': video_shadow,\n      'transform': 'translateZ(1px)',\n      // webkit rendering bug http://stackoverflow.com/questions/18167981/clickable-link-area-unexpectedly-smaller-after-css-transform\n      'transition': 'opacity ' + anim_seconds + ', top ' + anim_seconds\n    },\n    '#video.exiting': {\n      'opacity': '0.0',\n      'top': this.video_height + 'px'\n    },\n    '#video-holder': {\n      'position': 'absolute',\n      'width': this.video_width - 1 + 'px',\n      'height': this.video_height + 'px',\n      'overflow': 'hidden',\n      'border-radius': '5px'\n    },\n    '#video-frame': {\n      'margin-left': '-1px',\n      'width': this.video_width + 'px'\n    },\n    '#video-controls': {\n      'opacity': '0',\n      'transition': 'opacity 0.5s'\n    },\n    '#video:hover #video-controls': {\n      'opacity': '1.0'\n    },\n    '#video .video-progress-el': {\n      'position': 'absolute',\n      'bottom': '0',\n      'height': '25px',\n      'border-radius': '0 0 0 5px'\n    },\n    '#video-progress': {\n      'width': '90%'\n    },\n    '#video-progress-total': {\n      'width': '100%',\n      'background-color': this.style_vals.bg,\n      'opacity': '0.7'\n    },\n    '#video-elapsed': {\n      'width': '0',\n      'background-color': '#6cb6f5',\n      'opacity': '0.9'\n    },\n    '#video #video-time': {\n      'width': '10%',\n      'right': '0',\n      'font-size': '11px',\n      'line-height': '25px',\n      'color': this.style_vals.text_main,\n      'background-color': '#666',\n      'border-radius': '0 0 5px 0'\n    }\n  }; // IE hacks\n\n  if (this._browser_lte('ie', 8)) {\n    _.extend(notif_styles, {\n      '* html #overlay': {\n        'position': 'absolute'\n      },\n      '* html #bg': {\n        'position': 'absolute'\n      },\n      'html, body': {\n        'height': '100%'\n      }\n    });\n  }\n\n  if (this._browser_lte('ie', 7)) {\n    _.extend(notif_styles, {\n      '#mini #body': {\n        'display': 'inline',\n        'zoom': '1',\n        'border': '1px solid ' + this.style_vals.bg_hover\n      },\n      '#mini #body-text': {\n        'padding': '20px'\n      },\n      '#mini #mini-icon': {\n        'display': 'none'\n      }\n    });\n  } // add vendor-prefixed style rules\n\n\n  var VENDOR_STYLES = ['backface-visibility', 'border-radius', 'box-shadow', 'opacity', 'perspective', 'transform', 'transform-style', 'transition'],\n      VENDOR_PREFIXES = ['khtml', 'moz', 'ms', 'o', 'webkit'];\n\n  for (var selector in notif_styles) {\n    for (var si = 0; si < VENDOR_STYLES.length; si++) {\n      var prop = VENDOR_STYLES[si];\n\n      if (prop in notif_styles[selector]) {\n        var val = notif_styles[selector][prop];\n\n        for (var pi = 0; pi < VENDOR_PREFIXES.length; pi++) {\n          notif_styles[selector]['-' + VENDOR_PREFIXES[pi] + '-' + prop] = val;\n        }\n      }\n    }\n  }\n\n  var inject_styles = function inject_styles(styles, media_queries) {\n    var create_style_text = function create_style_text(style_defs) {\n      var st = '';\n\n      for (var selector in style_defs) {\n        var mp_selector = selector.replace(/#/g, '#' + MixpanelNotification.MARKUP_PREFIX + '-').replace(/\\./g, '.' + MixpanelNotification.MARKUP_PREFIX + '-');\n        st += '\\n' + mp_selector + ' {';\n        var props = style_defs[selector];\n\n        for (var k in props) {\n          st += k + ':' + props[k] + ';';\n        }\n\n        st += '}';\n      }\n\n      return st;\n    };\n\n    var create_media_query_text = function create_media_query_text(mq_defs) {\n      var mqt = '';\n\n      for (var mq in mq_defs) {\n        mqt += '\\n' + mq + ' {' + create_style_text(mq_defs[mq]) + '\\n}';\n      }\n\n      return mqt;\n    };\n\n    var style_text = create_style_text(styles) + create_media_query_text(media_queries),\n        head_el = document.head || document.getElementsByTagName('head')[0] || document.documentElement,\n        style_el = document.createElement('style');\n    head_el.appendChild(style_el);\n    style_el.setAttribute('type', 'text/css');\n\n    if (style_el.styleSheet) {\n      // IE\n      style_el.styleSheet.cssText = style_text;\n    } else {\n      style_el.textContent = style_text;\n    }\n  };\n\n  inject_styles(notif_styles, notif_media_queries);\n};\n\nMixpanelNotification.prototype._init_video = _.safewrap(function () {\n  if (!this.video_url) {\n    return;\n  }\n\n  var self = this; // Youtube iframe API compatibility\n\n  self.yt_custom = 'postMessage' in window;\n  self.dest_url = self.video_url;\n  var youtube_match = self.video_url.match( // http://stackoverflow.com/questions/2936467/parse-youtube-video-id-using-preg-match\n  /(?:youtube(?:-nocookie)?\\.com\\/(?:[^/]+\\/.+\\/|(?:v|e(?:mbed)?)\\/|.*[?&]v=)|youtu\\.be\\/)([^\"&?/ ]{11})/i),\n      vimeo_match = self.video_url.match(/vimeo\\.com\\/.*?(\\d+)/i);\n\n  if (youtube_match) {\n    self.show_video = true;\n    self.youtube_video = youtube_match[1];\n\n    if (self.yt_custom) {\n      window['onYouTubeIframeAPIReady'] = function () {\n        if (self._get_el('video-frame')) {\n          self._yt_video_ready();\n        }\n      }; // load Youtube iframe API; see https://developers.google.com/youtube/iframe_api_reference\n\n\n      var tag = document.createElement('script');\n      tag.src = self.resource_protocol + 'www.youtube.com/iframe_api';\n      var firstScriptTag = document.getElementsByTagName('script')[0];\n      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);\n    }\n  } else if (vimeo_match) {\n    self.show_video = true;\n    self.vimeo_video = vimeo_match[1];\n  } // IE <= 7, FF <= 3: fall through to video link rather than embedded player\n\n\n  if (self._browser_lte('ie', 7) || self._browser_lte('firefox', 3)) {\n    self.show_video = false;\n    self.clickthrough = true;\n  }\n});\nMixpanelNotification.prototype._mark_as_shown = _.safewrap(function () {\n  // click on background to dismiss\n  var self = this;\n\n  _.register_event(self._get_el('bg'), 'click', function () {\n    self.dismiss();\n  });\n\n  var get_style = function get_style(el, style_name) {\n    var styles = {};\n\n    if (document.defaultView && document.defaultView.getComputedStyle) {\n      styles = document.defaultView.getComputedStyle(el, null); // FF3 requires both args\n    } else if (el.currentStyle) {\n      // IE\n      styles = el.currentStyle;\n    }\n\n    return styles[style_name];\n  };\n\n  if (this.campaign_id) {\n    var notif_el = this._get_el('overlay');\n\n    if (notif_el && get_style(notif_el, 'visibility') !== 'hidden' && get_style(notif_el, 'display') !== 'none') {\n      this._mark_delivery();\n    }\n  }\n});\nMixpanelNotification.prototype._mark_delivery = _.safewrap(function (extra_props) {\n  if (!this.marked_as_shown) {\n    this.marked_as_shown = true;\n\n    if (this.campaign_id) {\n      // mark notification shown (local cache)\n      this._get_shown_campaigns()[this.campaign_id] = 1 * new Date();\n      this.persistence.save();\n    } // track delivery\n\n\n    this._track_event('$campaign_delivery', extra_props); // mark notification shown (mixpanel property)\n\n\n    this.mixpanel['people']['append']({\n      '$campaigns': this.campaign_id,\n      '$notifications': {\n        'campaign_id': this.campaign_id,\n        'message_id': this.message_id,\n        'type': 'web',\n        'time': new Date()\n      }\n    });\n  }\n});\n\nMixpanelNotification.prototype._preload_images = function (all_loaded_cb) {\n  var self = this;\n\n  if (this.imgs_to_preload.length === 0) {\n    all_loaded_cb();\n    return;\n  }\n\n  var preloaded_imgs = 0;\n  var img_objs = [];\n\n  var onload = function onload() {\n    preloaded_imgs++;\n\n    if (preloaded_imgs === self.imgs_to_preload.length && all_loaded_cb) {\n      all_loaded_cb();\n      all_loaded_cb = null;\n    }\n  };\n\n  for (var i = 0; i < this.imgs_to_preload.length; i++) {\n    var img = new Image();\n    img.onload = onload;\n    img.src = this.imgs_to_preload[i];\n\n    if (img.complete) {\n      onload();\n    }\n\n    img_objs.push(img);\n  } // IE6/7 doesn't fire onload reliably\n\n\n  if (this._browser_lte('ie', 7)) {\n    setTimeout(function () {\n      var imgs_loaded = true;\n\n      for (i = 0; i < img_objs.length; i++) {\n        if (!img_objs[i].complete) {\n          imgs_loaded = false;\n        }\n      }\n\n      if (imgs_loaded && all_loaded_cb) {\n        all_loaded_cb();\n        all_loaded_cb = null;\n      }\n    }, 500);\n  }\n};\n\nMixpanelNotification.prototype._remove_notification_el = _.safewrap(function () {\n  window.clearInterval(this._video_progress_checker);\n  this.notification_el.style.visibility = 'hidden';\n  this.body_el.removeChild(this.notification_el);\n});\n\nMixpanelNotification.prototype._set_client_config = function () {\n  var get_browser_version = function get_browser_version(browser_ex) {\n    var match = navigator.userAgent.match(browser_ex);\n    return match && match[1];\n  };\n\n  this.browser_versions = {};\n  this.browser_versions['chrome'] = get_browser_version(/Chrome\\/(\\d+)/);\n  this.browser_versions['firefox'] = get_browser_version(/Firefox\\/(\\d+)/);\n  this.browser_versions['ie'] = get_browser_version(/MSIE (\\d+).+/);\n\n  if (!this.browser_versions['ie'] && !window.ActiveXObject && 'ActiveXObject' in window) {\n    this.browser_versions['ie'] = 11;\n  }\n\n  this.body_el = document.body || document.getElementsByTagName('body')[0];\n\n  if (this.body_el) {\n    this.doc_width = Math.max(this.body_el.scrollWidth, document.documentElement.scrollWidth, this.body_el.offsetWidth, document.documentElement.offsetWidth, this.body_el.clientWidth, document.documentElement.clientWidth);\n    this.doc_height = Math.max(this.body_el.scrollHeight, document.documentElement.scrollHeight, this.body_el.offsetHeight, document.documentElement.offsetHeight, this.body_el.clientHeight, document.documentElement.clientHeight);\n  } // detect CSS compatibility\n\n\n  var ie_ver = this.browser_versions['ie'];\n\n  var sample_styles = document.createElement('div').style,\n      is_css_compatible = function is_css_compatible(rule) {\n    if (rule in sample_styles) {\n      return true;\n    }\n\n    if (!ie_ver) {\n      rule = rule[0].toUpperCase() + rule.slice(1);\n      var props = ['O' + rule, 'Webkit' + rule, 'Moz' + rule];\n\n      for (var i = 0; i < props.length; i++) {\n        if (props[i] in sample_styles) {\n          return true;\n        }\n      }\n    }\n\n    return false;\n  };\n\n  this.use_transitions = this.body_el && is_css_compatible('transition') && is_css_compatible('transform');\n  this.flip_animate = (this.browser_versions['chrome'] >= 33 || this.browser_versions['firefox'] >= 15) && this.body_el && is_css_compatible('backfaceVisibility') && is_css_compatible('perspective') && is_css_compatible('transform');\n};\n\nMixpanelNotification.prototype._switch_to_video = _.safewrap(function () {\n  var self = this,\n      anims = [{\n    el: self._get_notification_display_el(),\n    attr: 'opacity',\n    start: 1.0,\n    goal: 0.0\n  }, {\n    el: self._get_notification_display_el(),\n    attr: 'top',\n    start: MixpanelNotification.NOTIF_TOP,\n    goal: -500\n  }, {\n    el: self._get_el('video-noflip'),\n    attr: 'opacity',\n    start: 0.0,\n    goal: 1.0\n  }, {\n    el: self._get_el('video-noflip'),\n    attr: 'top',\n    start: -self.video_height * 2,\n    goal: 0\n  }];\n\n  if (self.mini) {\n    var bg = self._get_el('bg'),\n        overlay = self._get_el('overlay');\n\n    bg.style.width = '100%';\n    bg.style.height = '100%';\n    overlay.style.width = '100%';\n\n    self._add_class(self._get_notification_display_el(), 'exiting');\n\n    self._add_class(bg, 'visible');\n\n    anims.push({\n      el: self._get_el('bg'),\n      attr: 'opacity',\n      start: 0.0,\n      goal: MixpanelNotification.BG_OPACITY\n    });\n  }\n\n  var video_el = self._get_el('video-holder');\n\n  video_el.innerHTML = self.video_iframe;\n\n  var video_ready = function video_ready() {\n    if (window['YT'] && window['YT']['loaded']) {\n      self._yt_video_ready();\n    }\n\n    self.showing_video = true;\n    self._get_notification_display_el().style.visibility = 'hidden';\n  };\n\n  if (self.flip_animate) {\n    self._add_class('flipper', 'flipped');\n\n    setTimeout(video_ready, MixpanelNotification.ANIM_TIME);\n  } else {\n    self._animate_els(anims, MixpanelNotification.ANIM_TIME, video_ready);\n  }\n});\n\nMixpanelNotification.prototype._track_event = function (event_name, properties, cb) {\n  if (this.campaign_id) {\n    properties = properties || {};\n    properties = _.extend(properties, {\n      'campaign_id': this.campaign_id,\n      'message_id': this.message_id,\n      'message_type': 'web_inapp',\n      'message_subtype': this.notif_type\n    });\n    this.mixpanel['track'](event_name, properties, cb);\n  } else if (cb) {\n    cb.call();\n  }\n};\n\nMixpanelNotification.prototype._yt_video_ready = _.safewrap(function () {\n  var self = this;\n\n  if (self.video_inited) {\n    return;\n  }\n\n  self.video_inited = true;\n\n  var progress_bar = self._get_el('video-elapsed'),\n      progress_time = self._get_el('video-time'),\n      progress_el = self._get_el('video-progress');\n\n  new window['YT']['Player'](MixpanelNotification.MARKUP_PREFIX + '-video-frame', {\n    'events': {\n      'onReady': function onReady(event) {\n        var ytplayer = event['target'],\n            video_duration = ytplayer['getDuration'](),\n            pad = function pad(i) {\n          return ('00' + i).slice(-2);\n        },\n            update_video_time = function update_video_time(current_time) {\n          var secs = Math.round(video_duration - current_time),\n              mins = Math.floor(secs / 60),\n              hours = Math.floor(mins / 60);\n          secs -= mins * 60;\n          mins -= hours * 60;\n          progress_time.innerHTML = '-' + (hours ? hours + ':' : '') + pad(mins) + ':' + pad(secs);\n        };\n\n        update_video_time(0);\n        self._video_progress_checker = window.setInterval(function () {\n          var current_time = ytplayer['getCurrentTime']();\n          progress_bar.style.width = current_time / video_duration * 100 + '%';\n          update_video_time(current_time);\n        }, 250);\n\n        _.register_event(progress_el, 'click', function (e) {\n          var clickx = Math.max(0, e.pageX - progress_el.getBoundingClientRect().left);\n          ytplayer['seekTo'](video_duration * clickx / progress_el.clientWidth, true);\n        });\n      }\n    }\n  });\n});\n/**\n * Mixpanel People Object\n * @constructor\n */\n\nvar MixpanelPeople = function MixpanelPeople() {};\n\n_.extend(MixpanelPeople.prototype, apiActions);\n\nMixpanelPeople.prototype._init = function (mixpanel_instance) {\n  this._mixpanel = mixpanel_instance;\n};\n/*\n* Set properties on a user record.\n*\n* ### Usage:\n*\n*     mixpanel.people.set('gender', 'm');\n*\n*     // or set multiple properties at once\n*     mixpanel.people.set({\n*         'Company': 'Acme',\n*         'Plan': 'Premium',\n*         'Upgrade date': new Date()\n*     });\n*     // properties can be strings, integers, dates, or lists\n*\n* @param {Object|String} prop If a string, this is the name of the property. If an object, this is an associative array of names and values.\n* @param {*} [to] A value to set on the given property name\n* @param {Function} [callback] If provided, the callback will be called after tracking the event.\n*/\n\n\nMixpanelPeople.prototype.set = addOptOutCheckMixpanelPeople(function (prop, to, callback) {\n  var data = this.set_action(prop, to);\n\n  if (_.isObject(prop)) {\n    callback = to;\n  } // make sure that the referrer info has been updated and saved\n\n\n  if (this._get_config('save_referrer')) {\n    this._mixpanel['persistence'].update_referrer_info(document.referrer);\n  } // update $set object with default people properties\n\n\n  data[SET_ACTION] = _.extend({}, _.info.people_properties(), this._mixpanel['persistence'].get_referrer_info(), data[SET_ACTION]);\n  return this._send_request(data, callback);\n});\n/*\n* Set properties on a user record, only if they do not yet exist.\n* This will not overwrite previous people property values, unlike\n* people.set().\n*\n* ### Usage:\n*\n*     mixpanel.people.set_once('First Login Date', new Date());\n*\n*     // or set multiple properties at once\n*     mixpanel.people.set_once({\n*         'First Login Date': new Date(),\n*         'Starting Plan': 'Premium'\n*     });\n*\n*     // properties can be strings, integers or dates\n*\n* @param {Object|String} prop If a string, this is the name of the property. If an object, this is an associative array of names and values.\n* @param {*} [to] A value to set on the given property name\n* @param {Function} [callback] If provided, the callback will be called after tracking the event.\n*/\n\nMixpanelPeople.prototype.set_once = addOptOutCheckMixpanelPeople(function (prop, to, callback) {\n  var data = this.set_once_action(prop, to);\n\n  if (_.isObject(prop)) {\n    callback = to;\n  }\n\n  return this._send_request(data, callback);\n});\n/*\n* Unset properties on a user record (permanently removes the properties and their values from a profile).\n*\n* ### Usage:\n*\n*     mixpanel.people.unset('gender');\n*\n*     // or unset multiple properties at once\n*     mixpanel.people.unset(['gender', 'Company']);\n*\n* @param {Array|String} prop If a string, this is the name of the property. If an array, this is a list of property names.\n* @param {Function} [callback] If provided, the callback will be called after tracking the event.\n*/\n\nMixpanelPeople.prototype.unset = addOptOutCheckMixpanelPeople(function (prop, callback) {\n  var data = this.unset_action(prop);\n  return this._send_request(data, callback);\n});\n/*\n* Increment/decrement numeric people analytics properties.\n*\n* ### Usage:\n*\n*     mixpanel.people.increment('page_views', 1);\n*\n*     // or, for convenience, if you're just incrementing a counter by\n*     // 1, you can simply do\n*     mixpanel.people.increment('page_views');\n*\n*     // to decrement a counter, pass a negative number\n*     mixpanel.people.increment('credits_left', -1);\n*\n*     // like mixpanel.people.set(), you can increment multiple\n*     // properties at once:\n*     mixpanel.people.increment({\n*         counter1: 1,\n*         counter2: 6\n*     });\n*\n* @param {Object|String} prop If a string, this is the name of the property. If an object, this is an associative array of names and numeric values.\n* @param {Number} [by] An amount to increment the given property\n* @param {Function} [callback] If provided, the callback will be called after tracking the event.\n*/\n\nMixpanelPeople.prototype.increment = addOptOutCheckMixpanelPeople(function (prop, by, callback) {\n  var data = {};\n  var $add = {};\n\n  if (_.isObject(prop)) {\n    _.each(prop, function (v, k) {\n      if (!this._is_reserved_property(k)) {\n        if (isNaN(parseFloat(v))) {\n          console$1.error('Invalid increment value passed to mixpanel.people.increment - must be a number');\n          return;\n        } else {\n          $add[k] = v;\n        }\n      }\n    }, this);\n\n    callback = by;\n  } else {\n    // convenience: mixpanel.people.increment('property'); will\n    // increment 'property' by 1\n    if (_.isUndefined(by)) {\n      by = 1;\n    }\n\n    $add[prop] = by;\n  }\n\n  data[ADD_ACTION] = $add;\n  return this._send_request(data, callback);\n});\n/*\n* Append a value to a list-valued people analytics property.\n*\n* ### Usage:\n*\n*     // append a value to a list, creating it if needed\n*     mixpanel.people.append('pages_visited', 'homepage');\n*\n*     // like mixpanel.people.set(), you can append multiple\n*     // properties at once:\n*     mixpanel.people.append({\n*         list1: 'bob',\n*         list2: 123\n*     });\n*\n* @param {Object|String} list_name If a string, this is the name of the property. If an object, this is an associative array of names and values.\n* @param {*} [value] value An item to append to the list\n* @param {Function} [callback] If provided, the callback will be called after tracking the event.\n*/\n\nMixpanelPeople.prototype.append = addOptOutCheckMixpanelPeople(function (list_name, value, callback) {\n  if (_.isObject(list_name)) {\n    callback = value;\n  }\n\n  var data = this.append_action(list_name, value);\n  return this._send_request(data, callback);\n});\n/*\n* Remove a value from a list-valued people analytics property.\n*\n* ### Usage:\n*\n*     mixpanel.people.remove('School', 'UCB');\n*\n* @param {Object|String} list_name If a string, this is the name of the property. If an object, this is an associative array of names and values.\n* @param {*} [value] value Item to remove from the list\n* @param {Function} [callback] If provided, the callback will be called after tracking the event.\n*/\n\nMixpanelPeople.prototype.remove = addOptOutCheckMixpanelPeople(function (list_name, value, callback) {\n  if (_.isObject(list_name)) {\n    callback = value;\n  }\n\n  var data = this.remove_action(list_name, value);\n  return this._send_request(data, callback);\n});\n/*\n* Merge a given list with a list-valued people analytics property,\n* excluding duplicate values.\n*\n* ### Usage:\n*\n*     // merge a value to a list, creating it if needed\n*     mixpanel.people.union('pages_visited', 'homepage');\n*\n*     // like mixpanel.people.set(), you can append multiple\n*     // properties at once:\n*     mixpanel.people.union({\n*         list1: 'bob',\n*         list2: 123\n*     });\n*\n*     // like mixpanel.people.append(), you can append multiple\n*     // values to the same list:\n*     mixpanel.people.union({\n*         list1: ['bob', 'billy']\n*     });\n*\n* @param {Object|String} list_name If a string, this is the name of the property. If an object, this is an associative array of names and values.\n* @param {*} [value] Value / values to merge with the given property\n* @param {Function} [callback] If provided, the callback will be called after tracking the event.\n*/\n\nMixpanelPeople.prototype.union = addOptOutCheckMixpanelPeople(function (list_name, values, callback) {\n  if (_.isObject(list_name)) {\n    callback = values;\n  }\n\n  var data = this.union_action(list_name, values);\n  return this._send_request(data, callback);\n});\n/*\n* Record that you have charged the current user a certain amount\n* of money. Charges recorded with track_charge() will appear in the\n* Mixpanel revenue report.\n*\n* ### Usage:\n*\n*     // charge a user $50\n*     mixpanel.people.track_charge(50);\n*\n*     // charge a user $30.50 on the 2nd of january\n*     mixpanel.people.track_charge(30.50, {\n*         '$time': new Date('jan 1 2012')\n*     });\n*\n* @param {Number} amount The amount of money charged to the current user\n* @param {Object} [properties] An associative array of properties associated with the charge\n* @param {Function} [callback] If provided, the callback will be called when the server responds\n*/\n\nMixpanelPeople.prototype.track_charge = addOptOutCheckMixpanelPeople(function (amount, properties, callback) {\n  if (!_.isNumber(amount)) {\n    amount = parseFloat(amount);\n\n    if (isNaN(amount)) {\n      console$1.error('Invalid value passed to mixpanel.people.track_charge - must be a number');\n      return;\n    }\n  }\n\n  return this.append('$transactions', _.extend({\n    '$amount': amount\n  }, properties), callback);\n});\n/*\n* Permanently clear all revenue report transactions from the\n* current user's people analytics profile.\n*\n* ### Usage:\n*\n*     mixpanel.people.clear_charges();\n*\n* @param {Function} [callback] If provided, the callback will be called after tracking the event.\n*/\n\nMixpanelPeople.prototype.clear_charges = function (callback) {\n  return this.set('$transactions', [], callback);\n};\n/*\n* Permanently deletes the current people analytics profile from\n* Mixpanel (using the current distinct_id).\n*\n* ### Usage:\n*\n*     // remove the all data you have stored about the current user\n*     mixpanel.people.delete_user();\n*\n*/\n\n\nMixpanelPeople.prototype.delete_user = function () {\n  if (!this._identify_called()) {\n    console$1.error('mixpanel.people.delete_user() requires you to call identify() first');\n    return;\n  }\n\n  var data = {\n    '$delete': this._mixpanel.get_distinct_id()\n  };\n  return this._send_request(data);\n};\n\nMixpanelPeople.prototype.toString = function () {\n  return this._mixpanel.toString() + '.people';\n};\n\nMixpanelPeople.prototype._send_request = function (data, callback) {\n  data['$token'] = this._get_config('token');\n  data['$distinct_id'] = this._mixpanel.get_distinct_id();\n\n  var device_id = this._mixpanel.get_property('$device_id');\n\n  var user_id = this._mixpanel.get_property('$user_id');\n\n  var had_persisted_distinct_id = this._mixpanel.get_property('$had_persisted_distinct_id');\n\n  if (device_id) {\n    data['$device_id'] = device_id;\n  }\n\n  if (user_id) {\n    data['$user_id'] = user_id;\n  }\n\n  if (had_persisted_distinct_id) {\n    data['$had_persisted_distinct_id'] = had_persisted_distinct_id;\n  }\n\n  var date_encoded_data = _.encodeDates(data);\n\n  var truncated_data = _.truncate(date_encoded_data, 255);\n\n  if (!this._identify_called()) {\n    this._enqueue(data);\n\n    if (!_.isUndefined(callback)) {\n      if (this._get_config('verbose')) {\n        callback({\n          status: -1,\n          error: null\n        });\n      } else {\n        callback(-1);\n      }\n    }\n\n    return truncated_data;\n  }\n\n  return this._mixpanel._track_or_batch({\n    truncated_data: truncated_data,\n    endpoint: this._get_config('api_host') + '/engage/',\n    batcher: this._mixpanel.request_batchers.people\n  }, callback);\n};\n\nMixpanelPeople.prototype._get_config = function (conf_var) {\n  return this._mixpanel.get_config(conf_var);\n};\n\nMixpanelPeople.prototype._identify_called = function () {\n  return this._mixpanel._flags.identify_called === true;\n}; // Queue up engage operations if identify hasn't been called yet.\n\n\nMixpanelPeople.prototype._enqueue = function (data) {\n  if (SET_ACTION in data) {\n    this._mixpanel['persistence']._add_to_people_queue(SET_ACTION, data);\n  } else if (SET_ONCE_ACTION in data) {\n    this._mixpanel['persistence']._add_to_people_queue(SET_ONCE_ACTION, data);\n  } else if (UNSET_ACTION in data) {\n    this._mixpanel['persistence']._add_to_people_queue(UNSET_ACTION, data);\n  } else if (ADD_ACTION in data) {\n    this._mixpanel['persistence']._add_to_people_queue(ADD_ACTION, data);\n  } else if (APPEND_ACTION in data) {\n    this._mixpanel['persistence']._add_to_people_queue(APPEND_ACTION, data);\n  } else if (REMOVE_ACTION in data) {\n    this._mixpanel['persistence']._add_to_people_queue(REMOVE_ACTION, data);\n  } else if (UNION_ACTION in data) {\n    this._mixpanel['persistence']._add_to_people_queue(UNION_ACTION, data);\n  } else {\n    console$1.error('Invalid call to _enqueue():', data);\n  }\n};\n\nMixpanelPeople.prototype._flush_one_queue = function (action, action_method, callback, queue_to_params_fn) {\n  var _this = this;\n\n  var queued_data = _.extend({}, this._mixpanel['persistence']._get_queue(action));\n\n  var action_params = queued_data;\n\n  if (!_.isUndefined(queued_data) && _.isObject(queued_data) && !_.isEmptyObject(queued_data)) {\n    _this._mixpanel['persistence']._pop_from_people_queue(action, queued_data);\n\n    if (queue_to_params_fn) {\n      action_params = queue_to_params_fn(queued_data);\n    }\n\n    action_method.call(_this, action_params, function (response, data) {\n      // on bad response, we want to add it back to the queue\n      if (response === 0) {\n        _this._mixpanel['persistence']._add_to_people_queue(action, queued_data);\n      }\n\n      if (!_.isUndefined(callback)) {\n        callback(response, data);\n      }\n    });\n  }\n}; // Flush queued engage operations - order does not matter,\n// and there are network level race conditions anyway\n\n\nMixpanelPeople.prototype._flush = function (_set_callback, _add_callback, _append_callback, _set_once_callback, _union_callback, _unset_callback, _remove_callback) {\n  var _this = this;\n\n  var $append_queue = this._mixpanel['persistence']._get_queue(APPEND_ACTION);\n\n  var $remove_queue = this._mixpanel['persistence']._get_queue(REMOVE_ACTION);\n\n  this._flush_one_queue(SET_ACTION, this.set, _set_callback);\n\n  this._flush_one_queue(SET_ONCE_ACTION, this.set_once, _set_once_callback);\n\n  this._flush_one_queue(UNSET_ACTION, this.unset, _unset_callback, function (queue) {\n    return _.keys(queue);\n  });\n\n  this._flush_one_queue(ADD_ACTION, this.increment, _add_callback);\n\n  this._flush_one_queue(UNION_ACTION, this.union, _union_callback); // we have to fire off each $append individually since there is\n  // no concat method server side\n\n\n  if (!_.isUndefined($append_queue) && _.isArray($append_queue) && $append_queue.length) {\n    var $append_item;\n\n    var append_callback = function append_callback(response, data) {\n      if (response === 0) {\n        _this._mixpanel['persistence']._add_to_people_queue(APPEND_ACTION, $append_item);\n      }\n\n      if (!_.isUndefined(_append_callback)) {\n        _append_callback(response, data);\n      }\n    };\n\n    for (var i = $append_queue.length - 1; i >= 0; i--) {\n      $append_item = $append_queue.pop();\n\n      if (!_.isEmptyObject($append_item)) {\n        _this.append($append_item, append_callback);\n      }\n    } // Save the shortened append queue\n\n\n    _this._mixpanel['persistence'].save();\n  } // same for $remove\n\n\n  if (!_.isUndefined($remove_queue) && _.isArray($remove_queue) && $remove_queue.length) {\n    var $remove_item;\n\n    var remove_callback = function remove_callback(response, data) {\n      if (response === 0) {\n        _this._mixpanel['persistence']._add_to_people_queue(REMOVE_ACTION, $remove_item);\n      }\n\n      if (!_.isUndefined(_remove_callback)) {\n        _remove_callback(response, data);\n      }\n    };\n\n    for (var j = $remove_queue.length - 1; j >= 0; j--) {\n      $remove_item = $remove_queue.pop();\n\n      if (!_.isEmptyObject($remove_item)) {\n        _this.remove($remove_item, remove_callback);\n      }\n    }\n\n    _this._mixpanel['persistence'].save();\n  }\n};\n\nMixpanelPeople.prototype._is_reserved_property = function (prop) {\n  return prop === '$distinct_id' || prop === '$token' || prop === '$device_id' || prop === '$user_id' || prop === '$had_persisted_distinct_id';\n}; // MixpanelPeople Exports\n\n\nMixpanelPeople.prototype['set'] = MixpanelPeople.prototype.set;\nMixpanelPeople.prototype['set_once'] = MixpanelPeople.prototype.set_once;\nMixpanelPeople.prototype['unset'] = MixpanelPeople.prototype.unset;\nMixpanelPeople.prototype['increment'] = MixpanelPeople.prototype.increment;\nMixpanelPeople.prototype['append'] = MixpanelPeople.prototype.append;\nMixpanelPeople.prototype['remove'] = MixpanelPeople.prototype.remove;\nMixpanelPeople.prototype['union'] = MixpanelPeople.prototype.union;\nMixpanelPeople.prototype['track_charge'] = MixpanelPeople.prototype.track_charge;\nMixpanelPeople.prototype['clear_charges'] = MixpanelPeople.prototype.clear_charges;\nMixpanelPeople.prototype['delete_user'] = MixpanelPeople.prototype.delete_user;\nMixpanelPeople.prototype['toString'] = MixpanelPeople.prototype.toString;\n/*\n * Mixpanel JS Library\n *\n * Copyright 2012, Mixpanel, Inc. All Rights Reserved\n * http://mixpanel.com/\n *\n * Includes portions of Underscore.js\n * http://documentcloud.github.com/underscore/\n * (c) 2011 Jeremy Ashkenas, DocumentCloud Inc.\n * Released under the MIT License.\n */\n// ==ClosureCompiler==\n// @compilation_level ADVANCED_OPTIMIZATIONS\n// @output_file_name mixpanel-2.8.min.js\n// ==/ClosureCompiler==\n\n/*\nSIMPLE STYLE GUIDE:\n\nthis.x === public function\nthis._x === internal - only use within this file\nthis.__x === private - only use within the class\n\nGlobals should be all caps\n*/\n\nvar init_type; // MODULE or SNIPPET loader\n\nvar mixpanel_master; // main mixpanel instance / object\n\nvar INIT_MODULE = 0;\nvar INIT_SNIPPET = 1;\n/** @const */\n\nvar PRIMARY_INSTANCE_NAME = 'mixpanel';\n/*\n * Dynamic... constants? Is that an oxymoron?\n */\n// http://hacks.mozilla.org/2009/07/cross-site-xmlhttprequest-with-cors/\n// https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest#withCredentials\n\nvar USE_XHR = window$1.XMLHttpRequest && 'withCredentials' in new XMLHttpRequest(); // IE<10 does not support cross-origin XHR's but script tags\n// with defer won't block window.onload; ENQUEUE_REQUESTS\n// should only be true for Opera<12\n\nvar ENQUEUE_REQUESTS = !USE_XHR && userAgent.indexOf('MSIE') === -1 && userAgent.indexOf('Mozilla') === -1; // save reference to navigator.sendBeacon so it can be minified\n\nvar sendBeacon = null;\n\nif (navigator$1['sendBeacon']) {\n  sendBeacon = function sendBeacon() {\n    // late reference to navigator.sendBeacon to allow patching/spying\n    return navigator$1['sendBeacon'].apply(navigator$1, arguments);\n  };\n}\n/*\n * Module-level globals\n */\n\n\nvar DEFAULT_CONFIG = {\n  'api_host': 'https://api-js.mixpanel.com',\n  'api_method': 'POST',\n  'api_transport': 'XHR',\n  'app_host': 'https://mixpanel.com',\n  'autotrack': true,\n  'cdn': 'https://cdn.mxpnl.com',\n  'cross_site_cookie': false,\n  'cross_subdomain_cookie': true,\n  'persistence': 'cookie',\n  'persistence_name': '',\n  'cookie_domain': '',\n  'cookie_name': '',\n  'loaded': function loaded() {},\n  'store_google': true,\n  'save_referrer': true,\n  'test': false,\n  'verbose': false,\n  'img': false,\n  'debug': false,\n  'track_links_timeout': 300,\n  'cookie_expiration': 365,\n  'upgrade': false,\n  'disable_persistence': false,\n  'disable_cookie': false,\n  'secure_cookie': false,\n  'ip': true,\n  'opt_out_tracking_by_default': false,\n  'opt_out_persistence_by_default': false,\n  'opt_out_tracking_persistence_type': 'localStorage',\n  'opt_out_tracking_cookie_prefix': null,\n  'property_blacklist': [],\n  'xhr_headers': {},\n  // { header: value, header2: value }\n  'inapp_protocol': '//',\n  'inapp_link_new_window': false,\n  'ignore_dnt': false,\n  'batch_requests': false,\n  // for now\n  'batch_size': 50,\n  'batch_flush_interval_ms': 5000,\n  'batch_request_timeout_ms': 90000\n};\nvar DOM_LOADED = false;\n/**\n * Mixpanel Library Object\n * @constructor\n */\n\nvar MixpanelLib = function MixpanelLib() {};\n/**\n * create_mplib(token:string, config:object, name:string)\n *\n * This function is used by the init method of MixpanelLib objects\n * as well as the main initializer at the end of the JSLib (that\n * initializes document.mixpanel as well as any additional instances\n * declared before this file has loaded).\n */\n\n\nvar create_mplib = function create_mplib(token, config, name) {\n  var instance,\n      target = name === PRIMARY_INSTANCE_NAME ? mixpanel_master : mixpanel_master[name];\n\n  if (target && init_type === INIT_MODULE) {\n    instance = target;\n  } else {\n    if (target && !_.isArray(target)) {\n      console$1.error('You have already initialized ' + name);\n      return;\n    }\n\n    instance = new MixpanelLib();\n  }\n\n  instance._cached_groups = {}; // cache groups in a pool\n\n  instance._user_decide_check_complete = false;\n  instance._events_tracked_before_user_decide_check_complete = [];\n\n  instance._init(token, config, name);\n\n  instance['people'] = new MixpanelPeople();\n\n  instance['people']._init(instance); // if any instance on the page has debug = true, we set the\n  // global debug to be true\n\n\n  Config.DEBUG = Config.DEBUG || instance.get_config('debug');\n  instance['__autotrack_enabled'] = instance.get_config('autotrack');\n\n  if (instance.get_config('autotrack')) {\n    var num_buckets = 100;\n    var num_enabled_buckets = 100;\n\n    if (!autotrack.enabledForProject(instance.get_config('token'), num_buckets, num_enabled_buckets)) {\n      instance['__autotrack_enabled'] = false;\n      console$1.log('Not in active bucket: disabling Automatic Event Collection.');\n    } else if (!autotrack.isBrowserSupported()) {\n      instance['__autotrack_enabled'] = false;\n      console$1.log('Disabling Automatic Event Collection because this browser is not supported');\n    } else {\n      autotrack.init(instance);\n    }\n  } // if target is not defined, we called init after the lib already\n  // loaded, so there won't be an array of things to execute\n\n\n  if (!_.isUndefined(target) && _.isArray(target)) {\n    // Crunch through the people queue first - we queue this data up &\n    // flush on identify, so it's better to do all these operations first\n    instance._execute_array.call(instance['people'], target['people']);\n\n    instance._execute_array(target);\n  }\n\n  return instance;\n};\n\nvar encode_data_for_request = function encode_data_for_request(data) {\n  var json_data = _.JSONEncode(data);\n\n  var encoded_data = _.base64Encode(json_data);\n\n  return {\n    'data': encoded_data\n  };\n}; // Initialization methods\n\n/**\n * This function initializes a new instance of the Mixpanel tracking object.\n * All new instances are added to the main mixpanel object as sub properties (such as\n * mixpanel.library_name) and also returned by this function. To define a\n * second instance on the page, you would call:\n *\n *     mixpanel.init('new token', { your: 'config' }, 'library_name');\n *\n * and use it like so:\n *\n *     mixpanel.library_name.track(...);\n *\n * @param {String} token   Your Mixpanel API token\n * @param {Object} [config]  A dictionary of config options to override. <a href=\"https://github.com/mixpanel/mixpanel-js/blob/8b2e1f7b/src/mixpanel-core.js#L87-L110\">See a list of default config options</a>.\n * @param {String} [name]    The name for the new mixpanel instance that you want created\n */\n\n\nMixpanelLib.prototype.init = function (token, config, name) {\n  if (_.isUndefined(name)) {\n    console$1.error('You must name your new library: init(token, config, name)');\n    return;\n  }\n\n  if (name === PRIMARY_INSTANCE_NAME) {\n    console$1.error('You must initialize the main mixpanel object right after you include the Mixpanel js snippet');\n    return;\n  }\n\n  var instance = create_mplib(token, config, name);\n  mixpanel_master[name] = instance;\n\n  instance._loaded();\n\n  return instance;\n}; // mixpanel._init(token:string, config:object, name:string)\n//\n// This function sets up the current instance of the mixpanel\n// library.  The difference between this method and the init(...)\n// method is this one initializes the actual instance, whereas the\n// init(...) method sets up a new library and calls _init on it.\n//\n\n\nMixpanelLib.prototype._init = function (token, config, name) {\n  config = config || {};\n  this['__loaded'] = true;\n  this['config'] = {};\n  this['_triggered_notifs'] = []; // rollout: enable batch_requests by default for 30% of projects\n  // (only if they have not specified a value in their init config\n  // and they aren't using a custom API host)\n\n  var variable_features = {};\n  var api_host = config['api_host'];\n  var is_custom_api = !!api_host && !api_host.match(/\\.mixpanel\\.com$/);\n\n  if (!('batch_requests' in config) && !is_custom_api && determine_eligibility(token, 'batch', 30)) {\n    variable_features['batch_requests'] = true;\n  }\n\n  this.set_config(_.extend({}, DEFAULT_CONFIG, variable_features, config, {\n    'name': name,\n    'token': token,\n    'callback_fn': (name === PRIMARY_INSTANCE_NAME ? name : PRIMARY_INSTANCE_NAME + '.' + name) + '._jsc'\n  }));\n\n  this['_jsc'] = function () {};\n\n  this.__dom_loaded_queue = [];\n  this.__request_queue = [];\n  this.__disabled_events = [];\n  this._flags = {\n    'disable_all_events': false,\n    'identify_called': false\n  }; // set up request queueing/batching\n\n  this.request_batchers = {};\n  this._batch_requests = this.get_config('batch_requests');\n\n  if (this._batch_requests) {\n    if (!_.localStorage.is_supported(true) || !USE_XHR) {\n      this._batch_requests = false;\n      console$1.log('Turning off Mixpanel request-queueing; needs XHR and localStorage support');\n    } else {\n      this.start_batch_requests();\n\n      if (sendBeacon && window$1.addEventListener) {\n        window$1.addEventListener('unload', _.bind(function () {\n          // Before page closes, attempt to flush any events queued up via navigator.sendBeacon.\n          // Since sendBeacon doesn't report success/failure, events will not be removed from\n          // the persistent store; if the site is loaded again, the events will be flushed again\n          // on startup and deduplicated on the Mixpanel server side.\n          this.request_batchers.events.flush({\n            sendBeacon: true\n          });\n        }, this));\n      }\n    }\n  }\n\n  this['persistence'] = this['cookie'] = new MixpanelPersistence(this['config']);\n\n  this._gdpr_init();\n\n  var uuid = _.UUID();\n\n  if (!this.get_distinct_id()) {\n    // There is no need to set the distinct id\n    // or the device id if something was already stored\n    // in the persitence\n    this.register_once({\n      'distinct_id': uuid,\n      '$device_id': uuid\n    }, '');\n  }\n}; // Private methods\n\n\nMixpanelLib.prototype._loaded = function () {\n  this.get_config('loaded')(this);\n\n  this._set_default_superprops();\n}; // update persistence with info on referrer, UTM params, etc\n\n\nMixpanelLib.prototype._set_default_superprops = function () {\n  this['persistence'].update_search_keyword(document$1.referrer);\n\n  if (this.get_config('store_google')) {\n    this['persistence'].update_campaign_params();\n  }\n\n  if (this.get_config('save_referrer')) {\n    this['persistence'].update_referrer_info(document$1.referrer);\n  }\n};\n\nMixpanelLib.prototype._dom_loaded = function () {\n  _.each(this.__dom_loaded_queue, function (item) {\n    this._track_dom.apply(this, item);\n  }, this);\n\n  if (!this.has_opted_out_tracking()) {\n    _.each(this.__request_queue, function (item) {\n      this._send_request.apply(this, item);\n    }, this);\n  }\n\n  delete this.__dom_loaded_queue;\n  delete this.__request_queue;\n};\n\nMixpanelLib.prototype._track_dom = function (DomClass, args) {\n  if (this.get_config('img')) {\n    console$1.error('You can\\'t use DOM tracking functions with img = true.');\n    return false;\n  }\n\n  if (!DOM_LOADED) {\n    this.__dom_loaded_queue.push([DomClass, args]);\n\n    return false;\n  }\n\n  var dt = new DomClass().init(this);\n  return dt.track.apply(dt, args);\n};\n/**\n * _prepare_callback() should be called by callers of _send_request for use\n * as the callback argument.\n *\n * If there is no callback, this returns null.\n * If we are going to make XHR/XDR requests, this returns a function.\n * If we are going to use script tags, this returns a string to use as the\n * callback GET param.\n */\n\n\nMixpanelLib.prototype._prepare_callback = function (callback, data) {\n  if (_.isUndefined(callback)) {\n    return null;\n  }\n\n  if (USE_XHR) {\n    var callback_function = function callback_function(response) {\n      callback(response, data);\n    };\n\n    return callback_function;\n  } else {\n    // if the user gives us a callback, we store as a random\n    // property on this instances jsc function and update our\n    // callback string to reflect that.\n    var jsc = this['_jsc'];\n    var randomized_cb = '' + Math.floor(Math.random() * 100000000);\n    var callback_string = this.get_config('callback_fn') + '[' + randomized_cb + ']';\n\n    jsc[randomized_cb] = function (response) {\n      delete jsc[randomized_cb];\n      callback(response, data);\n    };\n\n    return callback_string;\n  }\n};\n\nMixpanelLib.prototype._send_request = function (url, data, options, callback) {\n  var succeeded = true;\n\n  if (ENQUEUE_REQUESTS) {\n    this.__request_queue.push(arguments);\n\n    return succeeded;\n  }\n\n  var DEFAULT_OPTIONS = {\n    method: this.get_config('api_method'),\n    transport: this.get_config('api_transport'),\n    verbose: this.get_config('verbose')\n  };\n  var body_data = null;\n\n  if (!callback && (_.isFunction(options) || typeof options === 'string')) {\n    callback = options;\n    options = null;\n  }\n\n  options = _.extend(DEFAULT_OPTIONS, options || {});\n\n  if (!USE_XHR) {\n    options.method = 'GET';\n  }\n\n  var use_post = options.method === 'POST';\n  var use_sendBeacon = sendBeacon && use_post && options.transport.toLowerCase() === 'sendbeacon'; // needed to correctly format responses\n\n  var verbose_mode = options.verbose;\n\n  if (data['verbose']) {\n    verbose_mode = true;\n  }\n\n  if (this.get_config('test')) {\n    data['test'] = 1;\n  }\n\n  if (verbose_mode) {\n    data['verbose'] = 1;\n  }\n\n  if (this.get_config('img')) {\n    data['img'] = 1;\n  }\n\n  if (!USE_XHR) {\n    if (callback) {\n      data['callback'] = callback;\n    } else if (verbose_mode || this.get_config('test')) {\n      // Verbose output (from verbose mode, or an error in test mode) is a json blob,\n      // which by itself is not valid javascript. Without a callback, this verbose output will\n      // cause an error when returned via jsonp, so we force a no-op callback param.\n      // See the ECMA script spec: http://www.ecma-international.org/ecma-262/5.1/#sec-12.4\n      data['callback'] = '(function(){})';\n    }\n  }\n\n  data['ip'] = this.get_config('ip') ? 1 : 0;\n  data['_'] = new Date().getTime().toString();\n\n  if (use_post) {\n    body_data = 'data=' + encodeURIComponent(data['data']);\n    delete data['data'];\n  }\n\n  url += '?' + _.HTTPBuildQuery(data);\n\n  if ('img' in data) {\n    var img = document$1.createElement('img');\n    img.src = url;\n    document$1.body.appendChild(img);\n  } else if (use_sendBeacon) {\n    try {\n      succeeded = sendBeacon(url, body_data);\n    } catch (e) {\n      console$1.error(e);\n      succeeded = false;\n    }\n  } else if (USE_XHR) {\n    try {\n      var req = new XMLHttpRequest();\n      req.open(options.method, url, true);\n      var headers = this.get_config('xhr_headers');\n\n      if (use_post) {\n        headers['Content-Type'] = 'application/x-www-form-urlencoded';\n      }\n\n      _.each(headers, function (headerValue, headerName) {\n        req.setRequestHeader(headerName, headerValue);\n      });\n\n      if (options.timeout_ms && typeof req.timeout !== 'undefined') {\n        req.timeout = options.timeout_ms;\n        var start_time = new Date().getTime();\n      } // send the mp_optout cookie\n      // withCredentials cannot be modified until after calling .open on Android and Mobile Safari\n\n\n      req.withCredentials = true;\n\n      req.onreadystatechange = function () {\n        if (req.readyState === 4) {\n          // XMLHttpRequest.DONE == 4, except in safari 4\n          if (req.status === 200) {\n            if (callback) {\n              if (verbose_mode) {\n                var response;\n\n                try {\n                  response = _.JSONDecode(req.responseText);\n                } catch (e) {\n                  console$1.error(e);\n\n                  if (options.ignore_json_errors) {\n                    response = req.responseText;\n                  } else {\n                    return;\n                  }\n                }\n\n                callback(response);\n              } else {\n                callback(Number(req.responseText));\n              }\n            }\n          } else {\n            var error;\n\n            if (req.timeout && !req.status && new Date().getTime() - start_time >= req.timeout) {\n              error = 'timeout';\n            } else {\n              error = 'Bad HTTP status: ' + req.status + ' ' + req.statusText;\n            }\n\n            console$1.error(error);\n\n            if (callback) {\n              if (verbose_mode) {\n                callback({\n                  status: 0,\n                  error: error,\n                  xhr_req: req\n                });\n              } else {\n                callback(0);\n              }\n            }\n          }\n        }\n      };\n\n      req.send(body_data);\n    } catch (e) {\n      console$1.error(e);\n      succeeded = false;\n    }\n  } else {\n    var script = document$1.createElement('script');\n    script.type = 'text/javascript';\n    script.async = true;\n    script.defer = true;\n    script.src = url;\n    var s = document$1.getElementsByTagName('script')[0];\n    s.parentNode.insertBefore(script, s);\n  }\n\n  return succeeded;\n};\n/**\n * _execute_array() deals with processing any mixpanel function\n * calls that were called before the Mixpanel library were loaded\n * (and are thus stored in an array so they can be called later)\n *\n * Note: we fire off all the mixpanel function calls && user defined\n * functions BEFORE we fire off mixpanel tracking calls. This is so\n * identify/register/set_config calls can properly modify early\n * tracking calls.\n *\n * @param {Array} array\n */\n\n\nMixpanelLib.prototype._execute_array = function (array) {\n  var fn_name,\n      alias_calls = [],\n      other_calls = [],\n      tracking_calls = [];\n\n  _.each(array, function (item) {\n    if (item) {\n      fn_name = item[0];\n\n      if (_.isArray(fn_name)) {\n        tracking_calls.push(item); // chained call e.g. mixpanel.get_group().set()\n      } else if (typeof item === 'function') {\n        item.call(this);\n      } else if (_.isArray(item) && fn_name === 'alias') {\n        alias_calls.push(item);\n      } else if (_.isArray(item) && fn_name.indexOf('track') !== -1 && typeof this[fn_name] === 'function') {\n        tracking_calls.push(item);\n      } else {\n        other_calls.push(item);\n      }\n    }\n  }, this);\n\n  var execute = function execute(calls, context) {\n    _.each(calls, function (item) {\n      if (_.isArray(item[0])) {\n        // chained call\n        var caller = context;\n\n        _.each(item, function (call) {\n          caller = caller[call[0]].apply(caller, call.slice(1));\n        });\n      } else {\n        this[item[0]].apply(this, item.slice(1));\n      }\n    }, context);\n  };\n\n  execute(alias_calls, this);\n  execute(other_calls, this);\n  execute(tracking_calls, this);\n}; // request queueing utils\n\n\nMixpanelLib.prototype.start_batch_requests = function () {\n  var token = this.get_config('token');\n\n  if (!this.request_batchers.events) {\n    // no batchers initialized yet\n    var batcher_config = {\n      libConfig: this['config'],\n      sendRequestFunc: _.bind(function (endpoint, data, options, cb) {\n        this._send_request(this.get_config('api_host') + endpoint, encode_data_for_request(data), options, this._prepare_callback(cb, data));\n      }, this)\n    };\n    this.request_batchers = {\n      events: new RequestBatcher('__mpq_' + token + '_ev', '/track/', batcher_config),\n      people: new RequestBatcher('__mpq_' + token + '_pp', '/engage/', batcher_config),\n      groups: new RequestBatcher('__mpq_' + token + '_gr', '/groups/', batcher_config)\n    };\n  }\n\n  _.each(this.request_batchers, function (batcher) {\n    batcher.start();\n  });\n};\n\nMixpanelLib.prototype.stop_batch_requests = function () {\n  this._batch_requests = false;\n\n  _.each(this.request_batchers, function (batcher) {\n    batcher.stop();\n    batcher.clear();\n  });\n};\n/**\n * push() keeps the standard async-array-push\n * behavior around after the lib is loaded.\n * This is only useful for external integrations that\n * do not wish to rely on our convenience methods\n * (created in the snippet).\n *\n * ### Usage:\n *     mixpanel.push(['register', { a: 'b' }]);\n *\n * @param {Array} item A [function_name, args...] array to be executed\n */\n\n\nMixpanelLib.prototype.push = function (item) {\n  this._execute_array([item]);\n};\n/**\n * Disable events on the Mixpanel object. If passed no arguments,\n * this function disables tracking of any event. If passed an\n * array of event names, those events will be disabled, but other\n * events will continue to be tracked.\n *\n * Note: this function does not stop other mixpanel functions from\n * firing, such as register() or people.set().\n *\n * @param {Array} [events] An array of event names to disable\n */\n\n\nMixpanelLib.prototype.disable = function (events) {\n  if (typeof events === 'undefined') {\n    this._flags.disable_all_events = true;\n  } else {\n    this.__disabled_events = this.__disabled_events.concat(events);\n  }\n}; // internal method for handling track vs batch-enqueue logic\n\n\nMixpanelLib.prototype._track_or_batch = function (options, callback) {\n  var truncated_data = options.truncated_data;\n  var endpoint = options.endpoint;\n  var batcher = options.batcher;\n  var should_send_immediately = options.should_send_immediately;\n  var send_request_options = options.send_request_options || {};\n\n  callback = callback || function () {};\n\n  var request_enqueued_or_initiated = true;\n\n  var send_request_immediately = _.bind(function () {\n    console$1.log('MIXPANEL REQUEST:');\n    console$1.log(truncated_data);\n    return this._send_request(endpoint, encode_data_for_request(truncated_data), send_request_options, this._prepare_callback(callback, truncated_data));\n  }, this);\n\n  if (this._batch_requests && !should_send_immediately) {\n    batcher.enqueue(truncated_data, function (succeeded) {\n      if (succeeded) {\n        callback(1, truncated_data);\n      } else {\n        send_request_immediately();\n      }\n    });\n  } else {\n    request_enqueued_or_initiated = send_request_immediately();\n  }\n\n  return request_enqueued_or_initiated && truncated_data;\n};\n/**\n * Track an event. This is the most important and\n * frequently used Mixpanel function.\n *\n * ### Usage:\n *\n *     // track an event named 'Registered'\n *     mixpanel.track('Registered', {'Gender': 'Male', 'Age': 21});\n *\n *     // track an event using navigator.sendBeacon\n *     mixpanel.track('Left page', {'duration_seconds': 35}, {transport: 'sendBeacon'});\n *\n * To track link clicks or form submissions, see track_links() or track_forms().\n *\n * @param {String} event_name The name of the event. This can be anything the user does - 'Button Click', 'Sign Up', 'Item Purchased', etc.\n * @param {Object} [properties] A set of properties to include with the event you're sending. These describe the user who did the event or details about the event itself.\n * @param {Object} [options] Optional configuration for this track request.\n * @param {String} [options.transport] Transport method for network request ('xhr' or 'sendBeacon').\n * @param {Boolean} [options.send_immediately] Whether to bypass batching/queueing and send track request immediately.\n * @param {Function} [callback] If provided, the callback function will be called after tracking the event.\n * @returns {Boolean|Object} If the tracking request was successfully initiated/queued, an object\n * with the tracking payload sent to the API server is returned; otherwise false.\n */\n\n\nMixpanelLib.prototype.track = addOptOutCheckMixpanelLib(function (event_name, properties, options, callback) {\n  if (!callback && typeof options === 'function') {\n    callback = options;\n    options = null;\n  }\n\n  options = options || {};\n  var transport = options['transport']; // external API, don't minify 'transport' prop\n\n  if (transport) {\n    options.transport = transport; // 'transport' prop name can be minified internally\n  }\n\n  var should_send_immediately = options['send_immediately'];\n\n  if (typeof callback !== 'function') {\n    callback = function callback() {};\n  }\n\n  if (_.isUndefined(event_name)) {\n    console$1.error('No event name provided to mixpanel.track');\n    return;\n  }\n\n  if (this._event_is_disabled(event_name)) {\n    callback(0);\n    return;\n  } // set defaults\n\n\n  properties = properties || {};\n  properties['token'] = this.get_config('token'); // set $duration if time_event was previously called for this event\n\n  var start_timestamp = this['persistence'].remove_event_timer(event_name);\n\n  if (!_.isUndefined(start_timestamp)) {\n    var duration_in_ms = new Date().getTime() - start_timestamp;\n    properties['$duration'] = parseFloat((duration_in_ms / 1000).toFixed(3));\n  }\n\n  this._set_default_superprops(); // note: extend writes to the first object, so lets make sure we\n  // don't write to the persistence properties object and info\n  // properties object by passing in a new object\n  // update properties with pageview info and super-properties\n\n\n  properties = _.extend({}, _.info.properties(), this['persistence'].properties(), properties);\n  var property_blacklist = this.get_config('property_blacklist');\n\n  if (_.isArray(property_blacklist)) {\n    _.each(property_blacklist, function (blacklisted_prop) {\n      delete properties[blacklisted_prop];\n    });\n  } else {\n    console$1.error('Invalid value for property_blacklist config: ' + property_blacklist);\n  }\n\n  var data = {\n    'event': event_name,\n    'properties': properties\n  };\n\n  var ret = this._track_or_batch({\n    truncated_data: _.truncate(data, 255),\n    endpoint: this.get_config('api_host') + '/track/',\n    batcher: this.request_batchers.events,\n    should_send_immediately: should_send_immediately,\n    send_request_options: options\n  }, callback);\n\n  this._check_and_handle_triggered_notifications(data);\n\n  return ret;\n});\n/**\n * Register the current user into one/many groups.\n *\n * ### Usage:\n *\n *      mixpanel.set_group('company', ['mixpanel', 'google']) // an array of IDs\n *      mixpanel.set_group('company', 'mixpanel')\n *      mixpanel.set_group('company', 128746312)\n *\n * @param {String} group_key Group key\n * @param {Array|String|Number} group_ids An array of group IDs, or a singular group ID\n * @param {Function} [callback] If provided, the callback will be called after tracking the event.\n *\n */\n\nMixpanelLib.prototype.set_group = addOptOutCheckMixpanelLib(function (group_key, group_ids, callback) {\n  if (!_.isArray(group_ids)) {\n    group_ids = [group_ids];\n  }\n\n  var prop = {};\n  prop[group_key] = group_ids;\n  this.register(prop);\n  return this['people'].set(group_key, group_ids, callback);\n});\n/**\n * Add a new group for this user.\n *\n * ### Usage:\n *\n *      mixpanel.add_group('company', 'mixpanel')\n *\n * @param {String} group_key Group key\n * @param {*} group_id A valid Mixpanel property type\n * @param {Function} [callback] If provided, the callback will be called after tracking the event.\n */\n\nMixpanelLib.prototype.add_group = addOptOutCheckMixpanelLib(function (group_key, group_id, callback) {\n  var old_values = this.get_property(group_key);\n\n  if (old_values === undefined) {\n    var prop = {};\n    prop[group_key] = [group_id];\n    this.register(prop);\n  } else {\n    if (old_values.indexOf(group_id) === -1) {\n      old_values.push(group_id);\n      this.register(prop);\n    }\n  }\n\n  return this['people'].union(group_key, group_id, callback);\n});\n/**\n * Remove a group from this user.\n *\n * ### Usage:\n *\n *      mixpanel.remove_group('company', 'mixpanel')\n *\n * @param {String} group_key Group key\n * @param {*} group_id A valid Mixpanel property type\n * @param {Function} [callback] If provided, the callback will be called after tracking the event.\n */\n\nMixpanelLib.prototype.remove_group = addOptOutCheckMixpanelLib(function (group_key, group_id, callback) {\n  var old_value = this.get_property(group_key); // if the value doesn't exist, the persistent store is unchanged\n\n  if (old_value !== undefined) {\n    var idx = old_value.indexOf(group_id);\n\n    if (idx > -1) {\n      old_value.splice(idx, 1);\n      this.register({\n        group_key: old_value\n      });\n    }\n\n    if (old_value.length === 0) {\n      this.unregister(group_key);\n    }\n  }\n\n  return this['people'].remove(group_key, group_id, callback);\n});\n/**\n * Track an event with specific groups.\n *\n * ### Usage:\n *\n *      mixpanel.track_with_groups('purchase', {'product': 'iphone'}, {'University': ['UCB', 'UCLA']})\n *\n * @param {String} event_name The name of the event (see `mixpanel.track()`)\n * @param {Object=} properties A set of properties to include with the event you're sending (see `mixpanel.track()`)\n * @param {Object=} groups An object mapping group name keys to one or more values\n * @param {Function} [callback] If provided, the callback will be called after tracking the event.\n */\n\nMixpanelLib.prototype.track_with_groups = addOptOutCheckMixpanelLib(function (event_name, properties, groups, callback) {\n  var tracking_props = _.extend({}, properties || {});\n\n  _.each(groups, function (v, k) {\n    if (v !== null && v !== undefined) {\n      tracking_props[k] = v;\n    }\n  });\n\n  return this.track(event_name, tracking_props, callback);\n});\n\nMixpanelLib.prototype._create_map_key = function (group_key, group_id) {\n  return group_key + '_' + JSON.stringify(group_id);\n};\n\nMixpanelLib.prototype._remove_group_from_cache = function (group_key, group_id) {\n  delete this._cached_groups[this._create_map_key(group_key, group_id)];\n};\n/**\n * Look up reference to a Mixpanel group\n *\n * ### Usage:\n *\n *       mixpanel.get_group(group_key, group_id)\n *\n * @param {String} group_key Group key\n * @param {Object} group_id A valid Mixpanel property type\n * @returns {Object} A MixpanelGroup identifier\n */\n\n\nMixpanelLib.prototype.get_group = function (group_key, group_id) {\n  var map_key = this._create_map_key(group_key, group_id);\n\n  var group = this._cached_groups[map_key];\n\n  if (group === undefined || group._group_key !== group_key || group._group_id !== group_id) {\n    group = new MixpanelGroup();\n\n    group._init(this, group_key, group_id);\n\n    this._cached_groups[map_key] = group;\n  }\n\n  return group;\n};\n/**\n * Track mp_page_view event. This is now ignored by the server.\n *\n * @param {String} [page] The url of the page to record. If you don't include this, it defaults to the current url.\n * @deprecated\n */\n\n\nMixpanelLib.prototype.track_pageview = function (page) {\n  if (_.isUndefined(page)) {\n    page = document$1.location.href;\n  }\n\n  this.track('mp_page_view', _.info.pageviewInfo(page));\n};\n/**\n * Track clicks on a set of document elements. Selector must be a\n * valid query. Elements must exist on the page at the time track_links is called.\n *\n * ### Usage:\n *\n *     // track click for link id #nav\n *     mixpanel.track_links('#nav', 'Clicked Nav Link');\n *\n * ### Notes:\n *\n * This function will wait up to 300 ms for the Mixpanel\n * servers to respond. If they have not responded by that time\n * it will head to the link without ensuring that your event\n * has been tracked.  To configure this timeout please see the\n * set_config() documentation below.\n *\n * If you pass a function in as the properties argument, the\n * function will receive the DOMElement that triggered the\n * event as an argument.  You are expected to return an object\n * from the function; any properties defined on this object\n * will be sent to mixpanel as event properties.\n *\n * @type {Function}\n * @param {Object|String} query A valid DOM query, element or jQuery-esque list\n * @param {String} event_name The name of the event to track\n * @param {Object|Function} [properties] A properties object or function that returns a dictionary of properties when passed a DOMElement\n */\n\n\nMixpanelLib.prototype.track_links = function () {\n  return this._track_dom.call(this, LinkTracker, arguments);\n};\n/**\n * Track form submissions. Selector must be a valid query.\n *\n * ### Usage:\n *\n *     // track submission for form id 'register'\n *     mixpanel.track_forms('#register', 'Created Account');\n *\n * ### Notes:\n *\n * This function will wait up to 300 ms for the mixpanel\n * servers to respond, if they have not responded by that time\n * it will head to the link without ensuring that your event\n * has been tracked.  To configure this timeout please see the\n * set_config() documentation below.\n *\n * If you pass a function in as the properties argument, the\n * function will receive the DOMElement that triggered the\n * event as an argument.  You are expected to return an object\n * from the function; any properties defined on this object\n * will be sent to mixpanel as event properties.\n *\n * @type {Function}\n * @param {Object|String} query A valid DOM query, element or jQuery-esque list\n * @param {String} event_name The name of the event to track\n * @param {Object|Function} [properties] This can be a set of properties, or a function that returns a set of properties after being passed a DOMElement\n */\n\n\nMixpanelLib.prototype.track_forms = function () {\n  return this._track_dom.call(this, FormTracker, arguments);\n};\n/**\n * Time an event by including the time between this call and a\n * later 'track' call for the same event in the properties sent\n * with the event.\n *\n * ### Usage:\n *\n *     // time an event named 'Registered'\n *     mixpanel.time_event('Registered');\n *     mixpanel.track('Registered', {'Gender': 'Male', 'Age': 21});\n *\n * When called for a particular event name, the next track call for that event\n * name will include the elapsed time between the 'time_event' and 'track'\n * calls. This value is stored as seconds in the '$duration' property.\n *\n * @param {String} event_name The name of the event.\n */\n\n\nMixpanelLib.prototype.time_event = function (event_name) {\n  if (_.isUndefined(event_name)) {\n    console$1.error('No event name provided to mixpanel.time_event');\n    return;\n  }\n\n  if (this._event_is_disabled(event_name)) {\n    return;\n  }\n\n  this['persistence'].set_event_timer(event_name, new Date().getTime());\n};\n/**\n * Register a set of super properties, which are included with all\n * events. This will overwrite previous super property values.\n *\n * ### Usage:\n *\n *     // register 'Gender' as a super property\n *     mixpanel.register({'Gender': 'Female'});\n *\n *     // register several super properties when a user signs up\n *     mixpanel.register({\n *         'Email': 'jdoe@example.com',\n *         'Account Type': 'Free'\n *     });\n *\n * @param {Object} properties An associative array of properties to store about the user\n * @param {Number} [days] How many days since the user's last visit to store the super properties\n */\n\n\nMixpanelLib.prototype.register = function (props, days) {\n  this['persistence'].register(props, days);\n};\n/**\n * Register a set of super properties only once. This will not\n * overwrite previous super property values, unlike register().\n *\n * ### Usage:\n *\n *     // register a super property for the first time only\n *     mixpanel.register_once({\n *         'First Login Date': new Date().toISOString()\n *     });\n *\n * ### Notes:\n *\n * If default_value is specified, current super properties\n * with that value will be overwritten.\n *\n * @param {Object} properties An associative array of properties to store about the user\n * @param {*} [default_value] Value to override if already set in super properties (ex: 'False') Default: 'None'\n * @param {Number} [days] How many days since the users last visit to store the super properties\n */\n\n\nMixpanelLib.prototype.register_once = function (props, default_value, days) {\n  this['persistence'].register_once(props, default_value, days);\n};\n/**\n * Delete a super property stored with the current user.\n *\n * @param {String} property The name of the super property to remove\n */\n\n\nMixpanelLib.prototype.unregister = function (property) {\n  this['persistence'].unregister(property);\n};\n\nMixpanelLib.prototype._register_single = function (prop, value) {\n  var props = {};\n  props[prop] = value;\n  this.register(props);\n};\n/**\n * Identify a user with a unique ID to track user activity across\n * devices, tie a user to their events, and create a user profile.\n * If you never call this method, unique visitors are tracked using\n * a UUID generated the first time they visit the site.\n *\n * Call identify when you know the identity of the current user,\n * typically after login or signup. We recommend against using\n * identify for anonymous visitors to your site.\n *\n * ### Notes:\n * If your project has\n * <a href=\"https://help.mixpanel.com/hc/en-us/articles/360039133851\">ID Merge</a>\n * enabled, the identify method will connect pre- and\n * post-authentication events when appropriate.\n *\n * If your project does not have ID Merge enabled, identify will\n * change the user's local distinct_id to the unique ID you pass.\n * Events tracked prior to authentication will not be connected\n * to the same user identity. If ID Merge is disabled, alias can\n * be used to connect pre- and post-registration events.\n *\n * @param {String} [unique_id] A string that uniquely identifies a user. If not provided, the distinct_id currently in the persistent store (cookie or localStorage) will be used.\n */\n\n\nMixpanelLib.prototype.identify = function (new_distinct_id, _set_callback, _add_callback, _append_callback, _set_once_callback, _union_callback, _unset_callback, _remove_callback) {\n  // Optional Parameters\n  //  _set_callback:function  A callback to be run if and when the People set queue is flushed\n  //  _add_callback:function  A callback to be run if and when the People add queue is flushed\n  //  _append_callback:function  A callback to be run if and when the People append queue is flushed\n  //  _set_once_callback:function  A callback to be run if and when the People set_once queue is flushed\n  //  _union_callback:function  A callback to be run if and when the People union queue is flushed\n  //  _unset_callback:function  A callback to be run if and when the People unset queue is flushed\n  var previous_distinct_id = this.get_distinct_id();\n  this.register({\n    '$user_id': new_distinct_id\n  });\n\n  if (!this.get_property('$device_id')) {\n    // The persisted distinct id might not actually be a device id at all\n    // it might be a distinct id of the user from before\n    var device_id = previous_distinct_id;\n    this.register_once({\n      '$had_persisted_distinct_id': true,\n      '$device_id': device_id\n    }, '');\n  } // identify only changes the distinct id if it doesn't match either the existing or the alias;\n  // if it's new, blow away the alias as well.\n\n\n  if (new_distinct_id !== previous_distinct_id && new_distinct_id !== this.get_property(ALIAS_ID_KEY)) {\n    this.unregister(ALIAS_ID_KEY);\n    this.register({\n      'distinct_id': new_distinct_id\n    });\n  }\n\n  this._check_and_handle_notifications(this.get_distinct_id());\n\n  this._flags.identify_called = true; // Flush any queued up people requests\n\n  this['people']._flush(_set_callback, _add_callback, _append_callback, _set_once_callback, _union_callback, _unset_callback, _remove_callback); // send an $identify event any time the distinct_id is changing - logic on the server\n  // will determine whether or not to do anything with it.\n\n\n  if (new_distinct_id !== previous_distinct_id) {\n    this.track('$identify', {\n      'distinct_id': new_distinct_id,\n      '$anon_distinct_id': previous_distinct_id\n    });\n  }\n};\n/**\n * Clears super properties and generates a new random distinct_id for this instance.\n * Useful for clearing data when a user logs out.\n */\n\n\nMixpanelLib.prototype.reset = function () {\n  this['persistence'].clear();\n  this._flags.identify_called = false;\n\n  var uuid = _.UUID();\n\n  this.register_once({\n    'distinct_id': uuid,\n    '$device_id': uuid\n  }, '');\n};\n/**\n * Returns the current distinct id of the user. This is either the id automatically\n * generated by the library or the id that has been passed by a call to identify().\n *\n * ### Notes:\n *\n * get_distinct_id() can only be called after the Mixpanel library has finished loading.\n * init() has a loaded function available to handle this automatically. For example:\n *\n *     // set distinct_id after the mixpanel library has loaded\n *     mixpanel.init('YOUR PROJECT TOKEN', {\n *         loaded: function(mixpanel) {\n *             distinct_id = mixpanel.get_distinct_id();\n *         }\n *     });\n */\n\n\nMixpanelLib.prototype.get_distinct_id = function () {\n  return this.get_property('distinct_id');\n};\n/**\n * The alias method creates an alias which Mixpanel will use to\n * remap one id to another. Multiple aliases can point to the\n * same identifier.\n *\n * The following is a valid use of alias:\n *\n *     mixpanel.alias('new_id', 'existing_id');\n *     // You can add multiple id aliases to the existing ID\n *     mixpanel.alias('newer_id', 'existing_id');\n *\n * Aliases can also be chained - the following is a valid example:\n *\n *     mixpanel.alias('new_id', 'existing_id');\n *     // chain newer_id - new_id - existing_id\n *     mixpanel.alias('newer_id', 'new_id');\n *\n * Aliases cannot point to multiple identifiers - the following\n * example will not work:\n *\n *     mixpanel.alias('new_id', 'existing_id');\n *     // this is invalid as 'new_id' already points to 'existing_id'\n *     mixpanel.alias('new_id', 'newer_id');\n *\n * ### Notes:\n *\n * If your project does not have\n * <a href=\"https://help.mixpanel.com/hc/en-us/articles/360039133851\">ID Merge</a>\n * enabled, the best practice is to call alias once when a unique\n * ID is first created for a user (e.g., when a user first registers\n * for an account). Do not use alias multiple times for a single\n * user without ID Merge enabled.\n *\n * @param {String} alias A unique identifier that you want to use for this user in the future.\n * @param {String} [original] The current identifier being used for this user.\n */\n\n\nMixpanelLib.prototype.alias = function (alias, original) {\n  // If the $people_distinct_id key exists in persistence, there has been a previous\n  // mixpanel.people.identify() call made for this user. It is VERY BAD to make an alias with\n  // this ID, as it will duplicate users.\n  if (alias === this.get_property(PEOPLE_DISTINCT_ID_KEY)) {\n    console$1.critical('Attempting to create alias for existing People user - aborting.');\n    return -2;\n  }\n\n  var _this = this;\n\n  if (_.isUndefined(original)) {\n    original = this.get_distinct_id();\n  }\n\n  if (alias !== original) {\n    this._register_single(ALIAS_ID_KEY, alias);\n\n    return this.track('$create_alias', {\n      'alias': alias,\n      'distinct_id': original\n    }, function () {\n      // Flush the people queue\n      _this.identify(alias);\n    });\n  } else {\n    console$1.error('alias matches current distinct_id - skipping api call.');\n    this.identify(alias);\n    return -1;\n  }\n};\n/**\n * Provide a string to recognize the user by. The string passed to\n * this method will appear in the Mixpanel Streams product rather\n * than an automatically generated name. Name tags do not have to\n * be unique.\n *\n * This value will only be included in Streams data.\n *\n * @param {String} name_tag A human readable name for the user\n * @deprecated\n */\n\n\nMixpanelLib.prototype.name_tag = function (name_tag) {\n  this._register_single('mp_name_tag', name_tag);\n};\n/**\n * Update the configuration of a mixpanel library instance.\n *\n * The default config is:\n *\n *     {\n *       // HTTP method for tracking requests\n *       api_method: 'POST'\n *\n *       // transport for sending requests ('XHR' or 'sendBeacon')\n *       // NB: sendBeacon should only be used for scenarios such as\n *       // page unload where a \"best-effort\" attempt to send is\n *       // acceptable; the sendBeacon API does not support callbacks\n *       // or any way to know the result of the request. Mixpanel\n *       // tracking via sendBeacon will not support any event-\n *       // batching or retry mechanisms.\n *       api_transport: 'XHR'\n *\n *       // turn on request-batching/queueing/retry\n *       batch_requests: false,\n *\n *       // maximum number of events/updates to send in a single\n *       // network request\n *       batch_size: 50,\n *\n *       // milliseconds to wait between sending batch requests\n *       batch_flush_interval_ms: 5000,\n *\n *       // milliseconds to wait for network responses to batch requests\n *       // before they are considered timed-out and retried\n *       batch_request_timeout_ms: 90000,\n *\n *       // override value for cookie domain, only useful for ensuring\n *       // correct cross-subdomain cookies on unusual domains like\n *       // subdomain.mainsite.avocat.fr; NB this cannot be used to\n *       // set cookies on a different domain than the current origin\n *       cookie_domain: ''\n *\n *       // super properties cookie expiration (in days)\n *       cookie_expiration: 365\n *\n *       // if true, cookie will be set with SameSite=None; Secure\n *       // this is only useful in special situations, like embedded\n *       // 3rd-party iframes that set up a Mixpanel instance\n *       cross_site_cookie: false\n *\n *       // super properties span subdomains\n *       cross_subdomain_cookie: true\n *\n *       // debug mode\n *       debug: false\n *\n *       // if this is true, the mixpanel cookie or localStorage entry\n *       // will be deleted, and no user persistence will take place\n *       disable_persistence: false\n *\n *       // if this is true, Mixpanel will automatically determine\n *       // City, Region and Country data using the IP address of\n *       //the client\n *       ip: true\n *\n *       // opt users out of tracking by this Mixpanel instance by default\n *       opt_out_tracking_by_default: false\n *\n *       // opt users out of browser data storage by this Mixpanel instance by default\n *       opt_out_persistence_by_default: false\n *\n *       // persistence mechanism used by opt-in/opt-out methods - cookie\n *       // or localStorage - falls back to cookie if localStorage is unavailable\n *       opt_out_tracking_persistence_type: 'localStorage'\n *\n *       // customize the name of cookie/localStorage set by opt-in/opt-out methods\n *       opt_out_tracking_cookie_prefix: null\n *\n *       // type of persistent store for super properties (cookie/\n *       // localStorage) if set to 'localStorage', any existing\n *       // mixpanel cookie value with the same persistence_name\n *       // will be transferred to localStorage and deleted\n *       persistence: 'cookie'\n *\n *       // name for super properties persistent store\n *       persistence_name: ''\n *\n *       // names of properties/superproperties which should never\n *       // be sent with track() calls\n *       property_blacklist: []\n *\n *       // if this is true, mixpanel cookies will be marked as\n *       // secure, meaning they will only be transmitted over https\n *       secure_cookie: false\n *\n *       // the amount of time track_links will\n *       // wait for Mixpanel's servers to respond\n *       track_links_timeout: 300\n *\n *       // if you set upgrade to be true, the library will check for\n *       // a cookie from our old js library and import super\n *       // properties from it, then the old cookie is deleted\n *       // The upgrade config option only works in the initialization,\n *       // so make sure you set it when you create the library.\n *       upgrade: false\n *\n *       // extra HTTP request headers to set for each API request, in\n *       // the format {'Header-Name': value}\n *       xhr_headers: {}\n *\n *       // protocol for fetching in-app message resources, e.g.\n *       // 'https://' or 'http://'; defaults to '//' (which defers to the\n *       // current page's protocol)\n *       inapp_protocol: '//'\n *\n *       // whether to open in-app message link in new tab/window\n *       inapp_link_new_window: false\n *\n *       // whether to ignore or respect the web browser's Do Not Track setting\n *       ignore_dnt: false\n *     }\n *\n *\n * @param {Object} config A dictionary of new configuration values to update\n */\n\n\nMixpanelLib.prototype.set_config = function (config) {\n  if (_.isObject(config)) {\n    _.extend(this['config'], config);\n\n    var new_batch_size = config['batch_size'];\n\n    if (new_batch_size) {\n      _.each(this.request_batchers, function (batcher) {\n        batcher.resetBatchSize();\n      });\n    }\n\n    if (!this.get_config('persistence_name')) {\n      this['config']['persistence_name'] = this['config']['cookie_name'];\n    }\n\n    if (!this.get_config('disable_persistence')) {\n      this['config']['disable_persistence'] = this['config']['disable_cookie'];\n    }\n\n    if (this['persistence']) {\n      this['persistence'].update_config(this['config']);\n    }\n\n    Config.DEBUG = Config.DEBUG || this.get_config('debug');\n  }\n};\n/**\n * returns the current config object for the library.\n */\n\n\nMixpanelLib.prototype.get_config = function (prop_name) {\n  return this['config'][prop_name];\n};\n/**\n * Returns the value of the super property named property_name. If no such\n * property is set, get_property() will return the undefined value.\n *\n * ### Notes:\n *\n * get_property() can only be called after the Mixpanel library has finished loading.\n * init() has a loaded function available to handle this automatically. For example:\n *\n *     // grab value for 'user_id' after the mixpanel library has loaded\n *     mixpanel.init('YOUR PROJECT TOKEN', {\n *         loaded: function(mixpanel) {\n *             user_id = mixpanel.get_property('user_id');\n *         }\n *     });\n *\n * @param {String} property_name The name of the super property you want to retrieve\n */\n\n\nMixpanelLib.prototype.get_property = function (property_name) {\n  return this['persistence']['props'][property_name];\n};\n\nMixpanelLib.prototype.toString = function () {\n  var name = this.get_config('name');\n\n  if (name !== PRIMARY_INSTANCE_NAME) {\n    name = PRIMARY_INSTANCE_NAME + '.' + name;\n  }\n\n  return name;\n};\n\nMixpanelLib.prototype._event_is_disabled = function (event_name) {\n  return _.isBlockedUA(userAgent) || this._flags.disable_all_events || _.include(this.__disabled_events, event_name);\n};\n\nMixpanelLib.prototype._check_and_handle_triggered_notifications = addOptOutCheckMixpanelLib(function (event_data) {\n  if (!this._user_decide_check_complete) {\n    this._events_tracked_before_user_decide_check_complete.push(event_data);\n  } else {\n    var arr = this['_triggered_notifs'];\n\n    for (var i = 0; i < arr.length; i++) {\n      var notif = new MixpanelNotification(arr[i], this);\n\n      if (notif._matches_event_data(event_data)) {\n        this._show_notification(arr[i]);\n\n        return;\n      }\n    }\n  }\n});\nMixpanelLib.prototype._check_and_handle_notifications = addOptOutCheckMixpanelLib(function (distinct_id) {\n  if (!distinct_id || this._flags.identify_called || this.get_config('disable_notifications')) {\n    return;\n  }\n\n  console$1.log('MIXPANEL NOTIFICATION CHECK');\n  var data = {\n    'verbose': true,\n    'version': '3',\n    'lib': 'web',\n    'token': this.get_config('token'),\n    'distinct_id': distinct_id\n  };\n\n  this._send_request(this.get_config('api_host') + '/decide/', data, {\n    method: 'GET',\n    transport: 'XHR'\n  }, this._prepare_callback(_.bind(function (result) {\n    if (result['notifications'] && result['notifications'].length > 0) {\n      this['_triggered_notifs'] = [];\n      var notifications = [];\n\n      _.each(result['notifications'], function (notif) {\n        (notif['display_triggers'] && notif['display_triggers'].length > 0 ? this['_triggered_notifs'] : notifications).push(notif);\n      }, this);\n\n      if (notifications.length > 0) {\n        this._show_notification.call(this, notifications[0]);\n      }\n    }\n\n    this._handle_user_decide_check_complete();\n  }, this)));\n});\n\nMixpanelLib.prototype._handle_user_decide_check_complete = function () {\n  this._user_decide_check_complete = true; // check notifications against events that were tracked before decide call completed\n\n  var events = this._events_tracked_before_user_decide_check_complete;\n\n  while (events.length > 0) {\n    var data = events.shift(); // replay in the same order they came in\n\n    this._check_and_handle_triggered_notifications(data);\n  }\n};\n\nMixpanelLib.prototype._show_notification = function (notif_data) {\n  var notification = new MixpanelNotification(notif_data, this);\n  notification.show();\n}; // perform some housekeeping around GDPR opt-in/out state\n\n\nMixpanelLib.prototype._gdpr_init = function () {\n  var is_localStorage_requested = this.get_config('opt_out_tracking_persistence_type') === 'localStorage'; // try to convert opt-in/out cookies to localStorage if possible\n\n  if (is_localStorage_requested && _.localStorage.is_supported()) {\n    if (!this.has_opted_in_tracking() && this.has_opted_in_tracking({\n      'persistence_type': 'cookie'\n    })) {\n      this.opt_in_tracking({\n        'enable_persistence': false\n      });\n    }\n\n    if (!this.has_opted_out_tracking() && this.has_opted_out_tracking({\n      'persistence_type': 'cookie'\n    })) {\n      this.opt_out_tracking({\n        'clear_persistence': false\n      });\n    }\n\n    this.clear_opt_in_out_tracking({\n      'persistence_type': 'cookie',\n      'enable_persistence': false\n    });\n  } // check whether the user has already opted out - if so, clear & disable persistence\n\n\n  if (this.has_opted_out_tracking()) {\n    this._gdpr_update_persistence({\n      'clear_persistence': true\n    }); // check whether we should opt out by default\n    // note: we don't clear persistence here by default since opt-out default state is often\n    //       used as an initial state while GDPR information is being collected\n\n  } else if (!this.has_opted_in_tracking() && (this.get_config('opt_out_tracking_by_default') || _.cookie.get('mp_optout'))) {\n    _.cookie.remove('mp_optout');\n\n    this.opt_out_tracking({\n      'clear_persistence': this.get_config('opt_out_persistence_by_default')\n    });\n  }\n};\n/**\n * Enable or disable persistence based on options\n * only enable/disable if persistence is not already in this state\n * @param {boolean} [options.clear_persistence] If true, will delete all data stored by the sdk in persistence and disable it\n * @param {boolean} [options.enable_persistence] If true, will re-enable sdk persistence\n */\n\n\nMixpanelLib.prototype._gdpr_update_persistence = function (options) {\n  var disabled;\n\n  if (options && options['clear_persistence']) {\n    disabled = true;\n  } else if (options && options['enable_persistence']) {\n    disabled = false;\n  } else {\n    return;\n  }\n\n  if (!this.get_config('disable_persistence') && this['persistence'].disabled !== disabled) {\n    this['persistence'].set_disabled(disabled);\n  }\n\n  if (disabled) {\n    _.each(this.request_batchers, function (batcher) {\n      batcher.clear();\n    });\n  }\n}; // call a base gdpr function after constructing the appropriate token and options args\n\n\nMixpanelLib.prototype._gdpr_call_func = function (func, options) {\n  options = _.extend({\n    'track': _.bind(this.track, this),\n    'persistence_type': this.get_config('opt_out_tracking_persistence_type'),\n    'cookie_prefix': this.get_config('opt_out_tracking_cookie_prefix'),\n    'cookie_expiration': this.get_config('cookie_expiration'),\n    'cross_site_cookie': this.get_config('cross_site_cookie'),\n    'cross_subdomain_cookie': this.get_config('cross_subdomain_cookie'),\n    'cookie_domain': this.get_config('cookie_domain'),\n    'secure_cookie': this.get_config('secure_cookie'),\n    'ignore_dnt': this.get_config('ignore_dnt')\n  }, options); // check if localStorage can be used for recording opt out status, fall back to cookie if not\n\n  if (!_.localStorage.is_supported()) {\n    options['persistence_type'] = 'cookie';\n  }\n\n  return func(this.get_config('token'), {\n    track: options['track'],\n    trackEventName: options['track_event_name'],\n    trackProperties: options['track_properties'],\n    persistenceType: options['persistence_type'],\n    persistencePrefix: options['cookie_prefix'],\n    cookieDomain: options['cookie_domain'],\n    cookieExpiration: options['cookie_expiration'],\n    crossSiteCookie: options['cross_site_cookie'],\n    crossSubdomainCookie: options['cross_subdomain_cookie'],\n    secureCookie: options['secure_cookie'],\n    ignoreDnt: options['ignore_dnt']\n  });\n};\n/**\n * Opt the user in to data tracking and cookies/localstorage for this Mixpanel instance\n *\n * ### Usage\n *\n *     // opt user in\n *     mixpanel.opt_in_tracking();\n *\n *     // opt user in with specific event name, properties, cookie configuration\n *     mixpanel.opt_in_tracking({\n *         track_event_name: 'User opted in',\n *         track_event_properties: {\n *             'Email': 'jdoe@example.com'\n *         },\n *         cookie_expiration: 30,\n *         secure_cookie: true\n *     });\n *\n * @param {Object} [options] A dictionary of config options to override\n * @param {function} [options.track] Function used for tracking a Mixpanel event to record the opt-in action (default is this Mixpanel instance's track method)\n * @param {string} [options.track_event_name=$opt_in] Event name to be used for tracking the opt-in action\n * @param {Object} [options.track_properties] Set of properties to be tracked along with the opt-in action\n * @param {boolean} [options.enable_persistence=true] If true, will re-enable sdk persistence\n * @param {string} [options.persistence_type=localStorage] Persistence mechanism used - cookie or localStorage - falls back to cookie if localStorage is unavailable\n * @param {string} [options.cookie_prefix=__mp_opt_in_out] Custom prefix to be used in the cookie/localstorage name\n * @param {Number} [options.cookie_expiration] Number of days until the opt-in cookie expires (overrides value specified in this Mixpanel instance's config)\n * @param {string} [options.cookie_domain] Custom cookie domain (overrides value specified in this Mixpanel instance's config)\n * @param {boolean} [options.cross_site_cookie] Whether the opt-in cookie is set as cross-site-enabled (overrides value specified in this Mixpanel instance's config)\n * @param {boolean} [options.cross_subdomain_cookie] Whether the opt-in cookie is set as cross-subdomain or not (overrides value specified in this Mixpanel instance's config)\n * @param {boolean} [options.secure_cookie] Whether the opt-in cookie is set as secure or not (overrides value specified in this Mixpanel instance's config)\n */\n\n\nMixpanelLib.prototype.opt_in_tracking = function (options) {\n  options = _.extend({\n    'enable_persistence': true\n  }, options);\n\n  this._gdpr_call_func(optIn, options);\n\n  this._gdpr_update_persistence(options);\n};\n/**\n * Opt the user out of data tracking and cookies/localstorage for this Mixpanel instance\n *\n * ### Usage\n *\n *     // opt user out\n *     mixpanel.opt_out_tracking();\n *\n *     // opt user out with different cookie configuration from Mixpanel instance\n *     mixpanel.opt_out_tracking({\n *         cookie_expiration: 30,\n *         secure_cookie: true\n *     });\n *\n * @param {Object} [options] A dictionary of config options to override\n * @param {boolean} [options.delete_user=true] If true, will delete the currently identified user's profile and clear all charges after opting the user out\n * @param {boolean} [options.clear_persistence=true] If true, will delete all data stored by the sdk in persistence\n * @param {string} [options.persistence_type=localStorage] Persistence mechanism used - cookie or localStorage - falls back to cookie if localStorage is unavailable\n * @param {string} [options.cookie_prefix=__mp_opt_in_out] Custom prefix to be used in the cookie/localstorage name\n * @param {Number} [options.cookie_expiration] Number of days until the opt-in cookie expires (overrides value specified in this Mixpanel instance's config)\n * @param {string} [options.cookie_domain] Custom cookie domain (overrides value specified in this Mixpanel instance's config)\n * @param {boolean} [options.cross_site_cookie] Whether the opt-in cookie is set as cross-site-enabled (overrides value specified in this Mixpanel instance's config)\n * @param {boolean} [options.cross_subdomain_cookie] Whether the opt-in cookie is set as cross-subdomain or not (overrides value specified in this Mixpanel instance's config)\n * @param {boolean} [options.secure_cookie] Whether the opt-in cookie is set as secure or not (overrides value specified in this Mixpanel instance's config)\n */\n\n\nMixpanelLib.prototype.opt_out_tracking = function (options) {\n  options = _.extend({\n    'clear_persistence': true,\n    'delete_user': true\n  }, options); // delete user and clear charges since these methods may be disabled by opt-out\n\n  if (options['delete_user'] && this['people'] && this['people']._identify_called()) {\n    this['people'].delete_user();\n    this['people'].clear_charges();\n  }\n\n  this._gdpr_call_func(optOut, options);\n\n  this._gdpr_update_persistence(options);\n};\n/**\n * Check whether the user has opted in to data tracking and cookies/localstorage for this Mixpanel instance\n *\n * ### Usage\n *\n *     var has_opted_in = mixpanel.has_opted_in_tracking();\n *     // use has_opted_in value\n *\n * @param {Object} [options] A dictionary of config options to override\n * @param {string} [options.persistence_type=localStorage] Persistence mechanism used - cookie or localStorage - falls back to cookie if localStorage is unavailable\n * @param {string} [options.cookie_prefix=__mp_opt_in_out] Custom prefix to be used in the cookie/localstorage name\n * @returns {boolean} current opt-in status\n */\n\n\nMixpanelLib.prototype.has_opted_in_tracking = function (options) {\n  return this._gdpr_call_func(hasOptedIn, options);\n};\n/**\n * Check whether the user has opted out of data tracking and cookies/localstorage for this Mixpanel instance\n *\n * ### Usage\n *\n *     var has_opted_out = mixpanel.has_opted_out_tracking();\n *     // use has_opted_out value\n *\n * @param {Object} [options] A dictionary of config options to override\n * @param {string} [options.persistence_type=localStorage] Persistence mechanism used - cookie or localStorage - falls back to cookie if localStorage is unavailable\n * @param {string} [options.cookie_prefix=__mp_opt_in_out] Custom prefix to be used in the cookie/localstorage name\n * @returns {boolean} current opt-out status\n */\n\n\nMixpanelLib.prototype.has_opted_out_tracking = function (options) {\n  return this._gdpr_call_func(hasOptedOut, options);\n};\n/**\n * Clear the user's opt in/out status of data tracking and cookies/localstorage for this Mixpanel instance\n *\n * ### Usage\n *\n *     // clear user's opt-in/out status\n *     mixpanel.clear_opt_in_out_tracking();\n *\n *     // clear user's opt-in/out status with specific cookie configuration - should match\n *     // configuration used when opt_in_tracking/opt_out_tracking methods were called.\n *     mixpanel.clear_opt_in_out_tracking({\n *         cookie_expiration: 30,\n *         secure_cookie: true\n *     });\n *\n * @param {Object} [options] A dictionary of config options to override\n * @param {boolean} [options.enable_persistence=true] If true, will re-enable sdk persistence\n * @param {string} [options.persistence_type=localStorage] Persistence mechanism used - cookie or localStorage - falls back to cookie if localStorage is unavailable\n * @param {string} [options.cookie_prefix=__mp_opt_in_out] Custom prefix to be used in the cookie/localstorage name\n * @param {Number} [options.cookie_expiration] Number of days until the opt-in cookie expires (overrides value specified in this Mixpanel instance's config)\n * @param {string} [options.cookie_domain] Custom cookie domain (overrides value specified in this Mixpanel instance's config)\n * @param {boolean} [options.cross_site_cookie] Whether the opt-in cookie is set as cross-site-enabled (overrides value specified in this Mixpanel instance's config)\n * @param {boolean} [options.cross_subdomain_cookie] Whether the opt-in cookie is set as cross-subdomain or not (overrides value specified in this Mixpanel instance's config)\n * @param {boolean} [options.secure_cookie] Whether the opt-in cookie is set as secure or not (overrides value specified in this Mixpanel instance's config)\n */\n\n\nMixpanelLib.prototype.clear_opt_in_out_tracking = function (options) {\n  options = _.extend({\n    'enable_persistence': true\n  }, options);\n\n  this._gdpr_call_func(clearOptInOut, options);\n\n  this._gdpr_update_persistence(options);\n}; // EXPORTS (for closure compiler)\n// MixpanelLib Exports\n\n\nMixpanelLib.prototype['init'] = MixpanelLib.prototype.init;\nMixpanelLib.prototype['reset'] = MixpanelLib.prototype.reset;\nMixpanelLib.prototype['disable'] = MixpanelLib.prototype.disable;\nMixpanelLib.prototype['time_event'] = MixpanelLib.prototype.time_event;\nMixpanelLib.prototype['track'] = MixpanelLib.prototype.track;\nMixpanelLib.prototype['track_links'] = MixpanelLib.prototype.track_links;\nMixpanelLib.prototype['track_forms'] = MixpanelLib.prototype.track_forms;\nMixpanelLib.prototype['track_pageview'] = MixpanelLib.prototype.track_pageview;\nMixpanelLib.prototype['register'] = MixpanelLib.prototype.register;\nMixpanelLib.prototype['register_once'] = MixpanelLib.prototype.register_once;\nMixpanelLib.prototype['unregister'] = MixpanelLib.prototype.unregister;\nMixpanelLib.prototype['identify'] = MixpanelLib.prototype.identify;\nMixpanelLib.prototype['alias'] = MixpanelLib.prototype.alias;\nMixpanelLib.prototype['name_tag'] = MixpanelLib.prototype.name_tag;\nMixpanelLib.prototype['set_config'] = MixpanelLib.prototype.set_config;\nMixpanelLib.prototype['get_config'] = MixpanelLib.prototype.get_config;\nMixpanelLib.prototype['get_property'] = MixpanelLib.prototype.get_property;\nMixpanelLib.prototype['get_distinct_id'] = MixpanelLib.prototype.get_distinct_id;\nMixpanelLib.prototype['toString'] = MixpanelLib.prototype.toString;\nMixpanelLib.prototype['_check_and_handle_notifications'] = MixpanelLib.prototype._check_and_handle_notifications;\nMixpanelLib.prototype['_handle_user_decide_check_complete'] = MixpanelLib.prototype._handle_user_decide_check_complete;\nMixpanelLib.prototype['_show_notification'] = MixpanelLib.prototype._show_notification;\nMixpanelLib.prototype['opt_out_tracking'] = MixpanelLib.prototype.opt_out_tracking;\nMixpanelLib.prototype['opt_in_tracking'] = MixpanelLib.prototype.opt_in_tracking;\nMixpanelLib.prototype['has_opted_out_tracking'] = MixpanelLib.prototype.has_opted_out_tracking;\nMixpanelLib.prototype['has_opted_in_tracking'] = MixpanelLib.prototype.has_opted_in_tracking;\nMixpanelLib.prototype['clear_opt_in_out_tracking'] = MixpanelLib.prototype.clear_opt_in_out_tracking;\nMixpanelLib.prototype['get_group'] = MixpanelLib.prototype.get_group;\nMixpanelLib.prototype['set_group'] = MixpanelLib.prototype.set_group;\nMixpanelLib.prototype['add_group'] = MixpanelLib.prototype.add_group;\nMixpanelLib.prototype['remove_group'] = MixpanelLib.prototype.remove_group;\nMixpanelLib.prototype['track_with_groups'] = MixpanelLib.prototype.track_with_groups;\nMixpanelLib.prototype['stop_batch_requests'] = MixpanelLib.prototype.stop_batch_requests; // MixpanelPersistence Exports\n\nMixpanelPersistence.prototype['properties'] = MixpanelPersistence.prototype.properties;\nMixpanelPersistence.prototype['update_search_keyword'] = MixpanelPersistence.prototype.update_search_keyword;\nMixpanelPersistence.prototype['update_referrer_info'] = MixpanelPersistence.prototype.update_referrer_info;\nMixpanelPersistence.prototype['get_cross_subdomain'] = MixpanelPersistence.prototype.get_cross_subdomain;\nMixpanelPersistence.prototype['clear'] = MixpanelPersistence.prototype.clear;\n\n_.safewrap_class(MixpanelLib, ['identify', '_check_and_handle_notifications', '_show_notification']);\n\nvar instances = {};\n\nvar extend_mp = function extend_mp() {\n  // add all the sub mixpanel instances\n  _.each(instances, function (instance, name) {\n    if (name !== PRIMARY_INSTANCE_NAME) {\n      mixpanel_master[name] = instance;\n    }\n  }); // add private functions as _\n\n\n  mixpanel_master['_'] = _;\n};\n\nvar override_mp_init_func = function override_mp_init_func() {\n  // we override the snippets init function to handle the case where a\n  // user initializes the mixpanel library after the script loads & runs\n  mixpanel_master['init'] = function (token, config, name) {\n    if (name) {\n      // initialize a sub library\n      if (!mixpanel_master[name]) {\n        mixpanel_master[name] = instances[name] = create_mplib(token, config, name);\n\n        mixpanel_master[name]._loaded();\n      }\n\n      return mixpanel_master[name];\n    } else {\n      var instance = mixpanel_master;\n\n      if (instances[PRIMARY_INSTANCE_NAME]) {\n        // main mixpanel lib already initialized\n        instance = instances[PRIMARY_INSTANCE_NAME];\n      } else if (token) {\n        // intialize the main mixpanel lib\n        instance = create_mplib(token, config, PRIMARY_INSTANCE_NAME);\n\n        instance._loaded();\n\n        instances[PRIMARY_INSTANCE_NAME] = instance;\n      }\n\n      mixpanel_master = instance;\n\n      if (init_type === INIT_SNIPPET) {\n        window$1[PRIMARY_INSTANCE_NAME] = mixpanel_master;\n      }\n\n      extend_mp();\n    }\n  };\n};\n\nvar add_dom_loaded_handler = function add_dom_loaded_handler() {\n  // Cross browser DOM Loaded support\n  function dom_loaded_handler() {\n    // function flag since we only want to execute this once\n    if (dom_loaded_handler.done) {\n      return;\n    }\n\n    dom_loaded_handler.done = true;\n    DOM_LOADED = true;\n    ENQUEUE_REQUESTS = false;\n\n    _.each(instances, function (inst) {\n      inst._dom_loaded();\n    });\n  }\n\n  function do_scroll_check() {\n    try {\n      document$1.documentElement.doScroll('left');\n    } catch (e) {\n      setTimeout(do_scroll_check, 1);\n      return;\n    }\n\n    dom_loaded_handler();\n  }\n\n  if (document$1.addEventListener) {\n    if (document$1.readyState === 'complete') {\n      // safari 4 can fire the DOMContentLoaded event before loading all\n      // external JS (including this file). you will see some copypasta\n      // on the internet that checks for 'complete' and 'loaded', but\n      // 'loaded' is an IE thing\n      dom_loaded_handler();\n    } else {\n      document$1.addEventListener('DOMContentLoaded', dom_loaded_handler, false);\n    }\n  } else if (document$1.attachEvent) {\n    // IE\n    document$1.attachEvent('onreadystatechange', dom_loaded_handler); // check to make sure we arn't in a frame\n\n    var toplevel = false;\n\n    try {\n      toplevel = window$1.frameElement === null;\n    } catch (e) {// noop\n    }\n\n    if (document$1.documentElement.doScroll && toplevel) {\n      do_scroll_check();\n    }\n  } // fallback handler, always will work\n\n\n  _.register_event(window$1, 'load', dom_loaded_handler, true);\n};\n\nfunction init_as_module() {\n  init_type = INIT_MODULE;\n  mixpanel_master = new MixpanelLib();\n  override_mp_init_func();\n  mixpanel_master['init']();\n  add_dom_loaded_handler();\n  return mixpanel_master;\n}\n\nvar mixpanel = init_as_module();\nmodule.exports = mixpanel;"],"sourceRoot":""}